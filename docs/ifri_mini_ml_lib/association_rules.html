<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.3"/>
    <title>ifri_mini_ml_lib.association_rules API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../ifri_mini_ml_lib.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;ifri_mini_ml_lib</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Apriori">Apriori</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Apriori.__init__">Apriori</a>
                        </li>
                        <li>
                                <a class="variable" href="#Apriori.min_support">min_support</a>
                        </li>
                        <li>
                                <a class="variable" href="#Apriori.min_confidence">min_confidence</a>
                        </li>
                        <li>
                                <a class="variable" href="#Apriori.frequent_itemsets_">frequent_itemsets_</a>
                        </li>
                        <li>
                                <a class="variable" href="#Apriori.rules_">rules_</a>
                        </li>
                        <li>
                                <a class="function" href="#Apriori.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#Apriori.get_frequent_itemsets">get_frequent_itemsets</a>
                        </li>
                        <li>
                                <a class="function" href="#Apriori.get_rules">get_rules</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Eclat">Eclat</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Eclat.__init__">Eclat</a>
                        </li>
                        <li>
                                <a class="variable" href="#Eclat.min_support">min_support</a>
                        </li>
                        <li>
                                <a class="variable" href="#Eclat.min_confidence">min_confidence</a>
                        </li>
                        <li>
                                <a class="variable" href="#Eclat.frequent_itemsets">frequent_itemsets</a>
                        </li>
                        <li>
                                <a class="variable" href="#Eclat.frequent_TIDsets">frequent_TIDsets</a>
                        </li>
                        <li>
                                <a class="variable" href="#Eclat.rules_">rules_</a>
                        </li>
                        <li>
                                <a class="variable" href="#Eclat.n_transactions">n_transactions</a>
                        </li>
                        <li>
                                <a class="function" href="#Eclat.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#Eclat.get_single_items_TIDset">get_single_items_TIDset</a>
                        </li>
                        <li>
                                <a class="function" href="#Eclat.get_frequent_itemsets">get_frequent_itemsets</a>
                        </li>
                        <li>
                                <a class="function" href="#Eclat.get_rules">get_rules</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FPGrowth">FPGrowth</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FPGrowth.__init__">FPGrowth</a>
                        </li>
                        <li>
                                <a class="variable" href="#FPGrowth.min_support">min_support</a>
                        </li>
                        <li>
                                <a class="variable" href="#FPGrowth.min_confidence">min_confidence</a>
                        </li>
                        <li>
                                <a class="variable" href="#FPGrowth.frequent_itemsets_dict">frequent_itemsets_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#FPGrowth.rules_">rules_</a>
                        </li>
                        <li>
                                <a class="variable" href="#FPGrowth.header_table">header_table</a>
                        </li>
                        <li>
                                <a class="variable" href="#FPGrowth.n_transactions">n_transactions</a>
                        </li>
                        <li>
                                <a class="function" href="#FPGrowth.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#FPGrowth.get_frequent_itemsets">get_frequent_itemsets</a>
                        </li>
                        <li>
                                <a class="function" href="#FPGrowth.get_rules">get_rules</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DataAdapter">DataAdapter</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DataAdapter.convert_to_transactions">convert_to_transactions</a>
                        </li>
                        <li>
                                <a class="function" href="#DataAdapter.load_csv_to_transactions">load_csv_to_transactions</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>Â© 2025 IFRI Machine Learning Library</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../ifri_mini_ml_lib.html">ifri_mini_ml_lib</a><wbr>.association_rules    </h1>

                
                        <input id="mod-association_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-association_rules-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.apriori</span><span class="w"> </span><span class="kn">import</span> <span class="n">Apriori</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.eclat</span><span class="w"> </span><span class="kn">import</span> <span class="n">Eclat</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.fp_growth</span><span class="w"> </span><span class="kn">import</span> <span class="n">FPGrowth</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataAdapter</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>    <span class="s2">&quot;Apriori&quot;</span><span class="p">,</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>    <span class="s2">&quot;Eclat&quot;</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>    <span class="s2">&quot;FPGrowth&quot;</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="s2">&quot;DataAdapter&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="Apriori">
                            <input id="Apriori-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Apriori</span>:

                <label class="view-source-button" for="Apriori-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Apriori"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Apriori-8"><a href="#Apriori-8"><span class="linenos">  8</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Apriori</span><span class="p">:</span>
</span><span id="Apriori-9"><a href="#Apriori-9"><span class="linenos">  9</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-10"><a href="#Apriori-10"><span class="linenos"> 10</span></a><span class="sd">    The Apriori algorithm is used to discover interesting association rules</span>
</span><span id="Apriori-11"><a href="#Apriori-11"><span class="linenos"> 11</span></a><span class="sd">    in large transactional datasets. For more details: </span>
</span><span id="Apriori-12"><a href="#Apriori-12"><span class="linenos"> 12</span></a><span class="sd">    `Agrawal, R., &amp; Srikant, R. (1994, September) &lt;http://www.vldb.org/conf/1994/P487.PDF&gt;`_</span>
</span><span id="Apriori-13"><a href="#Apriori-13"><span class="linenos"> 13</span></a>
</span><span id="Apriori-14"><a href="#Apriori-14"><span class="linenos"> 14</span></a><span class="sd">    Args:</span>
</span><span id="Apriori-15"><a href="#Apriori-15"><span class="linenos"> 15</span></a><span class="sd">        min_support(float): Minimum support threshold for considering an itemset</span>
</span><span id="Apriori-16"><a href="#Apriori-16"><span class="linenos"> 16</span></a><span class="sd">        min_confidence(float): Minimum confidence threshold for a rule</span>
</span><span id="Apriori-17"><a href="#Apriori-17"><span class="linenos"> 17</span></a><span class="sd">        </span>
</span><span id="Apriori-18"><a href="#Apriori-18"><span class="linenos"> 18</span></a><span class="sd">    Examples:</span>
</span><span id="Apriori-19"><a href="#Apriori-19"><span class="linenos"> 19</span></a>
</span><span id="Apriori-20"><a href="#Apriori-20"><span class="linenos"> 20</span></a><span class="sd">    &gt;&gt;&gt; transactions = [</span>
</span><span id="Apriori-21"><a href="#Apriori-21"><span class="linenos"> 21</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;butter&#39;},</span>
</span><span id="Apriori-22"><a href="#Apriori-22"><span class="linenos"> 22</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;jam&#39;, &#39;eggs&#39;},</span>
</span><span id="Apriori-23"><a href="#Apriori-23"><span class="linenos"> 23</span></a><span class="sd">    ...     {&#39;milk&#39;, &#39;butter&#39;, &#39;cheese&#39;},</span>
</span><span id="Apriori-24"><a href="#Apriori-24"><span class="linenos"> 24</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;butter&#39;, &#39;cheese&#39;},</span>
</span><span id="Apriori-25"><a href="#Apriori-25"><span class="linenos"> 25</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;jam&#39;, &#39;milk&#39;}</span>
</span><span id="Apriori-26"><a href="#Apriori-26"><span class="linenos"> 26</span></a><span class="sd">    ... ]</span>
</span><span id="Apriori-27"><a href="#Apriori-27"><span class="linenos"> 27</span></a><span class="sd">    &gt;&gt;&gt; from ifri_mini_ml_lib.association_rules import Apriori</span>
</span><span id="Apriori-28"><a href="#Apriori-28"><span class="linenos"> 28</span></a><span class="sd">    &gt;&gt;&gt; apriori = Apriori(min_support=0.4, min_confidence=0.6)</span>
</span><span id="Apriori-29"><a href="#Apriori-29"><span class="linenos"> 29</span></a><span class="sd">    &gt;&gt;&gt; apriori.fit(transactions) # Frequents itemsets + Rules generation</span>
</span><span id="Apriori-30"><a href="#Apriori-30"><span class="linenos"> 30</span></a><span class="sd">    &lt;ifri_mini_ml_lib.association_rules.apriori.Apriori object&gt;</span>
</span><span id="Apriori-31"><a href="#Apriori-31"><span class="linenos"> 31</span></a><span class="sd">    &gt;&gt;&gt; frequent_itemsets = apriori.get_frequent_itemsets()</span>
</span><span id="Apriori-32"><a href="#Apriori-32"><span class="linenos"> 32</span></a><span class="sd">    &gt;&gt;&gt; # Displaying frequent itemsets of size 1</span>
</span><span id="Apriori-33"><a href="#Apriori-33"><span class="linenos"> 33</span></a><span class="sd">    &gt;&gt;&gt; for item in frequent_itemsets[1]:</span>
</span><span id="Apriori-34"><a href="#Apriori-34"><span class="linenos"> 34</span></a><span class="sd">    ...     print(f&quot;Item: {list(item)[0]}&quot;)</span>
</span><span id="Apriori-35"><a href="#Apriori-35"><span class="linenos"> 35</span></a><span class="sd">    Item: bread</span>
</span><span id="Apriori-36"><a href="#Apriori-36"><span class="linenos"> 36</span></a><span class="sd">    Item: milk</span>
</span><span id="Apriori-37"><a href="#Apriori-37"><span class="linenos"> 37</span></a><span class="sd">    Item: butter</span>
</span><span id="Apriori-38"><a href="#Apriori-38"><span class="linenos"> 38</span></a><span class="sd">    &gt;&gt;&gt; rules = apriori.get_rules()</span>
</span><span id="Apriori-39"><a href="#Apriori-39"><span class="linenos"> 39</span></a><span class="sd">    &gt;&gt;&gt; # Displaying some association rules</span>
</span><span id="Apriori-40"><a href="#Apriori-40"><span class="linenos"> 40</span></a><span class="sd">    &gt;&gt;&gt; if rules:</span>
</span><span id="Apriori-41"><a href="#Apriori-41"><span class="linenos"> 41</span></a><span class="sd">    ...     for rule in rules[:2]:</span>
</span><span id="Apriori-42"><a href="#Apriori-42"><span class="linenos"> 42</span></a><span class="sd">    ...         print(f&quot;{set(rule[&#39;antecedent&#39;])} -&gt; {set(rule[&#39;consequent&#39;])}, &quot;</span>
</span><span id="Apriori-43"><a href="#Apriori-43"><span class="linenos"> 43</span></a><span class="sd">    ...               f&quot;Support: {rule[&#39;support&#39;]:.2f}, Confidence: {rule[&#39;confidence&#39;]:.2f}&quot;)</span>
</span><span id="Apriori-44"><a href="#Apriori-44"><span class="linenos"> 44</span></a><span class="sd">    {&#39;milk&#39;} -&gt; {&#39;bread&#39;}, Support: 0.60, Confidence: 0.75</span>
</span><span id="Apriori-45"><a href="#Apriori-45"><span class="linenos"> 45</span></a><span class="sd">    {&#39;bread&#39;} -&gt; {&#39;milk&#39;}, Support: 0.60, Confidence: 0.75</span>
</span><span id="Apriori-46"><a href="#Apriori-46"><span class="linenos"> 46</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Apriori-47"><a href="#Apriori-47"><span class="linenos"> 47</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Apriori-48"><a href="#Apriori-48"><span class="linenos"> 48</span></a>        
</span><span id="Apriori-49"><a href="#Apriori-49"><span class="linenos"> 49</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_support</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Apriori-50"><a href="#Apriori-50"><span class="linenos"> 50</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum support must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Apriori-51"><a href="#Apriori-51"><span class="linenos"> 51</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_confidence</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Apriori-52"><a href="#Apriori-52"><span class="linenos"> 52</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum confidence must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Apriori-53"><a href="#Apriori-53"><span class="linenos"> 53</span></a>        
</span><span id="Apriori-54"><a href="#Apriori-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">=</span> <span class="n">min_support</span>
</span><span id="Apriori-55"><a href="#Apriori-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span> <span class="o">=</span> <span class="n">min_confidence</span>
</span><span id="Apriori-56"><a href="#Apriori-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Apriori-57"><a href="#Apriori-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Apriori-58"><a href="#Apriori-58"><span class="linenos"> 58</span></a>
</span><span id="Apriori-59"><a href="#Apriori-59"><span class="linenos"> 59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Apriori-60"><a href="#Apriori-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-61"><a href="#Apriori-61"><span class="linenos"> 61</span></a><span class="sd">        Main method for learning frequent itemsets and rules.</span>
</span><span id="Apriori-62"><a href="#Apriori-62"><span class="linenos"> 62</span></a><span class="sd">        </span>
</span><span id="Apriori-63"><a href="#Apriori-63"><span class="linenos"> 63</span></a><span class="sd">        Args:</span>
</span><span id="Apriori-64"><a href="#Apriori-64"><span class="linenos"> 64</span></a><span class="sd">            transactions: Input data (list[set])</span>
</span><span id="Apriori-65"><a href="#Apriori-65"><span class="linenos"> 65</span></a><span class="sd">            </span>
</span><span id="Apriori-66"><a href="#Apriori-66"><span class="linenos"> 66</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori-67"><a href="#Apriori-67"><span class="linenos"> 67</span></a><span class="sd">            self: The current instance for method chaining</span>
</span><span id="Apriori-68"><a href="#Apriori-68"><span class="linenos"> 68</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-69"><a href="#Apriori-69"><span class="linenos"> 69</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Apriori-70"><a href="#Apriori-70"><span class="linenos"> 70</span></a>        
</span><span id="Apriori-71"><a href="#Apriori-71"><span class="linenos"> 71</span></a>        <span class="c1"># Check the conformity of the input data format</span>
</span><span id="Apriori-72"><a href="#Apriori-72"><span class="linenos"> 72</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Apriori-73"><a href="#Apriori-73"><span class="linenos"> 73</span></a>            <span class="n">transactions_list</span> <span class="o">=</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_list</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori-74"><a href="#Apriori-74"><span class="linenos"> 74</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Apriori-75"><a href="#Apriori-75"><span class="linenos"> 75</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data format not respected! Only List[set] format is accepted.&quot;</span><span class="p">)</span>
</span><span id="Apriori-76"><a href="#Apriori-76"><span class="linenos"> 76</span></a>        
</span><span id="Apriori-77"><a href="#Apriori-77"><span class="linenos"> 77</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Applying Apriori algorithm with:&quot;</span><span class="p">)</span>
</span><span id="Apriori-78"><a href="#Apriori-78"><span class="linenos"> 78</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Apriori-79"><a href="#Apriori-79"><span class="linenos"> 79</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum confidence: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Apriori-80"><a href="#Apriori-80"><span class="linenos"> 80</span></a>
</span><span id="Apriori-81"><a href="#Apriori-81"><span class="linenos"> 81</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of valid transactions: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Apriori-82"><a href="#Apriori-82"><span class="linenos"> 82</span></a>        <span class="k">if</span> <span class="n">transactions_list</span><span class="p">:</span>
</span><span id="Apriori-83"><a href="#Apriori-83"><span class="linenos"> 83</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Example transaction: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])[:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="Apriori-84"><a href="#Apriori-84"><span class="linenos"> 84</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Apriori-85"><a href="#Apriori-85"><span class="linenos"> 85</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Apriori-86"><a href="#Apriori-86"><span class="linenos"> 86</span></a>
</span><span id="Apriori-87"><a href="#Apriori-87"><span class="linenos"> 87</span></a>        <span class="c1"># Generate frequent itemsets</span>
</span><span id="Apriori-88"><a href="#Apriori-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_apriori</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Apriori-89"><a href="#Apriori-89"><span class="linenos"> 89</span></a>        <span class="c1"># Generate association rules</span>
</span><span id="Apriori-90"><a href="#Apriori-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_rules</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Apriori-91"><a href="#Apriori-91"><span class="linenos"> 91</span></a>
</span><span id="Apriori-92"><a href="#Apriori-92"><span class="linenos"> 92</span></a>        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Apriori-93"><a href="#Apriori-93"><span class="linenos"> 93</span></a>
</span><span id="Apriori-94"><a href="#Apriori-94"><span class="linenos"> 94</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="Apriori-95"><a href="#Apriori-95"><span class="linenos"> 95</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Apriori-96"><a href="#Apriori-96"><span class="linenos"> 96</span></a>    
</span><span id="Apriori-97"><a href="#Apriori-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_fit_apriori</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">]):</span>
</span><span id="Apriori-98"><a href="#Apriori-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-99"><a href="#Apriori-99"><span class="linenos"> 99</span></a><span class="sd">        Extraction of k-frequent itemsets</span>
</span><span id="Apriori-100"><a href="#Apriori-100"><span class="linenos">100</span></a>
</span><span id="Apriori-101"><a href="#Apriori-101"><span class="linenos">101</span></a><span class="sd">        ## Steps:</span>
</span><span id="Apriori-102"><a href="#Apriori-102"><span class="linenos">102</span></a><span class="sd">            1. Extract all unique items</span>
</span><span id="Apriori-103"><a href="#Apriori-103"><span class="linenos">103</span></a><span class="sd">            2. Find 1-itemsets that are frequent</span>
</span><span id="Apriori-104"><a href="#Apriori-104"><span class="linenos">104</span></a><span class="sd">            3. Iteratively generate itemsets of increasing size</span>
</span><span id="Apriori-105"><a href="#Apriori-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-106"><a href="#Apriori-106"><span class="linenos">106</span></a>        <span class="c1"># Get unique items</span>
</span><span id="Apriori-107"><a href="#Apriori-107"><span class="linenos">107</span></a>        <span class="n">items</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">transactions</span><span class="p">))</span>
</span><span id="Apriori-108"><a href="#Apriori-108"><span class="linenos">108</span></a>        <span class="c1"># Get 1-itemsets that are frequent</span>
</span><span id="Apriori-109"><a href="#Apriori-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Apriori-110"><a href="#Apriori-110"><span class="linenos">110</span></a>            <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_one_itemsets</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori-111"><a href="#Apriori-111"><span class="linenos">111</span></a>        <span class="p">}</span>
</span><span id="Apriori-112"><a href="#Apriori-112"><span class="linenos">112</span></a>        
</span><span id="Apriori-113"><a href="#Apriori-113"><span class="linenos">113</span></a>        <span class="c1"># Generate itemsets of increasing size</span>
</span><span id="Apriori-114"><a href="#Apriori-114"><span class="linenos">114</span></a>        <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Apriori-115"><a href="#Apriori-115"><span class="linenos">115</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Apriori-116"><a href="#Apriori-116"><span class="linenos">116</span></a>            <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Apriori-117"><a href="#Apriori-117"><span class="linenos">117</span></a>            <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_candidates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span><span class="p">[</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Apriori-118"><a href="#Apriori-118"><span class="linenos">118</span></a>            <span class="n">frequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prune_candidates</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori-119"><a href="#Apriori-119"><span class="linenos">119</span></a>
</span><span id="Apriori-120"><a href="#Apriori-120"><span class="linenos">120</span></a>            <span class="c1"># Stop if no frequent item is found</span>
</span><span id="Apriori-121"><a href="#Apriori-121"><span class="linenos">121</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">frequent</span><span class="p">:</span> 
</span><span id="Apriori-122"><a href="#Apriori-122"><span class="linenos">122</span></a>                <span class="k">break</span>
</span><span id="Apriori-123"><a href="#Apriori-123"><span class="linenos">123</span></a>            <span class="c1"># Store frequent itemsets of this size</span>
</span><span id="Apriori-124"><a href="#Apriori-124"><span class="linenos">124</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span><span class="p">[</span><span class="n">size</span><span class="p">]</span> <span class="o">=</span> <span class="n">frequent</span>
</span><span id="Apriori-125"><a href="#Apriori-125"><span class="linenos">125</span></a>
</span><span id="Apriori-126"><a href="#Apriori-126"><span class="linenos">126</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_one_itemsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">set</span><span class="p">,</span> <span class="n">transactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">]):</span>
</span><span id="Apriori-127"><a href="#Apriori-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-128"><a href="#Apriori-128"><span class="linenos">128</span></a><span class="sd">        Computes the frequent 1-itemsets (individual items).</span>
</span><span id="Apriori-129"><a href="#Apriori-129"><span class="linenos">129</span></a><span class="sd">        </span>
</span><span id="Apriori-130"><a href="#Apriori-130"><span class="linenos">130</span></a><span class="sd">        Args:</span>
</span><span id="Apriori-131"><a href="#Apriori-131"><span class="linenos">131</span></a><span class="sd">            items: Set of all unique items</span>
</span><span id="Apriori-132"><a href="#Apriori-132"><span class="linenos">132</span></a><span class="sd">            transactions: List of transactions</span>
</span><span id="Apriori-133"><a href="#Apriori-133"><span class="linenos">133</span></a><span class="sd">        </span>
</span><span id="Apriori-134"><a href="#Apriori-134"><span class="linenos">134</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori-135"><a href="#Apriori-135"><span class="linenos">135</span></a><span class="sd">            Set of frequent items that satisfy the minimum support</span>
</span><span id="Apriori-136"><a href="#Apriori-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-137"><a href="#Apriori-137"><span class="linenos">137</span></a>        <span class="c1"># Occurrence of each unique item in the database</span>
</span><span id="Apriori-138"><a href="#Apriori-138"><span class="linenos">138</span></a>        <span class="n">items_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Apriori-139"><a href="#Apriori-139"><span class="linenos">139</span></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
</span><span id="Apriori-140"><a href="#Apriori-140"><span class="linenos">140</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
</span><span id="Apriori-141"><a href="#Apriori-141"><span class="linenos">141</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
</span><span id="Apriori-142"><a href="#Apriori-142"><span class="linenos">142</span></a>                    <span class="n">items_counts</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">i</span><span class="p">])]</span> <span class="o">+=</span><span class="mi">1</span>
</span><span id="Apriori-143"><a href="#Apriori-143"><span class="linenos">143</span></a>        
</span><span id="Apriori-144"><a href="#Apriori-144"><span class="linenos">144</span></a>        <span class="n">n_trans</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori-145"><a href="#Apriori-145"><span class="linenos">145</span></a>
</span><span id="Apriori-146"><a href="#Apriori-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">items_counts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Apriori-147"><a href="#Apriori-147"><span class="linenos">147</span></a>                <span class="k">if</span> <span class="n">count</span><span class="o">/</span><span class="n">n_trans</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="p">}</span>
</span><span id="Apriori-148"><a href="#Apriori-148"><span class="linenos">148</span></a>
</span><span id="Apriori-149"><a href="#Apriori-149"><span class="linenos">149</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_candidates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">previous_itemsets</span><span class="p">:</span> <span class="nb">set</span><span class="p">):</span>
</span><span id="Apriori-150"><a href="#Apriori-150"><span class="linenos">150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-151"><a href="#Apriori-151"><span class="linenos">151</span></a><span class="sd">        Generates new candidates by combining previous itemsets.</span>
</span><span id="Apriori-152"><a href="#Apriori-152"><span class="linenos">152</span></a><span class="sd">        Uses the optimized &quot;join-and-prune&quot; approach that only combines</span>
</span><span id="Apriori-153"><a href="#Apriori-153"><span class="linenos">153</span></a><span class="sd">        itemsets sharing the same first k-1 elements.</span>
</span><span id="Apriori-154"><a href="#Apriori-154"><span class="linenos">154</span></a><span class="sd">        </span>
</span><span id="Apriori-155"><a href="#Apriori-155"><span class="linenos">155</span></a><span class="sd">        Args:</span>
</span><span id="Apriori-156"><a href="#Apriori-156"><span class="linenos">156</span></a><span class="sd">            previous_itemsets: Itemsets of the previous size k</span>
</span><span id="Apriori-157"><a href="#Apriori-157"><span class="linenos">157</span></a><span class="sd">        </span>
</span><span id="Apriori-158"><a href="#Apriori-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori-159"><a href="#Apriori-159"><span class="linenos">159</span></a><span class="sd">            New candidates of size k + 1</span>
</span><span id="Apriori-160"><a href="#Apriori-160"><span class="linenos">160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-161"><a href="#Apriori-161"><span class="linenos">161</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Apriori-162"><a href="#Apriori-162"><span class="linenos">162</span></a>        <span class="n">previous_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">previous_itemsets</span><span class="p">)</span>
</span><span id="Apriori-163"><a href="#Apriori-163"><span class="linenos">163</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">previous_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">if</span> <span class="n">previous_list</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="Apriori-164"><a href="#Apriori-164"><span class="linenos">164</span></a>        
</span><span id="Apriori-165"><a href="#Apriori-165"><span class="linenos">165</span></a>        <span class="c1"># Join phase</span>
</span><span id="Apriori-166"><a href="#Apriori-166"><span class="linenos">166</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">previous_list</span><span class="p">)):</span>
</span><span id="Apriori-167"><a href="#Apriori-167"><span class="linenos">167</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_list</span><span class="p">)):</span>
</span><span id="Apriori-168"><a href="#Apriori-168"><span class="linenos">168</span></a>                <span class="c1"># Convert to list to compare elements by index</span>
</span><span id="Apriori-169"><a href="#Apriori-169"><span class="linenos">169</span></a>                <span class="n">items1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">previous_list</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="Apriori-170"><a href="#Apriori-170"><span class="linenos">170</span></a>                <span class="n">items2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">previous_list</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
</span><span id="Apriori-171"><a href="#Apriori-171"><span class="linenos">171</span></a>                
</span><span id="Apriori-172"><a href="#Apriori-172"><span class="linenos">172</span></a>                <span class="c1"># Check if the first k-1 elements are identical</span>
</span><span id="Apriori-173"><a href="#Apriori-173"><span class="linenos">173</span></a>                <span class="k">if</span> <span class="n">items1</span><span class="p">[:</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">items2</span><span class="p">[:</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="Apriori-174"><a href="#Apriori-174"><span class="linenos">174</span></a>                    <span class="c1"># Create a new candidate itemset</span>
</span><span id="Apriori-175"><a href="#Apriori-175"><span class="linenos">175</span></a>                    <span class="n">new_candidate</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">previous_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|</span> <span class="n">previous_list</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span><span id="Apriori-176"><a href="#Apriori-176"><span class="linenos">176</span></a>                    
</span><span id="Apriori-177"><a href="#Apriori-177"><span class="linenos">177</span></a>                    <span class="c1"># Prune phase - all subsets must be frequent</span>
</span><span id="Apriori-178"><a href="#Apriori-178"><span class="linenos">178</span></a>                    <span class="n">should_add</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Apriori-179"><a href="#Apriori-179"><span class="linenos">179</span></a>                    <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">new_candidate</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="Apriori-180"><a href="#Apriori-180"><span class="linenos">180</span></a>                        <span class="k">if</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">previous_itemsets</span><span class="p">:</span>
</span><span id="Apriori-181"><a href="#Apriori-181"><span class="linenos">181</span></a>                            <span class="n">should_add</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Apriori-182"><a href="#Apriori-182"><span class="linenos">182</span></a>                            <span class="k">break</span>
</span><span id="Apriori-183"><a href="#Apriori-183"><span class="linenos">183</span></a>                    
</span><span id="Apriori-184"><a href="#Apriori-184"><span class="linenos">184</span></a>                    <span class="k">if</span> <span class="n">should_add</span><span class="p">:</span>
</span><span id="Apriori-185"><a href="#Apriori-185"><span class="linenos">185</span></a>                        <span class="n">candidates</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_candidate</span><span class="p">)</span>
</span><span id="Apriori-186"><a href="#Apriori-186"><span class="linenos">186</span></a>        
</span><span id="Apriori-187"><a href="#Apriori-187"><span class="linenos">187</span></a>        <span class="k">return</span> <span class="n">candidates</span>
</span><span id="Apriori-188"><a href="#Apriori-188"><span class="linenos">188</span></a>
</span><span id="Apriori-189"><a href="#Apriori-189"><span class="linenos">189</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prune_candidates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="nb">set</span><span class="p">,</span> <span class="n">transactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">]):</span>
</span><span id="Apriori-190"><a href="#Apriori-190"><span class="linenos">190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-191"><a href="#Apriori-191"><span class="linenos">191</span></a><span class="sd">        Filters candidates according to minimum support in an optimized way.</span>
</span><span id="Apriori-192"><a href="#Apriori-192"><span class="linenos">192</span></a><span class="sd">        </span>
</span><span id="Apriori-193"><a href="#Apriori-193"><span class="linenos">193</span></a><span class="sd">        Args:</span>
</span><span id="Apriori-194"><a href="#Apriori-194"><span class="linenos">194</span></a><span class="sd">            candidates: Set of candidates to test</span>
</span><span id="Apriori-195"><a href="#Apriori-195"><span class="linenos">195</span></a><span class="sd">            transactions: List of transactions</span>
</span><span id="Apriori-196"><a href="#Apriori-196"><span class="linenos">196</span></a><span class="sd">        </span>
</span><span id="Apriori-197"><a href="#Apriori-197"><span class="linenos">197</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori-198"><a href="#Apriori-198"><span class="linenos">198</span></a><span class="sd">            Frequent itemsets among the candidates</span>
</span><span id="Apriori-199"><a href="#Apriori-199"><span class="linenos">199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-200"><a href="#Apriori-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="Apriori-201"><a href="#Apriori-201"><span class="linenos">201</span></a>            <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Apriori-202"><a href="#Apriori-202"><span class="linenos">202</span></a>            
</span><span id="Apriori-203"><a href="#Apriori-203"><span class="linenos">203</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">candidates</span> <span class="k">if</span> <span class="n">support</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="p">}</span>
</span><span id="Apriori-204"><a href="#Apriori-204"><span class="linenos">204</span></a>    
</span><span id="Apriori-205"><a href="#Apriori-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">set</span><span class="p">]):</span>
</span><span id="Apriori-206"><a href="#Apriori-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-207"><a href="#Apriori-207"><span class="linenos">207</span></a><span class="sd">        Generates association rules from frequent itemsets.</span>
</span><span id="Apriori-208"><a href="#Apriori-208"><span class="linenos">208</span></a><span class="sd">        Calculates confidence and lift for each rule.</span>
</span><span id="Apriori-209"><a href="#Apriori-209"><span class="linenos">209</span></a><span class="sd">        </span>
</span><span id="Apriori-210"><a href="#Apriori-210"><span class="linenos">210</span></a><span class="sd">        Args:</span>
</span><span id="Apriori-211"><a href="#Apriori-211"><span class="linenos">211</span></a><span class="sd">            transactions: List of transactions</span>
</span><span id="Apriori-212"><a href="#Apriori-212"><span class="linenos">212</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-213"><a href="#Apriori-213"><span class="linenos">213</span></a>
</span><span id="Apriori-214"><a href="#Apriori-214"><span class="linenos">214</span></a>        <span class="c1"># Go through frequent itemsets ignoring those of size 1</span>
</span><span id="Apriori-215"><a href="#Apriori-215"><span class="linenos">215</span></a>        <span class="k">for</span> <span class="n">itemset</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
</span><span id="Apriori-216"><a href="#Apriori-216"><span class="linenos">216</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">itemset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Apriori-217"><a href="#Apriori-217"><span class="linenos">217</span></a>                <span class="k">continue</span>
</span><span id="Apriori-218"><a href="#Apriori-218"><span class="linenos">218</span></a>
</span><span id="Apriori-219"><a href="#Apriori-219"><span class="linenos">219</span></a>            <span class="c1"># Generate all possible rule combinations</span>
</span><span id="Apriori-220"><a href="#Apriori-220"><span class="linenos">220</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">itemset</span><span class="p">)):</span>
</span><span id="Apriori-221"><a href="#Apriori-221"><span class="linenos">221</span></a>                <span class="k">for</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">itemset</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="Apriori-222"><a href="#Apriori-222"><span class="linenos">222</span></a>                    <span class="n">antecedent</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">antecedent</span><span class="p">)</span>
</span><span id="Apriori-223"><a href="#Apriori-223"><span class="linenos">223</span></a>                    <span class="n">consequent</span> <span class="o">=</span> <span class="n">itemset</span> <span class="o">-</span> <span class="n">antecedent</span>
</span><span id="Apriori-224"><a href="#Apriori-224"><span class="linenos">224</span></a>                    
</span><span id="Apriori-225"><a href="#Apriori-225"><span class="linenos">225</span></a>                    <span class="c1"># Calculate metrics</span>
</span><span id="Apriori-226"><a href="#Apriori-226"><span class="linenos">226</span></a>                    <span class="n">conf</span> <span class="o">=</span> <span class="n">confidence</span><span class="p">(</span><span class="n">antecedent</span><span class="p">,</span> <span class="n">consequent</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori-227"><a href="#Apriori-227"><span class="linenos">227</span></a>                    
</span><span id="Apriori-228"><a href="#Apriori-228"><span class="linenos">228</span></a>                    <span class="k">if</span> <span class="n">conf</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="p">:</span>
</span><span id="Apriori-229"><a href="#Apriori-229"><span class="linenos">229</span></a>                        <span class="n">rule_support</span> <span class="o">=</span> <span class="n">support</span><span class="p">(</span><span class="n">itemset</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori-230"><a href="#Apriori-230"><span class="linenos">230</span></a>                        <span class="n">rule_lift</span> <span class="o">=</span> <span class="n">lift</span><span class="p">(</span><span class="n">antecedent</span><span class="p">,</span> <span class="n">consequent</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori-231"><a href="#Apriori-231"><span class="linenos">231</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="Apriori-232"><a href="#Apriori-232"><span class="linenos">232</span></a>                            <span class="s1">&#39;antecedent&#39;</span><span class="p">:</span> <span class="n">antecedent</span><span class="p">,</span> 
</span><span id="Apriori-233"><a href="#Apriori-233"><span class="linenos">233</span></a>                            <span class="s1">&#39;consequent&#39;</span><span class="p">:</span> <span class="n">consequent</span><span class="p">,</span> 
</span><span id="Apriori-234"><a href="#Apriori-234"><span class="linenos">234</span></a>                            <span class="s1">&#39;support&#39;</span><span class="p">:</span> <span class="n">rule_support</span><span class="p">,</span>
</span><span id="Apriori-235"><a href="#Apriori-235"><span class="linenos">235</span></a>                            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">conf</span><span class="p">,</span>
</span><span id="Apriori-236"><a href="#Apriori-236"><span class="linenos">236</span></a>                            <span class="s1">&#39;lift&#39;</span><span class="p">:</span> <span class="n">rule_lift</span>
</span><span id="Apriori-237"><a href="#Apriori-237"><span class="linenos">237</span></a>                        <span class="p">})</span>
</span><span id="Apriori-238"><a href="#Apriori-238"><span class="linenos">238</span></a>
</span><span id="Apriori-239"><a href="#Apriori-239"><span class="linenos">239</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_frequent_itemsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Apriori-240"><a href="#Apriori-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-241"><a href="#Apriori-241"><span class="linenos">241</span></a><span class="sd">        Retrieve the discovered frequent itemsets.</span>
</span><span id="Apriori-242"><a href="#Apriori-242"><span class="linenos">242</span></a><span class="sd">        </span>
</span><span id="Apriori-243"><a href="#Apriori-243"><span class="linenos">243</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori-244"><a href="#Apriori-244"><span class="linenos">244</span></a><span class="sd">            dict: Dictionary of frequent itemsets where keys are sizes</span>
</span><span id="Apriori-245"><a href="#Apriori-245"><span class="linenos">245</span></a><span class="sd">                and values are sets of itemsets</span>
</span><span id="Apriori-246"><a href="#Apriori-246"><span class="linenos">246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-247"><a href="#Apriori-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span>
</span><span id="Apriori-248"><a href="#Apriori-248"><span class="linenos">248</span></a>
</span><span id="Apriori-249"><a href="#Apriori-249"><span class="linenos">249</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Apriori-250"><a href="#Apriori-250"><span class="linenos">250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori-251"><a href="#Apriori-251"><span class="linenos">251</span></a><span class="sd">        Retrieve the generated association rules.</span>
</span><span id="Apriori-252"><a href="#Apriori-252"><span class="linenos">252</span></a><span class="sd">        </span>
</span><span id="Apriori-253"><a href="#Apriori-253"><span class="linenos">253</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori-254"><a href="#Apriori-254"><span class="linenos">254</span></a><span class="sd">            List of association rules</span>
</span><span id="Apriori-255"><a href="#Apriori-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori-256"><a href="#Apriori-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span>
</span></pre></div>


            <div class="docstring"><p>The Apriori algorithm is used to discover interesting association rules
in large transactional datasets. For more details: 
<a href="http://www.vldb.org/conf/1994/P487.PDF">Agrawal, R., &amp; Srikant, R. (1994, September) </a></p>

<p>Args:
    min_support(float): Minimum support threshold for considering an itemset
    min_confidence(float): Minimum confidence threshold for a rule</p>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;jam&#39;</span><span class="p">,</span> <span class="s1">&#39;eggs&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="s1">&#39;cheese&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="s1">&#39;cheese&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;jam&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn"><a href="">ifri_mini_ml_lib.association_rules</a></span><span class="w"> </span><span class="kn">import</span> <span class="n">Apriori</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apriori</span> <span class="o">=</span> <span class="n">Apriori</span><span class="p">(</span><span class="n">min_support</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apriori</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span> <span class="c1"># Frequents itemsets + Rules generation</span>
<span class="go">&lt;<a href="#Apriori">ifri_mini_ml_lib.association_rules.apriori.Apriori</a> object&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frequent_itemsets</span> <span class="o">=</span> <span class="n">apriori</span><span class="o">.</span><span class="n">get_frequent_itemsets</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Displaying frequent itemsets of size 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">frequent_itemsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Item: bread</span>
<span class="go">Item: milk</span>
<span class="go">Item: butter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rules</span> <span class="o">=</span> <span class="n">apriori</span><span class="o">.</span><span class="n">get_rules</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Displaying some association rules</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">rules</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;antecedent&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;consequent&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">, &quot;</span>
<span class="gp">... </span>              <span class="sa">f</span><span class="s2">&quot;Support: </span><span class="si">{</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;support&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Confidence: </span><span class="si">{</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">{&#39;milk&#39;} -&gt; {&#39;bread&#39;}, Support: 0.60, Confidence: 0.75</span>
<span class="go">{&#39;bread&#39;} -&gt; {&#39;milk&#39;}, Support: 0.60, Confidence: 0.75</span>
</code></pre>
</div>
</div>


                            <div id="Apriori.__init__" class="classattr">
                                        <input id="Apriori.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Apriori</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span></span>)</span>

                <label class="view-source-button" for="Apriori.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Apriori.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Apriori.__init__-47"><a href="#Apriori.__init__-47"><span class="linenos">47</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Apriori.__init__-48"><a href="#Apriori.__init__-48"><span class="linenos">48</span></a>        
</span><span id="Apriori.__init__-49"><a href="#Apriori.__init__-49"><span class="linenos">49</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_support</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Apriori.__init__-50"><a href="#Apriori.__init__-50"><span class="linenos">50</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum support must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Apriori.__init__-51"><a href="#Apriori.__init__-51"><span class="linenos">51</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_confidence</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Apriori.__init__-52"><a href="#Apriori.__init__-52"><span class="linenos">52</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum confidence must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Apriori.__init__-53"><a href="#Apriori.__init__-53"><span class="linenos">53</span></a>        
</span><span id="Apriori.__init__-54"><a href="#Apriori.__init__-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">=</span> <span class="n">min_support</span>
</span><span id="Apriori.__init__-55"><a href="#Apriori.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span> <span class="o">=</span> <span class="n">min_confidence</span>
</span><span id="Apriori.__init__-56"><a href="#Apriori.__init__-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Apriori.__init__-57"><a href="#Apriori.__init__-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


    

                            </div>
                            <div id="Apriori.min_support" class="classattr">
                                <div class="attr variable">
            <span class="name">min_support</span>

        
    </div>
    <a class="headerlink" href="#Apriori.min_support"></a>
    
    

                            </div>
                            <div id="Apriori.min_confidence" class="classattr">
                                <div class="attr variable">
            <span class="name">min_confidence</span>

        
    </div>
    <a class="headerlink" href="#Apriori.min_confidence"></a>
    
    

                            </div>
                            <div id="Apriori.frequent_itemsets_" class="classattr">
                                <div class="attr variable">
            <span class="name">frequent_itemsets_</span>

        
    </div>
    <a class="headerlink" href="#Apriori.frequent_itemsets_"></a>
    
    

                            </div>
                            <div id="Apriori.rules_" class="classattr">
                                <div class="attr variable">
            <span class="name">rules_</span>

        
    </div>
    <a class="headerlink" href="#Apriori.rules_"></a>
    
    

                            </div>
                            <div id="Apriori.fit" class="classattr">
                                        <input id="Apriori.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">transactions</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Apriori.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Apriori.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Apriori.fit-59"><a href="#Apriori.fit-59"><span class="linenos">59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Apriori.fit-60"><a href="#Apriori.fit-60"><span class="linenos">60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori.fit-61"><a href="#Apriori.fit-61"><span class="linenos">61</span></a><span class="sd">        Main method for learning frequent itemsets and rules.</span>
</span><span id="Apriori.fit-62"><a href="#Apriori.fit-62"><span class="linenos">62</span></a><span class="sd">        </span>
</span><span id="Apriori.fit-63"><a href="#Apriori.fit-63"><span class="linenos">63</span></a><span class="sd">        Args:</span>
</span><span id="Apriori.fit-64"><a href="#Apriori.fit-64"><span class="linenos">64</span></a><span class="sd">            transactions: Input data (list[set])</span>
</span><span id="Apriori.fit-65"><a href="#Apriori.fit-65"><span class="linenos">65</span></a><span class="sd">            </span>
</span><span id="Apriori.fit-66"><a href="#Apriori.fit-66"><span class="linenos">66</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori.fit-67"><a href="#Apriori.fit-67"><span class="linenos">67</span></a><span class="sd">            self: The current instance for method chaining</span>
</span><span id="Apriori.fit-68"><a href="#Apriori.fit-68"><span class="linenos">68</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori.fit-69"><a href="#Apriori.fit-69"><span class="linenos">69</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Apriori.fit-70"><a href="#Apriori.fit-70"><span class="linenos">70</span></a>        
</span><span id="Apriori.fit-71"><a href="#Apriori.fit-71"><span class="linenos">71</span></a>        <span class="c1"># Check the conformity of the input data format</span>
</span><span id="Apriori.fit-72"><a href="#Apriori.fit-72"><span class="linenos">72</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Apriori.fit-73"><a href="#Apriori.fit-73"><span class="linenos">73</span></a>            <span class="n">transactions_list</span> <span class="o">=</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_list</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
</span><span id="Apriori.fit-74"><a href="#Apriori.fit-74"><span class="linenos">74</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Apriori.fit-75"><a href="#Apriori.fit-75"><span class="linenos">75</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data format not respected! Only List[set] format is accepted.&quot;</span><span class="p">)</span>
</span><span id="Apriori.fit-76"><a href="#Apriori.fit-76"><span class="linenos">76</span></a>        
</span><span id="Apriori.fit-77"><a href="#Apriori.fit-77"><span class="linenos">77</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Applying Apriori algorithm with:&quot;</span><span class="p">)</span>
</span><span id="Apriori.fit-78"><a href="#Apriori.fit-78"><span class="linenos">78</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Apriori.fit-79"><a href="#Apriori.fit-79"><span class="linenos">79</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum confidence: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Apriori.fit-80"><a href="#Apriori.fit-80"><span class="linenos">80</span></a>
</span><span id="Apriori.fit-81"><a href="#Apriori.fit-81"><span class="linenos">81</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of valid transactions: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Apriori.fit-82"><a href="#Apriori.fit-82"><span class="linenos">82</span></a>        <span class="k">if</span> <span class="n">transactions_list</span><span class="p">:</span>
</span><span id="Apriori.fit-83"><a href="#Apriori.fit-83"><span class="linenos">83</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Example transaction: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])[:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="Apriori.fit-84"><a href="#Apriori.fit-84"><span class="linenos">84</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Apriori.fit-85"><a href="#Apriori.fit-85"><span class="linenos">85</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Apriori.fit-86"><a href="#Apriori.fit-86"><span class="linenos">86</span></a>
</span><span id="Apriori.fit-87"><a href="#Apriori.fit-87"><span class="linenos">87</span></a>        <span class="c1"># Generate frequent itemsets</span>
</span><span id="Apriori.fit-88"><a href="#Apriori.fit-88"><span class="linenos">88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_apriori</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Apriori.fit-89"><a href="#Apriori.fit-89"><span class="linenos">89</span></a>        <span class="c1"># Generate association rules</span>
</span><span id="Apriori.fit-90"><a href="#Apriori.fit-90"><span class="linenos">90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_rules</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Apriori.fit-91"><a href="#Apriori.fit-91"><span class="linenos">91</span></a>
</span><span id="Apriori.fit-92"><a href="#Apriori.fit-92"><span class="linenos">92</span></a>        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Apriori.fit-93"><a href="#Apriori.fit-93"><span class="linenos">93</span></a>
</span><span id="Apriori.fit-94"><a href="#Apriori.fit-94"><span class="linenos">94</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="Apriori.fit-95"><a href="#Apriori.fit-95"><span class="linenos">95</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Main method for learning frequent itemsets and rules.</p>

<p>Args:
    transactions: Input data (list[set])</p>

<p>Returns:
    self: The current instance for method chaining</p>
</div>


                            </div>
                            <div id="Apriori.get_frequent_itemsets" class="classattr">
                                        <input id="Apriori.get_frequent_itemsets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_frequent_itemsets</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Apriori.get_frequent_itemsets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Apriori.get_frequent_itemsets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Apriori.get_frequent_itemsets-239"><a href="#Apriori.get_frequent_itemsets-239"><span class="linenos">239</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_frequent_itemsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Apriori.get_frequent_itemsets-240"><a href="#Apriori.get_frequent_itemsets-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori.get_frequent_itemsets-241"><a href="#Apriori.get_frequent_itemsets-241"><span class="linenos">241</span></a><span class="sd">        Retrieve the discovered frequent itemsets.</span>
</span><span id="Apriori.get_frequent_itemsets-242"><a href="#Apriori.get_frequent_itemsets-242"><span class="linenos">242</span></a><span class="sd">        </span>
</span><span id="Apriori.get_frequent_itemsets-243"><a href="#Apriori.get_frequent_itemsets-243"><span class="linenos">243</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori.get_frequent_itemsets-244"><a href="#Apriori.get_frequent_itemsets-244"><span class="linenos">244</span></a><span class="sd">            dict: Dictionary of frequent itemsets where keys are sizes</span>
</span><span id="Apriori.get_frequent_itemsets-245"><a href="#Apriori.get_frequent_itemsets-245"><span class="linenos">245</span></a><span class="sd">                and values are sets of itemsets</span>
</span><span id="Apriori.get_frequent_itemsets-246"><a href="#Apriori.get_frequent_itemsets-246"><span class="linenos">246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori.get_frequent_itemsets-247"><a href="#Apriori.get_frequent_itemsets-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the discovered frequent itemsets.</p>

<p>Returns:
    dict: Dictionary of frequent itemsets where keys are sizes
        and values are sets of itemsets</p>
</div>


                            </div>
                            <div id="Apriori.get_rules" class="classattr">
                                        <input id="Apriori.get_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_rules</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Apriori.get_rules-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Apriori.get_rules"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Apriori.get_rules-249"><a href="#Apriori.get_rules-249"><span class="linenos">249</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Apriori.get_rules-250"><a href="#Apriori.get_rules-250"><span class="linenos">250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Apriori.get_rules-251"><a href="#Apriori.get_rules-251"><span class="linenos">251</span></a><span class="sd">        Retrieve the generated association rules.</span>
</span><span id="Apriori.get_rules-252"><a href="#Apriori.get_rules-252"><span class="linenos">252</span></a><span class="sd">        </span>
</span><span id="Apriori.get_rules-253"><a href="#Apriori.get_rules-253"><span class="linenos">253</span></a><span class="sd">        Returns:</span>
</span><span id="Apriori.get_rules-254"><a href="#Apriori.get_rules-254"><span class="linenos">254</span></a><span class="sd">            List of association rules</span>
</span><span id="Apriori.get_rules-255"><a href="#Apriori.get_rules-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Apriori.get_rules-256"><a href="#Apriori.get_rules-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the generated association rules.</p>

<p>Returns:
    List of association rules</p>
</div>


                            </div>
                </section>
                <section id="Eclat">
                            <input id="Eclat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Eclat</span>:

                <label class="view-source-button" for="Eclat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Eclat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Eclat-6"><a href="#Eclat-6"><span class="linenos">  6</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Eclat</span><span class="p">:</span>
</span><span id="Eclat-7"><a href="#Eclat-7"><span class="linenos">  7</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat-8"><a href="#Eclat-8"><span class="linenos">  8</span></a><span class="sd">    The ECLAT (**Equivalence Class Clustering and bottom-up Lattice Traversal**) algorithm is a depth-first search algorithm that uses a vertical database</span>
</span><span id="Eclat-9"><a href="#Eclat-9"><span class="linenos">  9</span></a><span class="sd">    structure. Rather than explicitly listing all transactions, each item is associated </span>
</span><span id="Eclat-10"><a href="#Eclat-10"><span class="linenos"> 10</span></a><span class="sd">    with its coverage (or list of transactions containing that item). The intersection </span>
</span><span id="Eclat-11"><a href="#Eclat-11"><span class="linenos"> 11</span></a><span class="sd">    approach is used to calculate the support of itemsets. This algorithm is particularly </span>
</span><span id="Eclat-12"><a href="#Eclat-12"><span class="linenos"> 12</span></a><span class="sd">    efficient for small datasets and requires less space and time than the Apriori </span>
</span><span id="Eclat-13"><a href="#Eclat-13"><span class="linenos"> 13</span></a><span class="sd">    algorithm to generate frequent patterns.</span>
</span><span id="Eclat-14"><a href="#Eclat-14"><span class="linenos"> 14</span></a>
</span><span id="Eclat-15"><a href="#Eclat-15"><span class="linenos"> 15</span></a><span class="sd">    For details on algorithm consult </span>
</span><span id="Eclat-16"><a href="#Eclat-16"><span class="linenos"> 16</span></a><span class="sd">    `research paper &lt;https://sci2s.ugr.es/keel/pdf/algorithm/articulo/2000%20-%20IEEETKDE%20-%20Zaki%20-%20(Eclat)%20ScalableAlgorithms%20for%20Association%20Mining%20.pdf&gt;`_.</span>
</span><span id="Eclat-17"><a href="#Eclat-17"><span class="linenos"> 17</span></a>
</span><span id="Eclat-18"><a href="#Eclat-18"><span class="linenos"> 18</span></a><span class="sd">    Args:</span>
</span><span id="Eclat-19"><a href="#Eclat-19"><span class="linenos"> 19</span></a><span class="sd">        min_support (float): Minimum support threshold (between 0 and 1) for frequent itemsets.</span>
</span><span id="Eclat-20"><a href="#Eclat-20"><span class="linenos"> 20</span></a><span class="sd">        min_confidence (float): Minimum confidence threshold (between 0 and 1) for association rules.</span>
</span><span id="Eclat-21"><a href="#Eclat-21"><span class="linenos"> 21</span></a><span class="sd">        </span>
</span><span id="Eclat-22"><a href="#Eclat-22"><span class="linenos"> 22</span></a><span class="sd">    Examples:</span>
</span><span id="Eclat-23"><a href="#Eclat-23"><span class="linenos"> 23</span></a>
</span><span id="Eclat-24"><a href="#Eclat-24"><span class="linenos"> 24</span></a><span class="sd">    &gt;&gt;&gt; transactions = [</span>
</span><span id="Eclat-25"><a href="#Eclat-25"><span class="linenos"> 25</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;butter&#39;},</span>
</span><span id="Eclat-26"><a href="#Eclat-26"><span class="linenos"> 26</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;jam&#39;, &#39;eggs&#39;},</span>
</span><span id="Eclat-27"><a href="#Eclat-27"><span class="linenos"> 27</span></a><span class="sd">    ...     {&#39;milk&#39;, &#39;butter&#39;, &#39;cheese&#39;},</span>
</span><span id="Eclat-28"><a href="#Eclat-28"><span class="linenos"> 28</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;butter&#39;, &#39;cheese&#39;},</span>
</span><span id="Eclat-29"><a href="#Eclat-29"><span class="linenos"> 29</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;jam&#39;, &#39;milk&#39;}</span>
</span><span id="Eclat-30"><a href="#Eclat-30"><span class="linenos"> 30</span></a><span class="sd">    ... ]</span>
</span><span id="Eclat-31"><a href="#Eclat-31"><span class="linenos"> 31</span></a><span class="sd">    &gt;&gt;&gt; from ifri_mini_ml_lib.association_rules import Eclat</span>
</span><span id="Eclat-32"><a href="#Eclat-32"><span class="linenos"> 32</span></a><span class="sd">    &gt;&gt;&gt; eclat = Eclat(min_support=0.4, min_confidence=0.6)</span>
</span><span id="Eclat-33"><a href="#Eclat-33"><span class="linenos"> 33</span></a><span class="sd">    &gt;&gt;&gt; eclat.fit(transactions) # Frequents itemsets + Rules generation</span>
</span><span id="Eclat-34"><a href="#Eclat-34"><span class="linenos"> 34</span></a><span class="sd">    &lt;ifri_mini_ml_lib.association_rules.eclat.Eclat object&gt;</span>
</span><span id="Eclat-35"><a href="#Eclat-35"><span class="linenos"> 35</span></a><span class="sd">    &gt;&gt;&gt; frequent_itemsets = eclat.get_frequent_itemsets()</span>
</span><span id="Eclat-36"><a href="#Eclat-36"><span class="linenos"> 36</span></a><span class="sd">    &gt;&gt;&gt; # Displaying frequent itemsets of size 1</span>
</span><span id="Eclat-37"><a href="#Eclat-37"><span class="linenos"> 37</span></a><span class="sd">    &gt;&gt;&gt; for itemset, tidset in frequent_itemsets[1].items():</span>
</span><span id="Eclat-38"><a href="#Eclat-38"><span class="linenos"> 38</span></a><span class="sd">    ...     item = list(itemset)[0]</span>
</span><span id="Eclat-39"><a href="#Eclat-39"><span class="linenos"> 39</span></a><span class="sd">    ...     support = len(tidset) / len(transactions)</span>
</span><span id="Eclat-40"><a href="#Eclat-40"><span class="linenos"> 40</span></a><span class="sd">    ...     print(f&quot;Item: {item}, Support: {support:.2f}&quot;)</span>
</span><span id="Eclat-41"><a href="#Eclat-41"><span class="linenos"> 41</span></a><span class="sd">    Item: bread, Support: 0.80</span>
</span><span id="Eclat-42"><a href="#Eclat-42"><span class="linenos"> 42</span></a><span class="sd">    Item: milk, Support: 0.80</span>
</span><span id="Eclat-43"><a href="#Eclat-43"><span class="linenos"> 43</span></a><span class="sd">    Item: butter, Support: 0.60</span>
</span><span id="Eclat-44"><a href="#Eclat-44"><span class="linenos"> 44</span></a><span class="sd">    &gt;&gt;&gt; rules = eclat.get_rules()</span>
</span><span id="Eclat-45"><a href="#Eclat-45"><span class="linenos"> 45</span></a><span class="sd">    &gt;&gt;&gt; # Displaying some association rules</span>
</span><span id="Eclat-46"><a href="#Eclat-46"><span class="linenos"> 46</span></a><span class="sd">    &gt;&gt;&gt; if rules:</span>
</span><span id="Eclat-47"><a href="#Eclat-47"><span class="linenos"> 47</span></a><span class="sd">    ...     for rule in rules[:2]:</span>
</span><span id="Eclat-48"><a href="#Eclat-48"><span class="linenos"> 48</span></a><span class="sd">    ...         print(f&quot;{set(rule[&#39;antecedent&#39;])} -&gt; {set(rule[&#39;consequent&#39;])}, &quot;</span>
</span><span id="Eclat-49"><a href="#Eclat-49"><span class="linenos"> 49</span></a><span class="sd">    ...               f&quot;Confidence: {rule[&#39;confidence&#39;]:.2f}, Lift: {rule[&#39;lift&#39;]:.2f}&quot;)</span>
</span><span id="Eclat-50"><a href="#Eclat-50"><span class="linenos"> 50</span></a><span class="sd">    {&#39;milk&#39;} -&gt; {&#39;bread&#39;}, Confidence: 0.75, Lift: 0.94</span>
</span><span id="Eclat-51"><a href="#Eclat-51"><span class="linenos"> 51</span></a><span class="sd">    {&#39;bread&#39;} -&gt; {&#39;milk&#39;}, Confidence: 0.75, Lift: 0.94</span>
</span><span id="Eclat-52"><a href="#Eclat-52"><span class="linenos"> 52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Eclat-53"><a href="#Eclat-53"><span class="linenos"> 53</span></a>
</span><span id="Eclat-54"><a href="#Eclat-54"><span class="linenos"> 54</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_confidence</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
</span><span id="Eclat-55"><a href="#Eclat-55"><span class="linenos"> 55</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_support</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Eclat-56"><a href="#Eclat-56"><span class="linenos"> 56</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum support must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Eclat-57"><a href="#Eclat-57"><span class="linenos"> 57</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_confidence</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Eclat-58"><a href="#Eclat-58"><span class="linenos"> 58</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum confidence must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Eclat-59"><a href="#Eclat-59"><span class="linenos"> 59</span></a>
</span><span id="Eclat-60"><a href="#Eclat-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">=</span> <span class="n">min_support</span>
</span><span id="Eclat-61"><a href="#Eclat-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span> <span class="o">=</span> <span class="n">min_confidence</span>
</span><span id="Eclat-62"><a href="#Eclat-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Eclat-63"><a href="#Eclat-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_TIDsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Eclat-64"><a href="#Eclat-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Eclat-65"><a href="#Eclat-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Eclat-66"><a href="#Eclat-66"><span class="linenos"> 66</span></a>
</span><span id="Eclat-67"><a href="#Eclat-67"><span class="linenos"> 67</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">):</span>
</span><span id="Eclat-68"><a href="#Eclat-68"><span class="linenos"> 68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat-69"><a href="#Eclat-69"><span class="linenos"> 69</span></a><span class="sd">        Main method for learning frequent itemsets.</span>
</span><span id="Eclat-70"><a href="#Eclat-70"><span class="linenos"> 70</span></a><span class="sd">        </span>
</span><span id="Eclat-71"><a href="#Eclat-71"><span class="linenos"> 71</span></a><span class="sd">        Args:</span>
</span><span id="Eclat-72"><a href="#Eclat-72"><span class="linenos"> 72</span></a><span class="sd">            transactions: List of transactions (each transaction is a set of items)</span>
</span><span id="Eclat-73"><a href="#Eclat-73"><span class="linenos"> 73</span></a>
</span><span id="Eclat-74"><a href="#Eclat-74"><span class="linenos"> 74</span></a><span class="sd">        Returns:</span>
</span><span id="Eclat-75"><a href="#Eclat-75"><span class="linenos"> 75</span></a><span class="sd">            self: The current instance for method chaining</span>
</span><span id="Eclat-76"><a href="#Eclat-76"><span class="linenos"> 76</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat-77"><a href="#Eclat-77"><span class="linenos"> 77</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Eclat-78"><a href="#Eclat-78"><span class="linenos"> 78</span></a>        
</span><span id="Eclat-79"><a href="#Eclat-79"><span class="linenos"> 79</span></a>        <span class="c1"># Check the conformity of the input data format</span>
</span><span id="Eclat-80"><a href="#Eclat-80"><span class="linenos"> 80</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Eclat-81"><a href="#Eclat-81"><span class="linenos"> 81</span></a>            <span class="n">transactions_list</span> <span class="o">=</span> <span class="n">transactions</span>
</span><span id="Eclat-82"><a href="#Eclat-82"><span class="linenos"> 82</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Eclat-83"><a href="#Eclat-83"><span class="linenos"> 83</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data format not respected! Only List[set] format is accepted.&quot;</span><span class="p">)</span>
</span><span id="Eclat-84"><a href="#Eclat-84"><span class="linenos"> 84</span></a>        
</span><span id="Eclat-85"><a href="#Eclat-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Eclat-86"><a href="#Eclat-86"><span class="linenos"> 86</span></a>        
</span><span id="Eclat-87"><a href="#Eclat-87"><span class="linenos"> 87</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Applying Eclat algorithm with:&quot;</span><span class="p">)</span>
</span><span id="Eclat-88"><a href="#Eclat-88"><span class="linenos"> 88</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Eclat-89"><a href="#Eclat-89"><span class="linenos"> 89</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum confidence: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Eclat-90"><a href="#Eclat-90"><span class="linenos"> 90</span></a>        <span class="k">if</span> <span class="n">transactions_list</span><span class="p">:</span>
</span><span id="Eclat-91"><a href="#Eclat-91"><span class="linenos"> 91</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of valid transactions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Eclat-92"><a href="#Eclat-92"><span class="linenos"> 92</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Eclat-93"><a href="#Eclat-93"><span class="linenos"> 93</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Eclat-94"><a href="#Eclat-94"><span class="linenos"> 94</span></a>
</span><span id="Eclat-95"><a href="#Eclat-95"><span class="linenos"> 95</span></a>        <span class="c1"># Find frequent itemsets</span>
</span><span id="Eclat-96"><a href="#Eclat-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_eclat</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Eclat-97"><a href="#Eclat-97"><span class="linenos"> 97</span></a>
</span><span id="Eclat-98"><a href="#Eclat-98"><span class="linenos"> 98</span></a>        <span class="c1"># Generate association rules</span>
</span><span id="Eclat-99"><a href="#Eclat-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_rules</span><span class="p">()</span>
</span><span id="Eclat-100"><a href="#Eclat-100"><span class="linenos">100</span></a>
</span><span id="Eclat-101"><a href="#Eclat-101"><span class="linenos">101</span></a>        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Eclat-102"><a href="#Eclat-102"><span class="linenos">102</span></a>
</span><span id="Eclat-103"><a href="#Eclat-103"><span class="linenos">103</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="Eclat-104"><a href="#Eclat-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Eclat-105"><a href="#Eclat-105"><span class="linenos">105</span></a>
</span><span id="Eclat-106"><a href="#Eclat-106"><span class="linenos">106</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_fit_eclat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">):</span>
</span><span id="Eclat-107"><a href="#Eclat-107"><span class="linenos">107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat-108"><a href="#Eclat-108"><span class="linenos">108</span></a><span class="sd">        Implementation of the frequent itemset extraction phase.</span>
</span><span id="Eclat-109"><a href="#Eclat-109"><span class="linenos">109</span></a><span class="sd">        </span>
</span><span id="Eclat-110"><a href="#Eclat-110"><span class="linenos">110</span></a><span class="sd">        Args:</span>
</span><span id="Eclat-111"><a href="#Eclat-111"><span class="linenos">111</span></a><span class="sd">            transactions: List of transactions (each transaction is a set of items)</span>
</span><span id="Eclat-112"><a href="#Eclat-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat-113"><a href="#Eclat-113"><span class="linenos">113</span></a>        <span class="c1"># Get all unique items in the transactions</span>
</span><span id="Eclat-114"><a href="#Eclat-114"><span class="linenos">114</span></a>        <span class="n">all_items</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">transactions</span><span class="p">))</span>
</span><span id="Eclat-115"><a href="#Eclat-115"><span class="linenos">115</span></a>        
</span><span id="Eclat-116"><a href="#Eclat-116"><span class="linenos">116</span></a>        <span class="c1"># Store frequent items of size 1</span>
</span><span id="Eclat-117"><a href="#Eclat-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_single_items_TIDset</span><span class="p">(</span><span class="n">all_items</span><span class="p">,</span> <span class="n">transactions</span><span class="p">)</span>
</span><span id="Eclat-118"><a href="#Eclat-118"><span class="linenos">118</span></a>        
</span><span id="Eclat-119"><a href="#Eclat-119"><span class="linenos">119</span></a>        <span class="c1"># Generate itemsets of increasing size</span>
</span><span id="Eclat-120"><a href="#Eclat-120"><span class="linenos">120</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Eclat-121"><a href="#Eclat-121"><span class="linenos">121</span></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>            
</span><span id="Eclat-122"><a href="#Eclat-122"><span class="linenos">122</span></a>            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Eclat-123"><a href="#Eclat-123"><span class="linenos">123</span></a>            <span class="n">candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_candidates</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="Eclat-124"><a href="#Eclat-124"><span class="linenos">124</span></a>            
</span><span id="Eclat-125"><a href="#Eclat-125"><span class="linenos">125</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="Eclat-126"><a href="#Eclat-126"><span class="linenos">126</span></a>                <span class="k">break</span>
</span><span id="Eclat-127"><a href="#Eclat-127"><span class="linenos">127</span></a>                
</span><span id="Eclat-128"><a href="#Eclat-128"><span class="linenos">128</span></a>            <span class="c1"># Calculate TIDsets for the new candidates</span>
</span><span id="Eclat-129"><a href="#Eclat-129"><span class="linenos">129</span></a>            <span class="n">level_frequent</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Eclat-130"><a href="#Eclat-130"><span class="linenos">130</span></a>            <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
</span><span id="Eclat-131"><a href="#Eclat-131"><span class="linenos">131</span></a>                <span class="n">subsets</span> <span class="o">=</span> <span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">candidate</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="Eclat-132"><a href="#Eclat-132"><span class="linenos">132</span></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">subset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">subsets</span><span class="p">):</span>
</span><span id="Eclat-133"><a href="#Eclat-133"><span class="linenos">133</span></a>                    <span class="c1"># Intersection of TIDsets of subsets</span>
</span><span id="Eclat-134"><a href="#Eclat-134"><span class="linenos">134</span></a>                    <span class="n">TIDset</span> <span class="o">=</span> <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">subset</span><span class="p">]</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">subsets</span><span class="p">])</span>
</span><span id="Eclat-135"><a href="#Eclat-135"><span class="linenos">135</span></a>                    
</span><span id="Eclat-136"><a href="#Eclat-136"><span class="linenos">136</span></a>                    <span class="c1"># Check support</span>
</span><span id="Eclat-137"><a href="#Eclat-137"><span class="linenos">137</span></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">TIDset</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="p">:</span>
</span><span id="Eclat-138"><a href="#Eclat-138"><span class="linenos">138</span></a>                        <span class="n">level_frequent</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">=</span> <span class="n">TIDset</span>
</span><span id="Eclat-139"><a href="#Eclat-139"><span class="linenos">139</span></a>            
</span><span id="Eclat-140"><a href="#Eclat-140"><span class="linenos">140</span></a>            <span class="k">if</span> <span class="n">level_frequent</span><span class="p">:</span>
</span><span id="Eclat-141"><a href="#Eclat-141"><span class="linenos">141</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">level_frequent</span>
</span><span id="Eclat-142"><a href="#Eclat-142"><span class="linenos">142</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Eclat-143"><a href="#Eclat-143"><span class="linenos">143</span></a>                <span class="k">break</span>
</span><span id="Eclat-144"><a href="#Eclat-144"><span class="linenos">144</span></a>
</span><span id="Eclat-145"><a href="#Eclat-145"><span class="linenos">145</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_single_items_TIDset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">transactions</span><span class="p">):</span>
</span><span id="Eclat-146"><a href="#Eclat-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build TIDsets for individual items&quot;&quot;&quot;</span>
</span><span id="Eclat-147"><a href="#Eclat-147"><span class="linenos">147</span></a>        <span class="n">single_items_TIDsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Eclat-148"><a href="#Eclat-148"><span class="linenos">148</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
</span><span id="Eclat-149"><a href="#Eclat-149"><span class="linenos">149</span></a>            <span class="n">TIDset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Eclat-150"><a href="#Eclat-150"><span class="linenos">150</span></a>            <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">transactions</span><span class="p">):</span>
</span><span id="Eclat-151"><a href="#Eclat-151"><span class="linenos">151</span></a>                <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">transaction</span><span class="p">:</span>
</span><span id="Eclat-152"><a href="#Eclat-152"><span class="linenos">152</span></a>                    <span class="n">TIDset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tid</span><span class="p">)</span>
</span><span id="Eclat-153"><a href="#Eclat-153"><span class="linenos">153</span></a>            
</span><span id="Eclat-154"><a href="#Eclat-154"><span class="linenos">154</span></a>            <span class="c1"># Check if the item meets the minimum support</span>
</span><span id="Eclat-155"><a href="#Eclat-155"><span class="linenos">155</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">TIDset</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="p">:</span>
</span><span id="Eclat-156"><a href="#Eclat-156"><span class="linenos">156</span></a>                <span class="n">single_items_TIDsets</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">item</span><span class="p">])]</span> <span class="o">=</span> <span class="n">TIDset</span>
</span><span id="Eclat-157"><a href="#Eclat-157"><span class="linenos">157</span></a>
</span><span id="Eclat-158"><a href="#Eclat-158"><span class="linenos">158</span></a>        <span class="k">return</span> <span class="n">single_items_TIDsets</span>
</span><span id="Eclat-159"><a href="#Eclat-159"><span class="linenos">159</span></a>    
</span><span id="Eclat-160"><a href="#Eclat-160"><span class="linenos">160</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_candidates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="Eclat-161"><a href="#Eclat-161"><span class="linenos">161</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat-162"><a href="#Eclat-162"><span class="linenos">162</span></a><span class="sd">        Generate candidates of size k from frequent itemsets of size k-1.</span>
</span><span id="Eclat-163"><a href="#Eclat-163"><span class="linenos">163</span></a><span class="sd">        </span>
</span><span id="Eclat-164"><a href="#Eclat-164"><span class="linenos">164</span></a><span class="sd">        Args:</span>
</span><span id="Eclat-165"><a href="#Eclat-165"><span class="linenos">165</span></a><span class="sd">            k: Size of candidates to generate</span>
</span><span id="Eclat-166"><a href="#Eclat-166"><span class="linenos">166</span></a><span class="sd">            </span>
</span><span id="Eclat-167"><a href="#Eclat-167"><span class="linenos">167</span></a><span class="sd">        Returns:</span>
</span><span id="Eclat-168"><a href="#Eclat-168"><span class="linenos">168</span></a><span class="sd">            Set of generated candidates</span>
</span><span id="Eclat-169"><a href="#Eclat-169"><span class="linenos">169</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat-170"><a href="#Eclat-170"><span class="linenos">170</span></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Eclat-171"><a href="#Eclat-171"><span class="linenos">171</span></a>        <span class="n">prev_frequent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="Eclat-172"><a href="#Eclat-172"><span class="linenos">172</span></a>        
</span><span id="Eclat-173"><a href="#Eclat-173"><span class="linenos">173</span></a>        <span class="k">for</span> <span class="n">itemset1</span><span class="p">,</span> <span class="n">itemset2</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">prev_frequent</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="Eclat-174"><a href="#Eclat-174"><span class="linenos">174</span></a>            <span class="c1"># Join itemsets having k-2 elements in common</span>
</span><span id="Eclat-175"><a href="#Eclat-175"><span class="linenos">175</span></a>            <span class="n">union</span> <span class="o">=</span> <span class="n">itemset1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">itemset2</span><span class="p">)</span>
</span><span id="Eclat-176"><a href="#Eclat-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">union</span><span class="p">)</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>
</span><span id="Eclat-177"><a href="#Eclat-177"><span class="linenos">177</span></a>                <span class="c1"># Check that all subsets of size k-1 are frequent</span>
</span><span id="Eclat-178"><a href="#Eclat-178"><span class="linenos">178</span></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="ow">in</span> <span class="n">prev_frequent</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">union</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
</span><span id="Eclat-179"><a href="#Eclat-179"><span class="linenos">179</span></a>                    <span class="n">candidates</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">union</span><span class="p">)</span>
</span><span id="Eclat-180"><a href="#Eclat-180"><span class="linenos">180</span></a>        
</span><span id="Eclat-181"><a href="#Eclat-181"><span class="linenos">181</span></a>        <span class="k">return</span> <span class="n">candidates</span>
</span><span id="Eclat-182"><a href="#Eclat-182"><span class="linenos">182</span></a>
</span><span id="Eclat-183"><a href="#Eclat-183"><span class="linenos">183</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Eclat-184"><a href="#Eclat-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat-185"><a href="#Eclat-185"><span class="linenos">185</span></a><span class="sd">        Generate association rules from frequent itemsets.</span>
</span><span id="Eclat-186"><a href="#Eclat-186"><span class="linenos">186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat-187"><a href="#Eclat-187"><span class="linenos">187</span></a>        
</span><span id="Eclat-188"><a href="#Eclat-188"><span class="linenos">188</span></a>        <span class="c1"># Go through all frequent itemsets of size &gt; 1</span>
</span><span id="Eclat-189"><a href="#Eclat-189"><span class="linenos">189</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Eclat-190"><a href="#Eclat-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">:</span>
</span><span id="Eclat-191"><a href="#Eclat-191"><span class="linenos">191</span></a>                <span class="k">continue</span>
</span><span id="Eclat-192"><a href="#Eclat-192"><span class="linenos">192</span></a>                
</span><span id="Eclat-193"><a href="#Eclat-193"><span class="linenos">193</span></a>            <span class="k">for</span> <span class="n">itemset</span><span class="p">,</span> <span class="n">TIDset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Eclat-194"><a href="#Eclat-194"><span class="linenos">194</span></a>                <span class="n">itemset_support</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">TIDset</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span>
</span><span id="Eclat-195"><a href="#Eclat-195"><span class="linenos">195</span></a>                
</span><span id="Eclat-196"><a href="#Eclat-196"><span class="linenos">196</span></a>                <span class="c1"># Generate all possible rules from this itemset</span>
</span><span id="Eclat-197"><a href="#Eclat-197"><span class="linenos">197</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="Eclat-198"><a href="#Eclat-198"><span class="linenos">198</span></a>                    <span class="k">for</span> <span class="n">antecedent_items</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">itemset</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="Eclat-199"><a href="#Eclat-199"><span class="linenos">199</span></a>                        <span class="n">antecedent</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">antecedent_items</span><span class="p">)</span>
</span><span id="Eclat-200"><a href="#Eclat-200"><span class="linenos">200</span></a>                        <span class="n">consequent</span> <span class="o">=</span> <span class="n">itemset</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">antecedent</span><span class="p">)</span>
</span><span id="Eclat-201"><a href="#Eclat-201"><span class="linenos">201</span></a>                        
</span><span id="Eclat-202"><a href="#Eclat-202"><span class="linenos">202</span></a>                        <span class="c1"># Calculate confidence</span>
</span><span id="Eclat-203"><a href="#Eclat-203"><span class="linenos">203</span></a>                        <span class="n">antecedent_support</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">antecedent</span><span class="p">)][</span><span class="n">antecedent</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span>
</span><span id="Eclat-204"><a href="#Eclat-204"><span class="linenos">204</span></a>                        <span class="n">confidence</span> <span class="o">=</span> <span class="n">itemset_support</span> <span class="o">/</span> <span class="n">antecedent_support</span>
</span><span id="Eclat-205"><a href="#Eclat-205"><span class="linenos">205</span></a>                        
</span><span id="Eclat-206"><a href="#Eclat-206"><span class="linenos">206</span></a>                        <span class="k">if</span> <span class="n">confidence</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="p">:</span>
</span><span id="Eclat-207"><a href="#Eclat-207"><span class="linenos">207</span></a>                            <span class="c1"># Calculate lift</span>
</span><span id="Eclat-208"><a href="#Eclat-208"><span class="linenos">208</span></a>                            <span class="n">consequent_support</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">consequent</span><span class="p">)][</span><span class="n">consequent</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span>
</span><span id="Eclat-209"><a href="#Eclat-209"><span class="linenos">209</span></a>                            <span class="n">lift</span> <span class="o">=</span> <span class="n">confidence</span> <span class="o">/</span> <span class="n">consequent_support</span>
</span><span id="Eclat-210"><a href="#Eclat-210"><span class="linenos">210</span></a>                            
</span><span id="Eclat-211"><a href="#Eclat-211"><span class="linenos">211</span></a>                            <span class="c1"># Add the rule to the list</span>
</span><span id="Eclat-212"><a href="#Eclat-212"><span class="linenos">212</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="Eclat-213"><a href="#Eclat-213"><span class="linenos">213</span></a>                                <span class="s1">&#39;antecedent&#39;</span><span class="p">:</span> <span class="n">antecedent</span><span class="p">,</span>
</span><span id="Eclat-214"><a href="#Eclat-214"><span class="linenos">214</span></a>                                <span class="s1">&#39;consequent&#39;</span><span class="p">:</span> <span class="n">consequent</span><span class="p">,</span>
</span><span id="Eclat-215"><a href="#Eclat-215"><span class="linenos">215</span></a>                                <span class="s1">&#39;support&#39;</span><span class="p">:</span> <span class="n">itemset_support</span><span class="p">,</span>
</span><span id="Eclat-216"><a href="#Eclat-216"><span class="linenos">216</span></a>                                <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">confidence</span><span class="p">,</span>
</span><span id="Eclat-217"><a href="#Eclat-217"><span class="linenos">217</span></a>                                <span class="s1">&#39;lift&#39;</span><span class="p">:</span> <span class="n">lift</span>
</span><span id="Eclat-218"><a href="#Eclat-218"><span class="linenos">218</span></a>                            <span class="p">})</span>
</span><span id="Eclat-219"><a href="#Eclat-219"><span class="linenos">219</span></a>
</span><span id="Eclat-220"><a href="#Eclat-220"><span class="linenos">220</span></a>
</span><span id="Eclat-221"><a href="#Eclat-221"><span class="linenos">221</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_frequent_itemsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Eclat-222"><a href="#Eclat-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat-223"><a href="#Eclat-223"><span class="linenos">223</span></a><span class="sd">        Retrieve the discovered frequent itemsets.</span>
</span><span id="Eclat-224"><a href="#Eclat-224"><span class="linenos">224</span></a><span class="sd">        </span>
</span><span id="Eclat-225"><a href="#Eclat-225"><span class="linenos">225</span></a><span class="sd">        Returns:</span>
</span><span id="Eclat-226"><a href="#Eclat-226"><span class="linenos">226</span></a><span class="sd">            dict: Dictionary of frequent itemsets where keys are sizes</span>
</span><span id="Eclat-227"><a href="#Eclat-227"><span class="linenos">227</span></a><span class="sd">                and values are sets of itemsets</span>
</span><span id="Eclat-228"><a href="#Eclat-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat-229"><a href="#Eclat-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span>
</span><span id="Eclat-230"><a href="#Eclat-230"><span class="linenos">230</span></a>    
</span><span id="Eclat-231"><a href="#Eclat-231"><span class="linenos">231</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Eclat-232"><a href="#Eclat-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat-233"><a href="#Eclat-233"><span class="linenos">233</span></a><span class="sd">        Accessor to retrieve the generated association rules.</span>
</span><span id="Eclat-234"><a href="#Eclat-234"><span class="linenos">234</span></a><span class="sd">        </span>
</span><span id="Eclat-235"><a href="#Eclat-235"><span class="linenos">235</span></a><span class="sd">        Returns:</span>
</span><span id="Eclat-236"><a href="#Eclat-236"><span class="linenos">236</span></a><span class="sd">            List of association rules</span>
</span><span id="Eclat-237"><a href="#Eclat-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat-238"><a href="#Eclat-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span>
</span></pre></div>


            <div class="docstring"><p>The ECLAT (<strong>Equivalence Class Clustering and bottom-up Lattice Traversal</strong>) algorithm is a depth-first search algorithm that uses a vertical database
structure. Rather than explicitly listing all transactions, each item is associated 
with its coverage (or list of transactions containing that item). The intersection 
approach is used to calculate the support of itemsets. This algorithm is particularly 
efficient for small datasets and requires less space and time than the Apriori 
algorithm to generate frequent patterns.</p>

<p>For details on algorithm consult 
<a href="https://sci2s.ugr.es/keel/pdf/algorithm/articulo/2000%20-%20IEEETKDE%20-%20Zaki%20-%20(Eclat)%20ScalableAlgorithms%20for%20Association%20Mining%20.pdf">research paper </a>.</p>

<p>Args:
    min_support (float): Minimum support threshold (between 0 and 1) for frequent itemsets.
    min_confidence (float): Minimum confidence threshold (between 0 and 1) for association rules.</p>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;jam&#39;</span><span class="p">,</span> <span class="s1">&#39;eggs&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="s1">&#39;cheese&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="s1">&#39;cheese&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;jam&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn"><a href="">ifri_mini_ml_lib.association_rules</a></span><span class="w"> </span><span class="kn">import</span> <span class="n">Eclat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eclat</span> <span class="o">=</span> <span class="n">Eclat</span><span class="p">(</span><span class="n">min_support</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eclat</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span> <span class="c1"># Frequents itemsets + Rules generation</span>
<span class="go">&lt;<a href="#Eclat">ifri_mini_ml_lib.association_rules.eclat.Eclat</a> object&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frequent_itemsets</span> <span class="o">=</span> <span class="n">eclat</span><span class="o">.</span><span class="n">get_frequent_itemsets</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Displaying frequent itemsets of size 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">itemset</span><span class="p">,</span> <span class="n">tidset</span> <span class="ow">in</span> <span class="n">frequent_itemsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">item</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itemset</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">support</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tidset</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Item: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">, Support: </span><span class="si">{</span><span class="n">support</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Item: bread, Support: 0.80</span>
<span class="go">Item: milk, Support: 0.80</span>
<span class="go">Item: butter, Support: 0.60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rules</span> <span class="o">=</span> <span class="n">eclat</span><span class="o">.</span><span class="n">get_rules</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Displaying some association rules</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">rules</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;antecedent&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;consequent&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">, &quot;</span>
<span class="gp">... </span>              <span class="sa">f</span><span class="s2">&quot;Confidence: </span><span class="si">{</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Lift: </span><span class="si">{</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;lift&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">{&#39;milk&#39;} -&gt; {&#39;bread&#39;}, Confidence: 0.75, Lift: 0.94</span>
<span class="go">{&#39;bread&#39;} -&gt; {&#39;milk&#39;}, Confidence: 0.75, Lift: 0.94</span>
</code></pre>
</div>
</div>


                            <div id="Eclat.__init__" class="classattr">
                                        <input id="Eclat.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Eclat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span></span>)</span>

                <label class="view-source-button" for="Eclat.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Eclat.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Eclat.__init__-54"><a href="#Eclat.__init__-54"><span class="linenos">54</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_confidence</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
</span><span id="Eclat.__init__-55"><a href="#Eclat.__init__-55"><span class="linenos">55</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_support</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Eclat.__init__-56"><a href="#Eclat.__init__-56"><span class="linenos">56</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum support must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Eclat.__init__-57"><a href="#Eclat.__init__-57"><span class="linenos">57</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_confidence</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Eclat.__init__-58"><a href="#Eclat.__init__-58"><span class="linenos">58</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum confidence must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="Eclat.__init__-59"><a href="#Eclat.__init__-59"><span class="linenos">59</span></a>
</span><span id="Eclat.__init__-60"><a href="#Eclat.__init__-60"><span class="linenos">60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">=</span> <span class="n">min_support</span>
</span><span id="Eclat.__init__-61"><a href="#Eclat.__init__-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span> <span class="o">=</span> <span class="n">min_confidence</span>
</span><span id="Eclat.__init__-62"><a href="#Eclat.__init__-62"><span class="linenos">62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Eclat.__init__-63"><a href="#Eclat.__init__-63"><span class="linenos">63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_TIDsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Eclat.__init__-64"><a href="#Eclat.__init__-64"><span class="linenos">64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Eclat.__init__-65"><a href="#Eclat.__init__-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="mi">0</span>
</span></pre></div>


    

                            </div>
                            <div id="Eclat.min_support" class="classattr">
                                <div class="attr variable">
            <span class="name">min_support</span>

        
    </div>
    <a class="headerlink" href="#Eclat.min_support"></a>
    
    

                            </div>
                            <div id="Eclat.min_confidence" class="classattr">
                                <div class="attr variable">
            <span class="name">min_confidence</span>

        
    </div>
    <a class="headerlink" href="#Eclat.min_confidence"></a>
    
    

                            </div>
                            <div id="Eclat.frequent_itemsets" class="classattr">
                                <div class="attr variable">
            <span class="name">frequent_itemsets</span>

        
    </div>
    <a class="headerlink" href="#Eclat.frequent_itemsets"></a>
    
    

                            </div>
                            <div id="Eclat.frequent_TIDsets" class="classattr">
                                <div class="attr variable">
            <span class="name">frequent_TIDsets</span>

        
    </div>
    <a class="headerlink" href="#Eclat.frequent_TIDsets"></a>
    
    

                            </div>
                            <div id="Eclat.rules_" class="classattr">
                                <div class="attr variable">
            <span class="name">rules_</span>

        
    </div>
    <a class="headerlink" href="#Eclat.rules_"></a>
    
    

                            </div>
                            <div id="Eclat.n_transactions" class="classattr">
                                <div class="attr variable">
            <span class="name">n_transactions</span>

        
    </div>
    <a class="headerlink" href="#Eclat.n_transactions"></a>
    
    

                            </div>
                            <div id="Eclat.fit" class="classattr">
                                        <input id="Eclat.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">transactions</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Eclat.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Eclat.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Eclat.fit-67"><a href="#Eclat.fit-67"><span class="linenos"> 67</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">):</span>
</span><span id="Eclat.fit-68"><a href="#Eclat.fit-68"><span class="linenos"> 68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat.fit-69"><a href="#Eclat.fit-69"><span class="linenos"> 69</span></a><span class="sd">        Main method for learning frequent itemsets.</span>
</span><span id="Eclat.fit-70"><a href="#Eclat.fit-70"><span class="linenos"> 70</span></a><span class="sd">        </span>
</span><span id="Eclat.fit-71"><a href="#Eclat.fit-71"><span class="linenos"> 71</span></a><span class="sd">        Args:</span>
</span><span id="Eclat.fit-72"><a href="#Eclat.fit-72"><span class="linenos"> 72</span></a><span class="sd">            transactions: List of transactions (each transaction is a set of items)</span>
</span><span id="Eclat.fit-73"><a href="#Eclat.fit-73"><span class="linenos"> 73</span></a>
</span><span id="Eclat.fit-74"><a href="#Eclat.fit-74"><span class="linenos"> 74</span></a><span class="sd">        Returns:</span>
</span><span id="Eclat.fit-75"><a href="#Eclat.fit-75"><span class="linenos"> 75</span></a><span class="sd">            self: The current instance for method chaining</span>
</span><span id="Eclat.fit-76"><a href="#Eclat.fit-76"><span class="linenos"> 76</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat.fit-77"><a href="#Eclat.fit-77"><span class="linenos"> 77</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="Eclat.fit-78"><a href="#Eclat.fit-78"><span class="linenos"> 78</span></a>        
</span><span id="Eclat.fit-79"><a href="#Eclat.fit-79"><span class="linenos"> 79</span></a>        <span class="c1"># Check the conformity of the input data format</span>
</span><span id="Eclat.fit-80"><a href="#Eclat.fit-80"><span class="linenos"> 80</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Eclat.fit-81"><a href="#Eclat.fit-81"><span class="linenos"> 81</span></a>            <span class="n">transactions_list</span> <span class="o">=</span> <span class="n">transactions</span>
</span><span id="Eclat.fit-82"><a href="#Eclat.fit-82"><span class="linenos"> 82</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Eclat.fit-83"><a href="#Eclat.fit-83"><span class="linenos"> 83</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data format not respected! Only List[set] format is accepted.&quot;</span><span class="p">)</span>
</span><span id="Eclat.fit-84"><a href="#Eclat.fit-84"><span class="linenos"> 84</span></a>        
</span><span id="Eclat.fit-85"><a href="#Eclat.fit-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Eclat.fit-86"><a href="#Eclat.fit-86"><span class="linenos"> 86</span></a>        
</span><span id="Eclat.fit-87"><a href="#Eclat.fit-87"><span class="linenos"> 87</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Applying Eclat algorithm with:&quot;</span><span class="p">)</span>
</span><span id="Eclat.fit-88"><a href="#Eclat.fit-88"><span class="linenos"> 88</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Eclat.fit-89"><a href="#Eclat.fit-89"><span class="linenos"> 89</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum confidence: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="Eclat.fit-90"><a href="#Eclat.fit-90"><span class="linenos"> 90</span></a>        <span class="k">if</span> <span class="n">transactions_list</span><span class="p">:</span>
</span><span id="Eclat.fit-91"><a href="#Eclat.fit-91"><span class="linenos"> 91</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of valid transactions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Eclat.fit-92"><a href="#Eclat.fit-92"><span class="linenos"> 92</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Eclat.fit-93"><a href="#Eclat.fit-93"><span class="linenos"> 93</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Eclat.fit-94"><a href="#Eclat.fit-94"><span class="linenos"> 94</span></a>
</span><span id="Eclat.fit-95"><a href="#Eclat.fit-95"><span class="linenos"> 95</span></a>        <span class="c1"># Find frequent itemsets</span>
</span><span id="Eclat.fit-96"><a href="#Eclat.fit-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_eclat</span><span class="p">(</span><span class="n">transactions_list</span><span class="p">)</span>
</span><span id="Eclat.fit-97"><a href="#Eclat.fit-97"><span class="linenos"> 97</span></a>
</span><span id="Eclat.fit-98"><a href="#Eclat.fit-98"><span class="linenos"> 98</span></a>        <span class="c1"># Generate association rules</span>
</span><span id="Eclat.fit-99"><a href="#Eclat.fit-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_rules</span><span class="p">()</span>
</span><span id="Eclat.fit-100"><a href="#Eclat.fit-100"><span class="linenos">100</span></a>
</span><span id="Eclat.fit-101"><a href="#Eclat.fit-101"><span class="linenos">101</span></a>        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="Eclat.fit-102"><a href="#Eclat.fit-102"><span class="linenos">102</span></a>
</span><span id="Eclat.fit-103"><a href="#Eclat.fit-103"><span class="linenos">103</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="Eclat.fit-104"><a href="#Eclat.fit-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Main method for learning frequent itemsets.</p>

<p>Args:
    transactions: List of transactions (each transaction is a set of items)</p>

<p>Returns:
    self: The current instance for method chaining</p>
</div>


                            </div>
                            <div id="Eclat.get_single_items_TIDset" class="classattr">
                                        <input id="Eclat.get_single_items_TIDset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_single_items_TIDset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">items</span>, </span><span class="param"><span class="n">transactions</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Eclat.get_single_items_TIDset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Eclat.get_single_items_TIDset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Eclat.get_single_items_TIDset-145"><a href="#Eclat.get_single_items_TIDset-145"><span class="linenos">145</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_single_items_TIDset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">transactions</span><span class="p">):</span>
</span><span id="Eclat.get_single_items_TIDset-146"><a href="#Eclat.get_single_items_TIDset-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build TIDsets for individual items&quot;&quot;&quot;</span>
</span><span id="Eclat.get_single_items_TIDset-147"><a href="#Eclat.get_single_items_TIDset-147"><span class="linenos">147</span></a>        <span class="n">single_items_TIDsets</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Eclat.get_single_items_TIDset-148"><a href="#Eclat.get_single_items_TIDset-148"><span class="linenos">148</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
</span><span id="Eclat.get_single_items_TIDset-149"><a href="#Eclat.get_single_items_TIDset-149"><span class="linenos">149</span></a>            <span class="n">TIDset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Eclat.get_single_items_TIDset-150"><a href="#Eclat.get_single_items_TIDset-150"><span class="linenos">150</span></a>            <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">transactions</span><span class="p">):</span>
</span><span id="Eclat.get_single_items_TIDset-151"><a href="#Eclat.get_single_items_TIDset-151"><span class="linenos">151</span></a>                <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">transaction</span><span class="p">:</span>
</span><span id="Eclat.get_single_items_TIDset-152"><a href="#Eclat.get_single_items_TIDset-152"><span class="linenos">152</span></a>                    <span class="n">TIDset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tid</span><span class="p">)</span>
</span><span id="Eclat.get_single_items_TIDset-153"><a href="#Eclat.get_single_items_TIDset-153"><span class="linenos">153</span></a>            
</span><span id="Eclat.get_single_items_TIDset-154"><a href="#Eclat.get_single_items_TIDset-154"><span class="linenos">154</span></a>            <span class="c1"># Check if the item meets the minimum support</span>
</span><span id="Eclat.get_single_items_TIDset-155"><a href="#Eclat.get_single_items_TIDset-155"><span class="linenos">155</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">TIDset</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="p">:</span>
</span><span id="Eclat.get_single_items_TIDset-156"><a href="#Eclat.get_single_items_TIDset-156"><span class="linenos">156</span></a>                <span class="n">single_items_TIDsets</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">item</span><span class="p">])]</span> <span class="o">=</span> <span class="n">TIDset</span>
</span><span id="Eclat.get_single_items_TIDset-157"><a href="#Eclat.get_single_items_TIDset-157"><span class="linenos">157</span></a>
</span><span id="Eclat.get_single_items_TIDset-158"><a href="#Eclat.get_single_items_TIDset-158"><span class="linenos">158</span></a>        <span class="k">return</span> <span class="n">single_items_TIDsets</span>
</span></pre></div>


            <div class="docstring"><p>Build TIDsets for individual items</p>
</div>


                            </div>
                            <div id="Eclat.get_frequent_itemsets" class="classattr">
                                        <input id="Eclat.get_frequent_itemsets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_frequent_itemsets</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Eclat.get_frequent_itemsets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Eclat.get_frequent_itemsets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Eclat.get_frequent_itemsets-221"><a href="#Eclat.get_frequent_itemsets-221"><span class="linenos">221</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_frequent_itemsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Eclat.get_frequent_itemsets-222"><a href="#Eclat.get_frequent_itemsets-222"><span class="linenos">222</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat.get_frequent_itemsets-223"><a href="#Eclat.get_frequent_itemsets-223"><span class="linenos">223</span></a><span class="sd">        Retrieve the discovered frequent itemsets.</span>
</span><span id="Eclat.get_frequent_itemsets-224"><a href="#Eclat.get_frequent_itemsets-224"><span class="linenos">224</span></a><span class="sd">        </span>
</span><span id="Eclat.get_frequent_itemsets-225"><a href="#Eclat.get_frequent_itemsets-225"><span class="linenos">225</span></a><span class="sd">        Returns:</span>
</span><span id="Eclat.get_frequent_itemsets-226"><a href="#Eclat.get_frequent_itemsets-226"><span class="linenos">226</span></a><span class="sd">            dict: Dictionary of frequent itemsets where keys are sizes</span>
</span><span id="Eclat.get_frequent_itemsets-227"><a href="#Eclat.get_frequent_itemsets-227"><span class="linenos">227</span></a><span class="sd">                and values are sets of itemsets</span>
</span><span id="Eclat.get_frequent_itemsets-228"><a href="#Eclat.get_frequent_itemsets-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat.get_frequent_itemsets-229"><a href="#Eclat.get_frequent_itemsets-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the discovered frequent itemsets.</p>

<p>Returns:
    dict: Dictionary of frequent itemsets where keys are sizes
        and values are sets of itemsets</p>
</div>


                            </div>
                            <div id="Eclat.get_rules" class="classattr">
                                        <input id="Eclat.get_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_rules</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Eclat.get_rules-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Eclat.get_rules"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Eclat.get_rules-231"><a href="#Eclat.get_rules-231"><span class="linenos">231</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Eclat.get_rules-232"><a href="#Eclat.get_rules-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Eclat.get_rules-233"><a href="#Eclat.get_rules-233"><span class="linenos">233</span></a><span class="sd">        Accessor to retrieve the generated association rules.</span>
</span><span id="Eclat.get_rules-234"><a href="#Eclat.get_rules-234"><span class="linenos">234</span></a><span class="sd">        </span>
</span><span id="Eclat.get_rules-235"><a href="#Eclat.get_rules-235"><span class="linenos">235</span></a><span class="sd">        Returns:</span>
</span><span id="Eclat.get_rules-236"><a href="#Eclat.get_rules-236"><span class="linenos">236</span></a><span class="sd">            List of association rules</span>
</span><span id="Eclat.get_rules-237"><a href="#Eclat.get_rules-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Eclat.get_rules-238"><a href="#Eclat.get_rules-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span>
</span></pre></div>


            <div class="docstring"><p>Accessor to retrieve the generated association rules.</p>

<p>Returns:
    List of association rules</p>
</div>


                            </div>
                </section>
                <section id="FPGrowth">
                            <input id="FPGrowth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FPGrowth</span>:

                <label class="view-source-button" for="FPGrowth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FPGrowth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FPGrowth-30"><a href="#FPGrowth-30"><span class="linenos"> 30</span></a><span class="k">class</span><span class="w"> </span><span class="nc">FPGrowth</span><span class="p">:</span>
</span><span id="FPGrowth-31"><a href="#FPGrowth-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-32"><a href="#FPGrowth-32"><span class="linenos"> 32</span></a><span class="sd">    FP-Growth is an efficient algorithm for extracting frequent itemsets that</span>
</span><span id="FPGrowth-33"><a href="#FPGrowth-33"><span class="linenos"> 33</span></a><span class="sd">    constructs a compact data structure (FP-Tree) and extracts patterns without</span>
</span><span id="FPGrowth-34"><a href="#FPGrowth-34"><span class="linenos"> 34</span></a><span class="sd">    generating candidates, unlike Apriori or Eclat. For more details consult the following</span>
</span><span id="FPGrowth-35"><a href="#FPGrowth-35"><span class="linenos"> 35</span></a><span class="sd">    `link &lt;https://dl.acm.org/doi/10.1145/342009.335372&gt;`_.</span>
</span><span id="FPGrowth-36"><a href="#FPGrowth-36"><span class="linenos"> 36</span></a><span class="sd">    </span>
</span><span id="FPGrowth-37"><a href="#FPGrowth-37"><span class="linenos"> 37</span></a><span class="sd">    Args:</span>
</span><span id="FPGrowth-38"><a href="#FPGrowth-38"><span class="linenos"> 38</span></a><span class="sd">        min_support (float): Minimum support threshold (between 0 and 1) for frequent itemsets.</span>
</span><span id="FPGrowth-39"><a href="#FPGrowth-39"><span class="linenos"> 39</span></a><span class="sd">        min_confidence (float): Minimum confidence threshold (between 0 and 1) for association rules.</span>
</span><span id="FPGrowth-40"><a href="#FPGrowth-40"><span class="linenos"> 40</span></a>
</span><span id="FPGrowth-41"><a href="#FPGrowth-41"><span class="linenos"> 41</span></a><span class="sd">    Examples:</span>
</span><span id="FPGrowth-42"><a href="#FPGrowth-42"><span class="linenos"> 42</span></a>
</span><span id="FPGrowth-43"><a href="#FPGrowth-43"><span class="linenos"> 43</span></a><span class="sd">        &gt;&gt;&gt; transactions = [</span>
</span><span id="FPGrowth-44"><a href="#FPGrowth-44"><span class="linenos"> 44</span></a><span class="sd">        ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;butter&#39;},</span>
</span><span id="FPGrowth-45"><a href="#FPGrowth-45"><span class="linenos"> 45</span></a><span class="sd">        ...     {&#39;bread&#39;, &#39;jam&#39;, &#39;eggs&#39;},</span>
</span><span id="FPGrowth-46"><a href="#FPGrowth-46"><span class="linenos"> 46</span></a><span class="sd">        ...     {&#39;milk&#39;, &#39;butter&#39;, &#39;cheese&#39;},</span>
</span><span id="FPGrowth-47"><a href="#FPGrowth-47"><span class="linenos"> 47</span></a><span class="sd">        ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;butter&#39;, &#39;cheese&#39;},</span>
</span><span id="FPGrowth-48"><a href="#FPGrowth-48"><span class="linenos"> 48</span></a><span class="sd">        ...     {&#39;bread&#39;, &#39;jam&#39;, &#39;milk&#39;}</span>
</span><span id="FPGrowth-49"><a href="#FPGrowth-49"><span class="linenos"> 49</span></a><span class="sd">        ... ]</span>
</span><span id="FPGrowth-50"><a href="#FPGrowth-50"><span class="linenos"> 50</span></a><span class="sd">        &gt;&gt;&gt; from ifri_mini_ml_lib.association_rules import FPGrowth</span>
</span><span id="FPGrowth-51"><a href="#FPGrowth-51"><span class="linenos"> 51</span></a><span class="sd">        &gt;&gt;&gt; fp_growth = FPGrowth(min_support=0.4, min_confidence=0.6)</span>
</span><span id="FPGrowth-52"><a href="#FPGrowth-52"><span class="linenos"> 52</span></a><span class="sd">        &gt;&gt;&gt; fp_growth.fit(transactions) # Frequents itemsets + Rules generation</span>
</span><span id="FPGrowth-53"><a href="#FPGrowth-53"><span class="linenos"> 53</span></a><span class="sd">        &lt;ifri_mini_ml_lib.association_rules.fp_growth.FPGrowth object&gt;</span>
</span><span id="FPGrowth-54"><a href="#FPGrowth-54"><span class="linenos"> 54</span></a><span class="sd">        &gt;&gt;&gt; frequent_itemsets = fp_growth.get_frequent_itemsets()</span>
</span><span id="FPGrowth-55"><a href="#FPGrowth-55"><span class="linenos"> 55</span></a><span class="sd">        &gt;&gt;&gt; for itemset_data in frequent_itemsets[:3]:</span>
</span><span id="FPGrowth-56"><a href="#FPGrowth-56"><span class="linenos"> 56</span></a><span class="sd">        ...     print(f&quot;Itemset: {set(itemset_data[&#39;itemset&#39;])}, Support: {itemset_data[&#39;support&#39;]:.2f}&quot;)</span>
</span><span id="FPGrowth-57"><a href="#FPGrowth-57"><span class="linenos"> 57</span></a><span class="sd">        Itemset: {&#39;bread&#39;}, Support: 0.80</span>
</span><span id="FPGrowth-58"><a href="#FPGrowth-58"><span class="linenos"> 58</span></a><span class="sd">        Itemset: {&#39;milk&#39;}, Support: 0.80</span>
</span><span id="FPGrowth-59"><a href="#FPGrowth-59"><span class="linenos"> 59</span></a><span class="sd">        Itemset: {&#39;butter&#39;}, Support: 0.60</span>
</span><span id="FPGrowth-60"><a href="#FPGrowth-60"><span class="linenos"> 60</span></a><span class="sd">        &gt;&gt;&gt; rules = fp_growth.get_rules()</span>
</span><span id="FPGrowth-61"><a href="#FPGrowth-61"><span class="linenos"> 61</span></a><span class="sd">        &gt;&gt;&gt; # Displaying some association rules</span>
</span><span id="FPGrowth-62"><a href="#FPGrowth-62"><span class="linenos"> 62</span></a><span class="sd">        &gt;&gt;&gt; if rules:</span>
</span><span id="FPGrowth-63"><a href="#FPGrowth-63"><span class="linenos"> 63</span></a><span class="sd">        ...     for rule in rules[:2]:</span>
</span><span id="FPGrowth-64"><a href="#FPGrowth-64"><span class="linenos"> 64</span></a><span class="sd">        ...         print(f&quot;{set(rule[&#39;antecedent&#39;])} -&gt; {set(rule[&#39;consequent&#39;])}, &quot;</span>
</span><span id="FPGrowth-65"><a href="#FPGrowth-65"><span class="linenos"> 65</span></a><span class="sd">        ...               f&quot;Confidence: {rule[&#39;confidence&#39;]:.2f}, Lift: {rule[&#39;lift&#39;]:.2f}&quot;)</span>
</span><span id="FPGrowth-66"><a href="#FPGrowth-66"><span class="linenos"> 66</span></a><span class="sd">        {&#39;milk&#39;} -&gt; {&#39;bread&#39;}, Confidence: 0.75, Lift: 0.94</span>
</span><span id="FPGrowth-67"><a href="#FPGrowth-67"><span class="linenos"> 67</span></a><span class="sd">        {&#39;bread&#39;} -&gt; {&#39;milk&#39;}, Confidence: 0.75, Lift: 0.94</span>
</span><span id="FPGrowth-68"><a href="#FPGrowth-68"><span class="linenos"> 68</span></a>
</span><span id="FPGrowth-69"><a href="#FPGrowth-69"><span class="linenos"> 69</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FPGrowth-70"><a href="#FPGrowth-70"><span class="linenos"> 70</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="FPGrowth-71"><a href="#FPGrowth-71"><span class="linenos"> 71</span></a>        
</span><span id="FPGrowth-72"><a href="#FPGrowth-72"><span class="linenos"> 72</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_support</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FPGrowth-73"><a href="#FPGrowth-73"><span class="linenos"> 73</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum support must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-74"><a href="#FPGrowth-74"><span class="linenos"> 74</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_confidence</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FPGrowth-75"><a href="#FPGrowth-75"><span class="linenos"> 75</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum confidence must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-76"><a href="#FPGrowth-76"><span class="linenos"> 76</span></a>        
</span><span id="FPGrowth-77"><a href="#FPGrowth-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">=</span> <span class="n">min_support</span>
</span><span id="FPGrowth-78"><a href="#FPGrowth-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span> <span class="o">=</span> <span class="n">min_confidence</span>
</span><span id="FPGrowth-79"><a href="#FPGrowth-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="FPGrowth-80"><a href="#FPGrowth-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FPGrowth-81"><a href="#FPGrowth-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="FPGrowth-82"><a href="#FPGrowth-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FPGrowth-83"><a href="#FPGrowth-83"><span class="linenos"> 83</span></a>        
</span><span id="FPGrowth-84"><a href="#FPGrowth-84"><span class="linenos"> 84</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">):</span>
</span><span id="FPGrowth-85"><a href="#FPGrowth-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-86"><a href="#FPGrowth-86"><span class="linenos"> 86</span></a><span class="sd">        Builds the FP-Tree and extracts frequent itemsets.</span>
</span><span id="FPGrowth-87"><a href="#FPGrowth-87"><span class="linenos"> 87</span></a><span class="sd">        </span>
</span><span id="FPGrowth-88"><a href="#FPGrowth-88"><span class="linenos"> 88</span></a><span class="sd">        Args:</span>
</span><span id="FPGrowth-89"><a href="#FPGrowth-89"><span class="linenos"> 89</span></a><span class="sd">            transactions: List of transactions (each transaction is a set of items)</span>
</span><span id="FPGrowth-90"><a href="#FPGrowth-90"><span class="linenos"> 90</span></a><span class="sd">            </span>
</span><span id="FPGrowth-91"><a href="#FPGrowth-91"><span class="linenos"> 91</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth-92"><a href="#FPGrowth-92"><span class="linenos"> 92</span></a><span class="sd">            self: The current instance for method chaining</span>
</span><span id="FPGrowth-93"><a href="#FPGrowth-93"><span class="linenos"> 93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-94"><a href="#FPGrowth-94"><span class="linenos"> 94</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="FPGrowth-95"><a href="#FPGrowth-95"><span class="linenos"> 95</span></a>        
</span><span id="FPGrowth-96"><a href="#FPGrowth-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FPGrowth-97"><a href="#FPGrowth-97"><span class="linenos"> 97</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data format not respected! Only List[set] format is accepted.&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-98"><a href="#FPGrowth-98"><span class="linenos"> 98</span></a>            
</span><span id="FPGrowth-99"><a href="#FPGrowth-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
</span><span id="FPGrowth-100"><a href="#FPGrowth-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span><span class="p">)</span>
</span><span id="FPGrowth-101"><a href="#FPGrowth-101"><span class="linenos">101</span></a>        
</span><span id="FPGrowth-102"><a href="#FPGrowth-102"><span class="linenos">102</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Applying FP-Growth algorithm with:&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-103"><a href="#FPGrowth-103"><span class="linenos">103</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-104"><a href="#FPGrowth-104"><span class="linenos">104</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support count: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-105"><a href="#FPGrowth-105"><span class="linenos">105</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum confidence: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-106"><a href="#FPGrowth-106"><span class="linenos">106</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of valid transactions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-107"><a href="#FPGrowth-107"><span class="linenos">107</span></a>
</span><span id="FPGrowth-108"><a href="#FPGrowth-108"><span class="linenos">108</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FPGrowth-109"><a href="#FPGrowth-109"><span class="linenos">109</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FPGrowth-110"><a href="#FPGrowth-110"><span class="linenos">110</span></a>        
</span><span id="FPGrowth-111"><a href="#FPGrowth-111"><span class="linenos">111</span></a>        <span class="c1"># Step 1: Count the frequency of individual items</span>
</span><span id="FPGrowth-112"><a href="#FPGrowth-112"><span class="linenos">112</span></a>        <span class="n">item_counter</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="FPGrowth-113"><a href="#FPGrowth-113"><span class="linenos">113</span></a>        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
</span><span id="FPGrowth-114"><a href="#FPGrowth-114"><span class="linenos">114</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">transaction</span><span class="p">:</span>
</span><span id="FPGrowth-115"><a href="#FPGrowth-115"><span class="linenos">115</span></a>                <span class="n">item_counter</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="FPGrowth-116"><a href="#FPGrowth-116"><span class="linenos">116</span></a>        
</span><span id="FPGrowth-117"><a href="#FPGrowth-117"><span class="linenos">117</span></a>        <span class="c1"># Filter frequent items and create the header table</span>
</span><span id="FPGrowth-118"><a href="#FPGrowth-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FPGrowth-119"><a href="#FPGrowth-119"><span class="linenos">119</span></a>            <span class="n">item</span><span class="p">:</span> <span class="p">{</span>
</span><span id="FPGrowth-120"><a href="#FPGrowth-120"><span class="linenos">120</span></a>                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span> 
</span><span id="FPGrowth-121"><a href="#FPGrowth-121"><span class="linenos">121</span></a>                <span class="s1">&#39;head&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="FPGrowth-122"><a href="#FPGrowth-122"><span class="linenos">122</span></a>            <span class="p">}</span> 
</span><span id="FPGrowth-123"><a href="#FPGrowth-123"><span class="linenos">123</span></a>            <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">item_counter</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
</span><span id="FPGrowth-124"><a href="#FPGrowth-124"><span class="linenos">124</span></a>            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span>
</span><span id="FPGrowth-125"><a href="#FPGrowth-125"><span class="linenos">125</span></a>        <span class="p">}</span>
</span><span id="FPGrowth-126"><a href="#FPGrowth-126"><span class="linenos">126</span></a>        
</span><span id="FPGrowth-127"><a href="#FPGrowth-127"><span class="linenos">127</span></a>        <span class="c1"># Reset frequent itemsets</span>
</span><span id="FPGrowth-128"><a href="#FPGrowth-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="FPGrowth-129"><a href="#FPGrowth-129"><span class="linenos">129</span></a>        
</span><span id="FPGrowth-130"><a href="#FPGrowth-130"><span class="linenos">130</span></a>        <span class="c1"># If no frequent item is found, return</span>
</span><span id="FPGrowth-131"><a href="#FPGrowth-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">:</span>
</span><span id="FPGrowth-132"><a href="#FPGrowth-132"><span class="linenos">132</span></a>            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="FPGrowth-133"><a href="#FPGrowth-133"><span class="linenos">133</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-134"><a href="#FPGrowth-134"><span class="linenos">134</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No frequent itemset found.&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-135"><a href="#FPGrowth-135"><span class="linenos">135</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FPGrowth-136"><a href="#FPGrowth-136"><span class="linenos">136</span></a>        
</span><span id="FPGrowth-137"><a href="#FPGrowth-137"><span class="linenos">137</span></a>        <span class="c1"># Sort items by decreasing frequency</span>
</span><span id="FPGrowth-138"><a href="#FPGrowth-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="FPGrowth-139"><a href="#FPGrowth-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> 
</span><span id="FPGrowth-140"><a href="#FPGrowth-140"><span class="linenos">140</span></a>            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
</span><span id="FPGrowth-141"><a href="#FPGrowth-141"><span class="linenos">141</span></a>        <span class="p">)</span>
</span><span id="FPGrowth-142"><a href="#FPGrowth-142"><span class="linenos">142</span></a>        
</span><span id="FPGrowth-143"><a href="#FPGrowth-143"><span class="linenos">143</span></a>        <span class="c1"># Step 2: Build the FP-Tree</span>
</span><span id="FPGrowth-144"><a href="#FPGrowth-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">FPNode</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="FPGrowth-145"><a href="#FPGrowth-145"><span class="linenos">145</span></a>        
</span><span id="FPGrowth-146"><a href="#FPGrowth-146"><span class="linenos">146</span></a>        <span class="c1"># Insert each transaction into the tree</span>
</span><span id="FPGrowth-147"><a href="#FPGrowth-147"><span class="linenos">147</span></a>        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
</span><span id="FPGrowth-148"><a href="#FPGrowth-148"><span class="linenos">148</span></a>            <span class="c1"># Filter non-frequent items and sort</span>
</span><span id="FPGrowth-149"><a href="#FPGrowth-149"><span class="linenos">149</span></a>            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">transaction</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">]</span>
</span><span id="FPGrowth-150"><a href="#FPGrowth-150"><span class="linenos">150</span></a>            <span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">))</span>
</span><span id="FPGrowth-151"><a href="#FPGrowth-151"><span class="linenos">151</span></a>            
</span><span id="FPGrowth-152"><a href="#FPGrowth-152"><span class="linenos">152</span></a>            <span class="k">if</span> <span class="n">items</span><span class="p">:</span>
</span><span id="FPGrowth-153"><a href="#FPGrowth-153"><span class="linenos">153</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_insert_tree</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FPGrowth-154"><a href="#FPGrowth-154"><span class="linenos">154</span></a>        
</span><span id="FPGrowth-155"><a href="#FPGrowth-155"><span class="linenos">155</span></a>        <span class="c1"># Step 3: Extract frequent itemsets</span>
</span><span id="FPGrowth-156"><a href="#FPGrowth-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mine_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span><span class="p">)</span>
</span><span id="FPGrowth-157"><a href="#FPGrowth-157"><span class="linenos">157</span></a>
</span><span id="FPGrowth-158"><a href="#FPGrowth-158"><span class="linenos">158</span></a>        <span class="c1"># Step 4: Generate rules</span>
</span><span id="FPGrowth-159"><a href="#FPGrowth-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_rules</span><span class="p">()</span>
</span><span id="FPGrowth-160"><a href="#FPGrowth-160"><span class="linenos">160</span></a>        
</span><span id="FPGrowth-161"><a href="#FPGrowth-161"><span class="linenos">161</span></a>        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="FPGrowth-162"><a href="#FPGrowth-162"><span class="linenos">162</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-163"><a href="#FPGrowth-163"><span class="linenos">163</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of frequent itemsets found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FPGrowth-164"><a href="#FPGrowth-164"><span class="linenos">164</span></a>        
</span><span id="FPGrowth-165"><a href="#FPGrowth-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="FPGrowth-166"><a href="#FPGrowth-166"><span class="linenos">166</span></a>    
</span><span id="FPGrowth-167"><a href="#FPGrowth-167"><span class="linenos">167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_insert_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="FPGrowth-168"><a href="#FPGrowth-168"><span class="linenos">168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-169"><a href="#FPGrowth-169"><span class="linenos">169</span></a><span class="sd">        Inserts a transaction into the FP-Tree.</span>
</span><span id="FPGrowth-170"><a href="#FPGrowth-170"><span class="linenos">170</span></a><span class="sd">        </span>
</span><span id="FPGrowth-171"><a href="#FPGrowth-171"><span class="linenos">171</span></a><span class="sd">        Args:</span>
</span><span id="FPGrowth-172"><a href="#FPGrowth-172"><span class="linenos">172</span></a><span class="sd">            items: List of items in the transaction (sorted by frequency)</span>
</span><span id="FPGrowth-173"><a href="#FPGrowth-173"><span class="linenos">173</span></a><span class="sd">            node: Current node in the tree</span>
</span><span id="FPGrowth-174"><a href="#FPGrowth-174"><span class="linenos">174</span></a><span class="sd">            count: Number of occurrences to add</span>
</span><span id="FPGrowth-175"><a href="#FPGrowth-175"><span class="linenos">175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-176"><a href="#FPGrowth-176"><span class="linenos">176</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
</span><span id="FPGrowth-177"><a href="#FPGrowth-177"><span class="linenos">177</span></a>            <span class="k">return</span>
</span><span id="FPGrowth-178"><a href="#FPGrowth-178"><span class="linenos">178</span></a>        
</span><span id="FPGrowth-179"><a href="#FPGrowth-179"><span class="linenos">179</span></a>        <span class="n">item</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FPGrowth-180"><a href="#FPGrowth-180"><span class="linenos">180</span></a>        
</span><span id="FPGrowth-181"><a href="#FPGrowth-181"><span class="linenos">181</span></a>        <span class="c1"># If the item is already a child of the current node</span>
</span><span id="FPGrowth-182"><a href="#FPGrowth-182"><span class="linenos">182</span></a>        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
</span><span id="FPGrowth-183"><a href="#FPGrowth-183"><span class="linenos">183</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="FPGrowth-184"><a href="#FPGrowth-184"><span class="linenos">184</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FPGrowth-185"><a href="#FPGrowth-185"><span class="linenos">185</span></a>            <span class="c1"># Create a new node</span>
</span><span id="FPGrowth-186"><a href="#FPGrowth-186"><span class="linenos">186</span></a>            <span class="n">new_node</span> <span class="o">=</span> <span class="n">FPNode</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
</span><span id="FPGrowth-187"><a href="#FPGrowth-187"><span class="linenos">187</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_node</span>
</span><span id="FPGrowth-188"><a href="#FPGrowth-188"><span class="linenos">188</span></a>            
</span><span id="FPGrowth-189"><a href="#FPGrowth-189"><span class="linenos">189</span></a>            <span class="c1"># Update the header table (links between nodes)</span>
</span><span id="FPGrowth-190"><a href="#FPGrowth-190"><span class="linenos">190</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;head&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FPGrowth-191"><a href="#FPGrowth-191"><span class="linenos">191</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;head&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_node</span>
</span><span id="FPGrowth-192"><a href="#FPGrowth-192"><span class="linenos">192</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FPGrowth-193"><a href="#FPGrowth-193"><span class="linenos">193</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_header_link</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">new_node</span><span class="p">)</span>
</span><span id="FPGrowth-194"><a href="#FPGrowth-194"><span class="linenos">194</span></a>        
</span><span id="FPGrowth-195"><a href="#FPGrowth-195"><span class="linenos">195</span></a>        <span class="c1"># Recursive insertion for remaining items</span>
</span><span id="FPGrowth-196"><a href="#FPGrowth-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_insert_tree</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">count</span><span class="p">)</span>
</span><span id="FPGrowth-197"><a href="#FPGrowth-197"><span class="linenos">197</span></a>    
</span><span id="FPGrowth-198"><a href="#FPGrowth-198"><span class="linenos">198</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_update_header_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">target_node</span><span class="p">):</span>
</span><span id="FPGrowth-199"><a href="#FPGrowth-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update links between nodes containing the same item.&quot;&quot;&quot;</span>
</span><span id="FPGrowth-200"><a href="#FPGrowth-200"><span class="linenos">200</span></a>        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;head&#39;</span><span class="p">]</span>
</span><span id="FPGrowth-201"><a href="#FPGrowth-201"><span class="linenos">201</span></a>        <span class="k">while</span> <span class="n">current</span><span class="o">.</span><span class="n">node_link</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FPGrowth-202"><a href="#FPGrowth-202"><span class="linenos">202</span></a>            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">node_link</span>
</span><span id="FPGrowth-203"><a href="#FPGrowth-203"><span class="linenos">203</span></a>        <span class="n">current</span><span class="o">.</span><span class="n">node_link</span> <span class="o">=</span> <span class="n">target_node</span>
</span><span id="FPGrowth-204"><a href="#FPGrowth-204"><span class="linenos">204</span></a>    
</span><span id="FPGrowth-205"><a href="#FPGrowth-205"><span class="linenos">205</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_find_prefix_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
</span><span id="FPGrowth-206"><a href="#FPGrowth-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-207"><a href="#FPGrowth-207"><span class="linenos">207</span></a><span class="sd">        Finds the prefix path for a given node.</span>
</span><span id="FPGrowth-208"><a href="#FPGrowth-208"><span class="linenos">208</span></a><span class="sd">        </span>
</span><span id="FPGrowth-209"><a href="#FPGrowth-209"><span class="linenos">209</span></a><span class="sd">        Args:</span>
</span><span id="FPGrowth-210"><a href="#FPGrowth-210"><span class="linenos">210</span></a><span class="sd">            node: Node for which to find the prefix path</span>
</span><span id="FPGrowth-211"><a href="#FPGrowth-211"><span class="linenos">211</span></a><span class="sd">            </span>
</span><span id="FPGrowth-212"><a href="#FPGrowth-212"><span class="linenos">212</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth-213"><a href="#FPGrowth-213"><span class="linenos">213</span></a><span class="sd">            List of prefix paths with their support</span>
</span><span id="FPGrowth-214"><a href="#FPGrowth-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-215"><a href="#FPGrowth-215"><span class="linenos">215</span></a>        <span class="n">prefix_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FPGrowth-216"><a href="#FPGrowth-216"><span class="linenos">216</span></a>        
</span><span id="FPGrowth-217"><a href="#FPGrowth-217"><span class="linenos">217</span></a>        <span class="k">while</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FPGrowth-218"><a href="#FPGrowth-218"><span class="linenos">218</span></a>            <span class="n">prefix_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">item</span><span class="p">)</span>
</span><span id="FPGrowth-219"><a href="#FPGrowth-219"><span class="linenos">219</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parent</span>
</span><span id="FPGrowth-220"><a href="#FPGrowth-220"><span class="linenos">220</span></a>            
</span><span id="FPGrowth-221"><a href="#FPGrowth-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="n">prefix_paths</span>
</span><span id="FPGrowth-222"><a href="#FPGrowth-222"><span class="linenos">222</span></a>    
</span><span id="FPGrowth-223"><a href="#FPGrowth-223"><span class="linenos">223</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_mine_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">min_support_count</span><span class="p">):</span>
</span><span id="FPGrowth-224"><a href="#FPGrowth-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-225"><a href="#FPGrowth-225"><span class="linenos">225</span></a><span class="sd">        Recursively extracts frequent itemsets from the FP-Tree.</span>
</span><span id="FPGrowth-226"><a href="#FPGrowth-226"><span class="linenos">226</span></a><span class="sd">        </span>
</span><span id="FPGrowth-227"><a href="#FPGrowth-227"><span class="linenos">227</span></a><span class="sd">        Args:</span>
</span><span id="FPGrowth-228"><a href="#FPGrowth-228"><span class="linenos">228</span></a><span class="sd">            node: Root node of the FP-Tree</span>
</span><span id="FPGrowth-229"><a href="#FPGrowth-229"><span class="linenos">229</span></a><span class="sd">            prefix: Current prefix (itemset under construction)</span>
</span><span id="FPGrowth-230"><a href="#FPGrowth-230"><span class="linenos">230</span></a><span class="sd">            min_support_count: Minimum support in absolute count</span>
</span><span id="FPGrowth-231"><a href="#FPGrowth-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-232"><a href="#FPGrowth-232"><span class="linenos">232</span></a>        <span class="c1"># Traverse items in reverse order of frequency to</span>
</span><span id="FPGrowth-233"><a href="#FPGrowth-233"><span class="linenos">233</span></a>        <span class="c1"># generate smaller trees during extraction (optimization)</span>
</span><span id="FPGrowth-234"><a href="#FPGrowth-234"><span class="linenos">234</span></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordered_items</span><span class="p">):</span>
</span><span id="FPGrowth-235"><a href="#FPGrowth-235"><span class="linenos">235</span></a>            <span class="n">new_prefix</span> <span class="o">=</span> <span class="n">prefix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FPGrowth-236"><a href="#FPGrowth-236"><span class="linenos">236</span></a>            <span class="n">new_prefix</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="FPGrowth-237"><a href="#FPGrowth-237"><span class="linenos">237</span></a>            <span class="n">new_itemset</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">new_prefix</span><span class="p">)</span>
</span><span id="FPGrowth-238"><a href="#FPGrowth-238"><span class="linenos">238</span></a>            
</span><span id="FPGrowth-239"><a href="#FPGrowth-239"><span class="linenos">239</span></a>            <span class="c1"># Add this itemset to the list of frequent itemsets if it doesn&#39;t already exist</span>
</span><span id="FPGrowth-240"><a href="#FPGrowth-240"><span class="linenos">240</span></a>            <span class="n">support</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>
</span><span id="FPGrowth-241"><a href="#FPGrowth-241"><span class="linenos">241</span></a>            <span class="n">support_ratio</span> <span class="o">=</span> <span class="n">support</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span>
</span><span id="FPGrowth-242"><a href="#FPGrowth-242"><span class="linenos">242</span></a>            
</span><span id="FPGrowth-243"><a href="#FPGrowth-243"><span class="linenos">243</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="p">[</span><span class="n">new_itemset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FPGrowth-244"><a href="#FPGrowth-244"><span class="linenos">244</span></a>                <span class="s1">&#39;support_count&#39;</span><span class="p">:</span> <span class="n">support</span><span class="p">,</span>
</span><span id="FPGrowth-245"><a href="#FPGrowth-245"><span class="linenos">245</span></a>                <span class="s1">&#39;support&#39;</span><span class="p">:</span> <span class="n">support_ratio</span>
</span><span id="FPGrowth-246"><a href="#FPGrowth-246"><span class="linenos">246</span></a>            <span class="p">}</span>
</span><span id="FPGrowth-247"><a href="#FPGrowth-247"><span class="linenos">247</span></a>            
</span><span id="FPGrowth-248"><a href="#FPGrowth-248"><span class="linenos">248</span></a>            <span class="c1"># Build the conditional pattern base</span>
</span><span id="FPGrowth-249"><a href="#FPGrowth-249"><span class="linenos">249</span></a>            <span class="n">conditional_pattern_base</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FPGrowth-250"><a href="#FPGrowth-250"><span class="linenos">250</span></a>            
</span><span id="FPGrowth-251"><a href="#FPGrowth-251"><span class="linenos">251</span></a>            <span class="c1"># Traverse all nodes containing this item</span>
</span><span id="FPGrowth-252"><a href="#FPGrowth-252"><span class="linenos">252</span></a>            <span class="n">node_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;head&#39;</span><span class="p">]</span>
</span><span id="FPGrowth-253"><a href="#FPGrowth-253"><span class="linenos">253</span></a>            <span class="k">while</span> <span class="n">node_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FPGrowth-254"><a href="#FPGrowth-254"><span class="linenos">254</span></a>                <span class="n">prefix_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_prefix_path</span><span class="p">(</span><span class="n">node_ref</span><span class="p">)</span>
</span><span id="FPGrowth-255"><a href="#FPGrowth-255"><span class="linenos">255</span></a>                <span class="k">if</span> <span class="n">prefix_path</span><span class="p">:</span>
</span><span id="FPGrowth-256"><a href="#FPGrowth-256"><span class="linenos">256</span></a>                    <span class="n">conditional_pattern_base</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prefix_path</span><span class="p">,</span> <span class="n">node_ref</span><span class="o">.</span><span class="n">count</span><span class="p">))</span>
</span><span id="FPGrowth-257"><a href="#FPGrowth-257"><span class="linenos">257</span></a>                <span class="n">node_ref</span> <span class="o">=</span> <span class="n">node_ref</span><span class="o">.</span><span class="n">node_link</span>
</span><span id="FPGrowth-258"><a href="#FPGrowth-258"><span class="linenos">258</span></a>            
</span><span id="FPGrowth-259"><a href="#FPGrowth-259"><span class="linenos">259</span></a>            <span class="c1"># Build the conditional FP-Tree if paths exist</span>
</span><span id="FPGrowth-260"><a href="#FPGrowth-260"><span class="linenos">260</span></a>            <span class="k">if</span> <span class="n">conditional_pattern_base</span><span class="p">:</span>
</span><span id="FPGrowth-261"><a href="#FPGrowth-261"><span class="linenos">261</span></a>                <span class="n">conditional_tree</span> <span class="o">=</span> <span class="n">FPNode</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="FPGrowth-262"><a href="#FPGrowth-262"><span class="linenos">262</span></a>                
</span><span id="FPGrowth-263"><a href="#FPGrowth-263"><span class="linenos">263</span></a>                <span class="c1"># Recalculate supports in this conditional base</span>
</span><span id="FPGrowth-264"><a href="#FPGrowth-264"><span class="linenos">264</span></a>                <span class="n">cond_item_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="FPGrowth-265"><a href="#FPGrowth-265"><span class="linenos">265</span></a>                <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">conditional_pattern_base</span><span class="p">:</span>
</span><span id="FPGrowth-266"><a href="#FPGrowth-266"><span class="linenos">266</span></a>                    <span class="k">for</span> <span class="n">path_item</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
</span><span id="FPGrowth-267"><a href="#FPGrowth-267"><span class="linenos">267</span></a>                        <span class="n">cond_item_counts</span><span class="p">[</span><span class="n">path_item</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
</span><span id="FPGrowth-268"><a href="#FPGrowth-268"><span class="linenos">268</span></a>                
</span><span id="FPGrowth-269"><a href="#FPGrowth-269"><span class="linenos">269</span></a>                <span class="c1"># Filter frequent items in this conditional base</span>
</span><span id="FPGrowth-270"><a href="#FPGrowth-270"><span class="linenos">270</span></a>                <span class="n">frequent_items</span> <span class="o">=</span> <span class="p">{</span><span class="n">item</span><span class="p">:</span> <span class="n">count</span> <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">cond_item_counts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
</span><span id="FPGrowth-271"><a href="#FPGrowth-271"><span class="linenos">271</span></a>                                <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">min_support_count</span><span class="p">}</span>
</span><span id="FPGrowth-272"><a href="#FPGrowth-272"><span class="linenos">272</span></a>                
</span><span id="FPGrowth-273"><a href="#FPGrowth-273"><span class="linenos">273</span></a>                <span class="c1"># If frequent items exist, build the conditional tree</span>
</span><span id="FPGrowth-274"><a href="#FPGrowth-274"><span class="linenos">274</span></a>                <span class="k">if</span> <span class="n">frequent_items</span><span class="p">:</span>
</span><span id="FPGrowth-275"><a href="#FPGrowth-275"><span class="linenos">275</span></a>                    <span class="c1"># Insert paths into the conditional tree</span>
</span><span id="FPGrowth-276"><a href="#FPGrowth-276"><span class="linenos">276</span></a>                    <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">conditional_pattern_base</span><span class="p">:</span>
</span><span id="FPGrowth-277"><a href="#FPGrowth-277"><span class="linenos">277</span></a>                        <span class="c1"># Filter and sort path items</span>
</span><span id="FPGrowth-278"><a href="#FPGrowth-278"><span class="linenos">278</span></a>                        <span class="n">filtered_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">frequent_items</span><span class="p">]</span>
</span><span id="FPGrowth-279"><a href="#FPGrowth-279"><span class="linenos">279</span></a>                        <span class="n">filtered_path</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">frequent_items</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">x</span><span class="p">))</span>
</span><span id="FPGrowth-280"><a href="#FPGrowth-280"><span class="linenos">280</span></a>                        
</span><span id="FPGrowth-281"><a href="#FPGrowth-281"><span class="linenos">281</span></a>                        <span class="k">if</span> <span class="n">filtered_path</span><span class="p">:</span>
</span><span id="FPGrowth-282"><a href="#FPGrowth-282"><span class="linenos">282</span></a>                            <span class="c1"># Create a mini header table for this conditional tree</span>
</span><span id="FPGrowth-283"><a href="#FPGrowth-283"><span class="linenos">283</span></a>                            <span class="n">header_table</span> <span class="o">=</span> <span class="p">{</span><span class="n">item</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;head&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">frequent_items</span><span class="p">}</span>
</span><span id="FPGrowth-284"><a href="#FPGrowth-284"><span class="linenos">284</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_insert_conditional_tree</span><span class="p">(</span><span class="n">filtered_path</span><span class="p">,</span> <span class="n">conditional_tree</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">header_table</span><span class="p">)</span>
</span><span id="FPGrowth-285"><a href="#FPGrowth-285"><span class="linenos">285</span></a>                    
</span><span id="FPGrowth-286"><a href="#FPGrowth-286"><span class="linenos">286</span></a>                    <span class="c1"># Recursively extract itemsets from this conditional tree</span>
</span><span id="FPGrowth-287"><a href="#FPGrowth-287"><span class="linenos">287</span></a>                    <span class="k">for</span> <span class="n">cond_item</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">frequent_items</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">frequent_items</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">x</span><span class="p">)):</span>
</span><span id="FPGrowth-288"><a href="#FPGrowth-288"><span class="linenos">288</span></a>                        <span class="n">newer_prefix</span> <span class="o">=</span> <span class="n">new_prefix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="FPGrowth-289"><a href="#FPGrowth-289"><span class="linenos">289</span></a>                        <span class="n">newer_prefix</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cond_item</span><span class="p">)</span>
</span><span id="FPGrowth-290"><a href="#FPGrowth-290"><span class="linenos">290</span></a>                        <span class="n">newer_itemset</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">newer_prefix</span><span class="p">)</span>
</span><span id="FPGrowth-291"><a href="#FPGrowth-291"><span class="linenos">291</span></a>                        
</span><span id="FPGrowth-292"><a href="#FPGrowth-292"><span class="linenos">292</span></a>                        <span class="c1"># Add this new frequent itemset</span>
</span><span id="FPGrowth-293"><a href="#FPGrowth-293"><span class="linenos">293</span></a>                        <span class="n">cond_support</span> <span class="o">=</span> <span class="n">frequent_items</span><span class="p">[</span><span class="n">cond_item</span><span class="p">]</span>
</span><span id="FPGrowth-294"><a href="#FPGrowth-294"><span class="linenos">294</span></a>                        <span class="n">cond_support_ratio</span> <span class="o">=</span> <span class="n">cond_support</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span>
</span><span id="FPGrowth-295"><a href="#FPGrowth-295"><span class="linenos">295</span></a>                        
</span><span id="FPGrowth-296"><a href="#FPGrowth-296"><span class="linenos">296</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="p">[</span><span class="n">newer_itemset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FPGrowth-297"><a href="#FPGrowth-297"><span class="linenos">297</span></a>                            <span class="s1">&#39;support_count&#39;</span><span class="p">:</span> <span class="n">cond_support</span><span class="p">,</span>
</span><span id="FPGrowth-298"><a href="#FPGrowth-298"><span class="linenos">298</span></a>                            <span class="s1">&#39;support&#39;</span><span class="p">:</span> <span class="n">cond_support_ratio</span>
</span><span id="FPGrowth-299"><a href="#FPGrowth-299"><span class="linenos">299</span></a>                        <span class="p">}</span>
</span><span id="FPGrowth-300"><a href="#FPGrowth-300"><span class="linenos">300</span></a>        
</span><span id="FPGrowth-301"><a href="#FPGrowth-301"><span class="linenos">301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_insert_conditional_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">header_table</span><span class="p">):</span>
</span><span id="FPGrowth-302"><a href="#FPGrowth-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-303"><a href="#FPGrowth-303"><span class="linenos">303</span></a><span class="sd">        Inserts a path into a conditional tree.</span>
</span><span id="FPGrowth-304"><a href="#FPGrowth-304"><span class="linenos">304</span></a><span class="sd">        </span>
</span><span id="FPGrowth-305"><a href="#FPGrowth-305"><span class="linenos">305</span></a><span class="sd">        Args:</span>
</span><span id="FPGrowth-306"><a href="#FPGrowth-306"><span class="linenos">306</span></a><span class="sd">            items: List of items in the path</span>
</span><span id="FPGrowth-307"><a href="#FPGrowth-307"><span class="linenos">307</span></a><span class="sd">            node: Current node in the tree</span>
</span><span id="FPGrowth-308"><a href="#FPGrowth-308"><span class="linenos">308</span></a><span class="sd">            count: Support of the path</span>
</span><span id="FPGrowth-309"><a href="#FPGrowth-309"><span class="linenos">309</span></a><span class="sd">            header_table: Header table for this conditional tree</span>
</span><span id="FPGrowth-310"><a href="#FPGrowth-310"><span class="linenos">310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-311"><a href="#FPGrowth-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
</span><span id="FPGrowth-312"><a href="#FPGrowth-312"><span class="linenos">312</span></a>            <span class="k">return</span>
</span><span id="FPGrowth-313"><a href="#FPGrowth-313"><span class="linenos">313</span></a>        
</span><span id="FPGrowth-314"><a href="#FPGrowth-314"><span class="linenos">314</span></a>        <span class="n">item</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FPGrowth-315"><a href="#FPGrowth-315"><span class="linenos">315</span></a>        
</span><span id="FPGrowth-316"><a href="#FPGrowth-316"><span class="linenos">316</span></a>        <span class="c1"># Update the count in the header table</span>
</span><span id="FPGrowth-317"><a href="#FPGrowth-317"><span class="linenos">317</span></a>        <span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
</span><span id="FPGrowth-318"><a href="#FPGrowth-318"><span class="linenos">318</span></a>        
</span><span id="FPGrowth-319"><a href="#FPGrowth-319"><span class="linenos">319</span></a>        <span class="c1"># Insert into the tree</span>
</span><span id="FPGrowth-320"><a href="#FPGrowth-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
</span><span id="FPGrowth-321"><a href="#FPGrowth-321"><span class="linenos">321</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="FPGrowth-322"><a href="#FPGrowth-322"><span class="linenos">322</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FPGrowth-323"><a href="#FPGrowth-323"><span class="linenos">323</span></a>            <span class="n">new_node</span> <span class="o">=</span> <span class="n">FPNode</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
</span><span id="FPGrowth-324"><a href="#FPGrowth-324"><span class="linenos">324</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_node</span>
</span><span id="FPGrowth-325"><a href="#FPGrowth-325"><span class="linenos">325</span></a>            
</span><span id="FPGrowth-326"><a href="#FPGrowth-326"><span class="linenos">326</span></a>            <span class="c1"># Update the header table</span>
</span><span id="FPGrowth-327"><a href="#FPGrowth-327"><span class="linenos">327</span></a>            <span class="k">if</span> <span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;head&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FPGrowth-328"><a href="#FPGrowth-328"><span class="linenos">328</span></a>                <span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;head&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_node</span>
</span><span id="FPGrowth-329"><a href="#FPGrowth-329"><span class="linenos">329</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="FPGrowth-330"><a href="#FPGrowth-330"><span class="linenos">330</span></a>                <span class="n">current</span> <span class="o">=</span> <span class="n">header_table</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="s1">&#39;head&#39;</span><span class="p">]</span>
</span><span id="FPGrowth-331"><a href="#FPGrowth-331"><span class="linenos">331</span></a>                <span class="k">while</span> <span class="n">current</span><span class="o">.</span><span class="n">node_link</span><span class="p">:</span>
</span><span id="FPGrowth-332"><a href="#FPGrowth-332"><span class="linenos">332</span></a>                    <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">node_link</span>
</span><span id="FPGrowth-333"><a href="#FPGrowth-333"><span class="linenos">333</span></a>                <span class="n">current</span><span class="o">.</span><span class="n">node_link</span> <span class="o">=</span> <span class="n">new_node</span>
</span><span id="FPGrowth-334"><a href="#FPGrowth-334"><span class="linenos">334</span></a>        
</span><span id="FPGrowth-335"><a href="#FPGrowth-335"><span class="linenos">335</span></a>        <span class="c1"># Recursive insertion</span>
</span><span id="FPGrowth-336"><a href="#FPGrowth-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_insert_conditional_tree</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="n">count</span><span class="p">,</span> <span class="n">header_table</span><span class="p">)</span>
</span><span id="FPGrowth-337"><a href="#FPGrowth-337"><span class="linenos">337</span></a>    
</span><span id="FPGrowth-338"><a href="#FPGrowth-338"><span class="linenos">338</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FPGrowth-339"><a href="#FPGrowth-339"><span class="linenos">339</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-340"><a href="#FPGrowth-340"><span class="linenos">340</span></a><span class="sd">        Generates association rules from frequent itemsets.</span>
</span><span id="FPGrowth-341"><a href="#FPGrowth-341"><span class="linenos">341</span></a>
</span><span id="FPGrowth-342"><a href="#FPGrowth-342"><span class="linenos">342</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth-343"><a href="#FPGrowth-343"><span class="linenos">343</span></a><span class="sd">            List of association rules</span>
</span><span id="FPGrowth-344"><a href="#FPGrowth-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-345"><a href="#FPGrowth-345"><span class="linenos">345</span></a>        
</span><span id="FPGrowth-346"><a href="#FPGrowth-346"><span class="linenos">346</span></a>        <span class="c1"># Examine all itemsets of size &gt; 1</span>
</span><span id="FPGrowth-347"><a href="#FPGrowth-347"><span class="linenos">347</span></a>        <span class="k">for</span> <span class="n">itemset</span><span class="p">,</span> <span class="n">item_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="FPGrowth-348"><a href="#FPGrowth-348"><span class="linenos">348</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">itemset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="FPGrowth-349"><a href="#FPGrowth-349"><span class="linenos">349</span></a>                <span class="k">continue</span>
</span><span id="FPGrowth-350"><a href="#FPGrowth-350"><span class="linenos">350</span></a>                
</span><span id="FPGrowth-351"><a href="#FPGrowth-351"><span class="linenos">351</span></a>            <span class="c1"># For each possible subset as antecedent</span>
</span><span id="FPGrowth-352"><a href="#FPGrowth-352"><span class="linenos">352</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">itemset</span><span class="p">)):</span>
</span><span id="FPGrowth-353"><a href="#FPGrowth-353"><span class="linenos">353</span></a>                <span class="k">for</span> <span class="n">antecedent_items</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subsets</span><span class="p">(</span><span class="n">itemset</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="FPGrowth-354"><a href="#FPGrowth-354"><span class="linenos">354</span></a>                    <span class="n">antecedent</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">antecedent_items</span><span class="p">)</span>
</span><span id="FPGrowth-355"><a href="#FPGrowth-355"><span class="linenos">355</span></a>                    <span class="n">consequent</span> <span class="o">=</span> <span class="n">itemset</span> <span class="o">-</span> <span class="n">antecedent</span>
</span><span id="FPGrowth-356"><a href="#FPGrowth-356"><span class="linenos">356</span></a>                    
</span><span id="FPGrowth-357"><a href="#FPGrowth-357"><span class="linenos">357</span></a>                    <span class="k">if</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span> <span class="ow">and</span> <span class="n">consequent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="p">:</span>
</span><span id="FPGrowth-358"><a href="#FPGrowth-358"><span class="linenos">358</span></a>                        <span class="c1"># Calculate confidence and lift</span>
</span><span id="FPGrowth-359"><a href="#FPGrowth-359"><span class="linenos">359</span></a>                        <span class="n">confidence</span> <span class="o">=</span> <span class="n">item_data</span><span class="p">[</span><span class="s1">&#39;support&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="p">[</span><span class="n">antecedent</span><span class="p">][</span><span class="s1">&#39;support&#39;</span><span class="p">]</span>
</span><span id="FPGrowth-360"><a href="#FPGrowth-360"><span class="linenos">360</span></a>                        <span class="n">lift</span> <span class="o">=</span> <span class="n">confidence</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="p">[</span><span class="n">consequent</span><span class="p">][</span><span class="s1">&#39;support&#39;</span><span class="p">]</span>
</span><span id="FPGrowth-361"><a href="#FPGrowth-361"><span class="linenos">361</span></a>                        
</span><span id="FPGrowth-362"><a href="#FPGrowth-362"><span class="linenos">362</span></a>                        <span class="k">if</span> <span class="n">confidence</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="p">:</span>
</span><span id="FPGrowth-363"><a href="#FPGrowth-363"><span class="linenos">363</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="FPGrowth-364"><a href="#FPGrowth-364"><span class="linenos">364</span></a>                                <span class="s1">&#39;antecedent&#39;</span><span class="p">:</span> <span class="n">antecedent</span><span class="p">,</span>
</span><span id="FPGrowth-365"><a href="#FPGrowth-365"><span class="linenos">365</span></a>                                <span class="s1">&#39;consequent&#39;</span><span class="p">:</span> <span class="n">consequent</span><span class="p">,</span>
</span><span id="FPGrowth-366"><a href="#FPGrowth-366"><span class="linenos">366</span></a>                                <span class="s1">&#39;support&#39;</span><span class="p">:</span> <span class="n">item_data</span><span class="p">[</span><span class="s1">&#39;support&#39;</span><span class="p">],</span>
</span><span id="FPGrowth-367"><a href="#FPGrowth-367"><span class="linenos">367</span></a>                                <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">confidence</span><span class="p">,</span>
</span><span id="FPGrowth-368"><a href="#FPGrowth-368"><span class="linenos">368</span></a>                                <span class="s1">&#39;lift&#39;</span><span class="p">:</span> <span class="n">lift</span>
</span><span id="FPGrowth-369"><a href="#FPGrowth-369"><span class="linenos">369</span></a>                            <span class="p">})</span>
</span><span id="FPGrowth-370"><a href="#FPGrowth-370"><span class="linenos">370</span></a>    
</span><span id="FPGrowth-371"><a href="#FPGrowth-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_subsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="FPGrowth-372"><a href="#FPGrowth-372"><span class="linenos">372</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates all subsets of size n of a set.&quot;&quot;&quot;</span>
</span><span id="FPGrowth-373"><a href="#FPGrowth-373"><span class="linenos">373</span></a>        <span class="k">return</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">combo</span><span class="p">)</span> <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>
</span><span id="FPGrowth-374"><a href="#FPGrowth-374"><span class="linenos">374</span></a>
</span><span id="FPGrowth-375"><a href="#FPGrowth-375"><span class="linenos">375</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_frequent_itemsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FPGrowth-376"><a href="#FPGrowth-376"><span class="linenos">376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-377"><a href="#FPGrowth-377"><span class="linenos">377</span></a><span class="sd">        Retrieve the discovered frequent itemsets.</span>
</span><span id="FPGrowth-378"><a href="#FPGrowth-378"><span class="linenos">378</span></a><span class="sd">        </span>
</span><span id="FPGrowth-379"><a href="#FPGrowth-379"><span class="linenos">379</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth-380"><a href="#FPGrowth-380"><span class="linenos">380</span></a><span class="sd">            List: List of frequent itemsets with their supports</span>
</span><span id="FPGrowth-381"><a href="#FPGrowth-381"><span class="linenos">381</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-382"><a href="#FPGrowth-382"><span class="linenos">382</span></a>        <span class="c1"># Convert dictionary to list for compatibility</span>
</span><span id="FPGrowth-383"><a href="#FPGrowth-383"><span class="linenos">383</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;itemset&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">itemset</span><span class="p">),</span> <span class="o">**</span><span class="n">item_data</span><span class="p">}</span> <span class="k">for</span> <span class="n">itemset</span><span class="p">,</span> <span class="n">item_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</span><span id="FPGrowth-384"><a href="#FPGrowth-384"><span class="linenos">384</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="FPGrowth-385"><a href="#FPGrowth-385"><span class="linenos">385</span></a>
</span><span id="FPGrowth-386"><a href="#FPGrowth-386"><span class="linenos">386</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FPGrowth-387"><a href="#FPGrowth-387"><span class="linenos">387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth-388"><a href="#FPGrowth-388"><span class="linenos">388</span></a><span class="sd">        Retrieve the generated association rules.</span>
</span><span id="FPGrowth-389"><a href="#FPGrowth-389"><span class="linenos">389</span></a><span class="sd">        </span>
</span><span id="FPGrowth-390"><a href="#FPGrowth-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth-391"><a href="#FPGrowth-391"><span class="linenos">391</span></a><span class="sd">            List of association rules</span>
</span><span id="FPGrowth-392"><a href="#FPGrowth-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth-393"><a href="#FPGrowth-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span>
</span></pre></div>


            <div class="docstring"><p>FP-Growth is an efficient algorithm for extracting frequent itemsets that
constructs a compact data structure (FP-Tree) and extracts patterns without
generating candidates, unlike Apriori or Eclat. For more details consult the following
<a href="https://dl.acm.org/doi/10.1145/342009.335372">link </a>.</p>

<p>Args:
    min_support (float): Minimum support threshold (between 0 and 1) for frequent itemsets.
    min_confidence (float): Minimum confidence threshold (between 0 and 1) for association rules.</p>

<p>Examples:</p>

<pre><code>&gt;&gt;&gt; transactions = [
...     {'bread', 'milk', 'butter'},
...     {'bread', 'jam', 'eggs'},
...     {'milk', 'butter', 'cheese'},
...     {'bread', 'milk', 'butter', 'cheese'},
...     {'bread', 'jam', 'milk'}
... ]
&gt;&gt;&gt; from <a href="">ifri_mini_ml_lib.association_rules</a> import FPGrowth
&gt;&gt;&gt; fp_growth = FPGrowth(min_support=0.4, min_confidence=0.6)
&gt;&gt;&gt; fp_growth.fit(transactions) # Frequents itemsets + Rules generation
&lt;<a href="#FPGrowth">ifri_mini_ml_lib.association_rules.fp_growth.FPGrowth</a> object&gt;
&gt;&gt;&gt; frequent_itemsets = fp_growth.get_frequent_itemsets()
&gt;&gt;&gt; for itemset_data in frequent_itemsets[:3]:
...     print(f"Itemset: {set(itemset_data['itemset'])}, Support: {itemset_data['support']:.2f}")
Itemset: {'bread'}, Support: 0.80
Itemset: {'milk'}, Support: 0.80
Itemset: {'butter'}, Support: 0.60
&gt;&gt;&gt; rules = fp_growth.get_rules()
&gt;&gt;&gt; # Displaying some association rules
&gt;&gt;&gt; if rules:
...     for rule in rules[:2]:
...         print(f"{set(rule['antecedent'])} -&gt; {set(rule['consequent'])}, "
...               f"Confidence: {rule['confidence']:.2f}, Lift: {rule['lift']:.2f}")
{'milk'} -&gt; {'bread'}, Confidence: 0.75, Lift: 0.94
{'bread'} -&gt; {'milk'}, Confidence: 0.75, Lift: 0.94
</code></pre>
</div>


                            <div id="FPGrowth.__init__" class="classattr">
                                        <input id="FPGrowth.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FPGrowth</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span></span>)</span>

                <label class="view-source-button" for="FPGrowth.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FPGrowth.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FPGrowth.__init__-70"><a href="#FPGrowth.__init__-70"><span class="linenos">70</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_support</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="FPGrowth.__init__-71"><a href="#FPGrowth.__init__-71"><span class="linenos">71</span></a>        
</span><span id="FPGrowth.__init__-72"><a href="#FPGrowth.__init__-72"><span class="linenos">72</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_support</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FPGrowth.__init__-73"><a href="#FPGrowth.__init__-73"><span class="linenos">73</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum support must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.__init__-74"><a href="#FPGrowth.__init__-74"><span class="linenos">74</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">min_confidence</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FPGrowth.__init__-75"><a href="#FPGrowth.__init__-75"><span class="linenos">75</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum confidence must be between 0 and 1&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.__init__-76"><a href="#FPGrowth.__init__-76"><span class="linenos">76</span></a>        
</span><span id="FPGrowth.__init__-77"><a href="#FPGrowth.__init__-77"><span class="linenos">77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">=</span> <span class="n">min_support</span>
</span><span id="FPGrowth.__init__-78"><a href="#FPGrowth.__init__-78"><span class="linenos">78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span> <span class="o">=</span> <span class="n">min_confidence</span>
</span><span id="FPGrowth.__init__-79"><a href="#FPGrowth.__init__-79"><span class="linenos">79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="FPGrowth.__init__-80"><a href="#FPGrowth.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="FPGrowth.__init__-81"><a href="#FPGrowth.__init__-81"><span class="linenos">81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="FPGrowth.__init__-82"><a href="#FPGrowth.__init__-82"><span class="linenos">82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="mi">0</span>
</span></pre></div>


    

                            </div>
                            <div id="FPGrowth.min_support" class="classattr">
                                <div class="attr variable">
            <span class="name">min_support</span>

        
    </div>
    <a class="headerlink" href="#FPGrowth.min_support"></a>
    
    

                            </div>
                            <div id="FPGrowth.min_confidence" class="classattr">
                                <div class="attr variable">
            <span class="name">min_confidence</span>

        
    </div>
    <a class="headerlink" href="#FPGrowth.min_confidence"></a>
    
    

                            </div>
                            <div id="FPGrowth.frequent_itemsets_dict" class="classattr">
                                <div class="attr variable">
            <span class="name">frequent_itemsets_dict</span>

        
    </div>
    <a class="headerlink" href="#FPGrowth.frequent_itemsets_dict"></a>
    
    

                            </div>
                            <div id="FPGrowth.rules_" class="classattr">
                                <div class="attr variable">
            <span class="name">rules_</span>

        
    </div>
    <a class="headerlink" href="#FPGrowth.rules_"></a>
    
    

                            </div>
                            <div id="FPGrowth.header_table" class="classattr">
                                <div class="attr variable">
            <span class="name">header_table</span>

        
    </div>
    <a class="headerlink" href="#FPGrowth.header_table"></a>
    
    

                            </div>
                            <div id="FPGrowth.n_transactions" class="classattr">
                                <div class="attr variable">
            <span class="name">n_transactions</span>

        
    </div>
    <a class="headerlink" href="#FPGrowth.n_transactions"></a>
    
    

                            </div>
                            <div id="FPGrowth.fit" class="classattr">
                                        <input id="FPGrowth.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">transactions</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FPGrowth.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FPGrowth.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FPGrowth.fit-84"><a href="#FPGrowth.fit-84"><span class="linenos"> 84</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transactions</span><span class="p">):</span>
</span><span id="FPGrowth.fit-85"><a href="#FPGrowth.fit-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth.fit-86"><a href="#FPGrowth.fit-86"><span class="linenos"> 86</span></a><span class="sd">        Builds the FP-Tree and extracts frequent itemsets.</span>
</span><span id="FPGrowth.fit-87"><a href="#FPGrowth.fit-87"><span class="linenos"> 87</span></a><span class="sd">        </span>
</span><span id="FPGrowth.fit-88"><a href="#FPGrowth.fit-88"><span class="linenos"> 88</span></a><span class="sd">        Args:</span>
</span><span id="FPGrowth.fit-89"><a href="#FPGrowth.fit-89"><span class="linenos"> 89</span></a><span class="sd">            transactions: List of transactions (each transaction is a set of items)</span>
</span><span id="FPGrowth.fit-90"><a href="#FPGrowth.fit-90"><span class="linenos"> 90</span></a><span class="sd">            </span>
</span><span id="FPGrowth.fit-91"><a href="#FPGrowth.fit-91"><span class="linenos"> 91</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth.fit-92"><a href="#FPGrowth.fit-92"><span class="linenos"> 92</span></a><span class="sd">            self: The current instance for method chaining</span>
</span><span id="FPGrowth.fit-93"><a href="#FPGrowth.fit-93"><span class="linenos"> 93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth.fit-94"><a href="#FPGrowth.fit-94"><span class="linenos"> 94</span></a>        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="FPGrowth.fit-95"><a href="#FPGrowth.fit-95"><span class="linenos"> 95</span></a>        
</span><span id="FPGrowth.fit-96"><a href="#FPGrowth.fit-96"><span class="linenos"> 96</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transactions</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="FPGrowth.fit-97"><a href="#FPGrowth.fit-97"><span class="linenos"> 97</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data format not respected! Only List[set] format is accepted.&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-98"><a href="#FPGrowth.fit-98"><span class="linenos"> 98</span></a>            
</span><span id="FPGrowth.fit-99"><a href="#FPGrowth.fit-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
</span><span id="FPGrowth.fit-100"><a href="#FPGrowth.fit-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span><span class="p">)</span>
</span><span id="FPGrowth.fit-101"><a href="#FPGrowth.fit-101"><span class="linenos">101</span></a>        
</span><span id="FPGrowth.fit-102"><a href="#FPGrowth.fit-102"><span class="linenos">102</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Applying FP-Growth algorithm with:&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-103"><a href="#FPGrowth.fit-103"><span class="linenos">103</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-104"><a href="#FPGrowth.fit-104"><span class="linenos">104</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum support count: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-105"><a href="#FPGrowth.fit-105"><span class="linenos">105</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Minimum confidence: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_confidence</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-106"><a href="#FPGrowth.fit-106"><span class="linenos">106</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of valid transactions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_transactions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-107"><a href="#FPGrowth.fit-107"><span class="linenos">107</span></a>
</span><span id="FPGrowth.fit-108"><a href="#FPGrowth.fit-108"><span class="linenos">108</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="FPGrowth.fit-109"><a href="#FPGrowth.fit-109"><span class="linenos">109</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FPGrowth.fit-110"><a href="#FPGrowth.fit-110"><span class="linenos">110</span></a>        
</span><span id="FPGrowth.fit-111"><a href="#FPGrowth.fit-111"><span class="linenos">111</span></a>        <span class="c1"># Step 1: Count the frequency of individual items</span>
</span><span id="FPGrowth.fit-112"><a href="#FPGrowth.fit-112"><span class="linenos">112</span></a>        <span class="n">item_counter</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="FPGrowth.fit-113"><a href="#FPGrowth.fit-113"><span class="linenos">113</span></a>        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
</span><span id="FPGrowth.fit-114"><a href="#FPGrowth.fit-114"><span class="linenos">114</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">transaction</span><span class="p">:</span>
</span><span id="FPGrowth.fit-115"><a href="#FPGrowth.fit-115"><span class="linenos">115</span></a>                <span class="n">item_counter</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="FPGrowth.fit-116"><a href="#FPGrowth.fit-116"><span class="linenos">116</span></a>        
</span><span id="FPGrowth.fit-117"><a href="#FPGrowth.fit-117"><span class="linenos">117</span></a>        <span class="c1"># Filter frequent items and create the header table</span>
</span><span id="FPGrowth.fit-118"><a href="#FPGrowth.fit-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="FPGrowth.fit-119"><a href="#FPGrowth.fit-119"><span class="linenos">119</span></a>            <span class="n">item</span><span class="p">:</span> <span class="p">{</span>
</span><span id="FPGrowth.fit-120"><a href="#FPGrowth.fit-120"><span class="linenos">120</span></a>                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span> 
</span><span id="FPGrowth.fit-121"><a href="#FPGrowth.fit-121"><span class="linenos">121</span></a>                <span class="s1">&#39;head&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="FPGrowth.fit-122"><a href="#FPGrowth.fit-122"><span class="linenos">122</span></a>            <span class="p">}</span> 
</span><span id="FPGrowth.fit-123"><a href="#FPGrowth.fit-123"><span class="linenos">123</span></a>            <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">item_counter</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
</span><span id="FPGrowth.fit-124"><a href="#FPGrowth.fit-124"><span class="linenos">124</span></a>            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span>
</span><span id="FPGrowth.fit-125"><a href="#FPGrowth.fit-125"><span class="linenos">125</span></a>        <span class="p">}</span>
</span><span id="FPGrowth.fit-126"><a href="#FPGrowth.fit-126"><span class="linenos">126</span></a>        
</span><span id="FPGrowth.fit-127"><a href="#FPGrowth.fit-127"><span class="linenos">127</span></a>        <span class="c1"># Reset frequent itemsets</span>
</span><span id="FPGrowth.fit-128"><a href="#FPGrowth.fit-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="FPGrowth.fit-129"><a href="#FPGrowth.fit-129"><span class="linenos">129</span></a>        
</span><span id="FPGrowth.fit-130"><a href="#FPGrowth.fit-130"><span class="linenos">130</span></a>        <span class="c1"># If no frequent item is found, return</span>
</span><span id="FPGrowth.fit-131"><a href="#FPGrowth.fit-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">:</span>
</span><span id="FPGrowth.fit-132"><a href="#FPGrowth.fit-132"><span class="linenos">132</span></a>            <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="FPGrowth.fit-133"><a href="#FPGrowth.fit-133"><span class="linenos">133</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-134"><a href="#FPGrowth.fit-134"><span class="linenos">134</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No frequent itemset found.&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-135"><a href="#FPGrowth.fit-135"><span class="linenos">135</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FPGrowth.fit-136"><a href="#FPGrowth.fit-136"><span class="linenos">136</span></a>        
</span><span id="FPGrowth.fit-137"><a href="#FPGrowth.fit-137"><span class="linenos">137</span></a>        <span class="c1"># Sort items by decreasing frequency</span>
</span><span id="FPGrowth.fit-138"><a href="#FPGrowth.fit-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ordered_items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="FPGrowth.fit-139"><a href="#FPGrowth.fit-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> 
</span><span id="FPGrowth.fit-140"><a href="#FPGrowth.fit-140"><span class="linenos">140</span></a>            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
</span><span id="FPGrowth.fit-141"><a href="#FPGrowth.fit-141"><span class="linenos">141</span></a>        <span class="p">)</span>
</span><span id="FPGrowth.fit-142"><a href="#FPGrowth.fit-142"><span class="linenos">142</span></a>        
</span><span id="FPGrowth.fit-143"><a href="#FPGrowth.fit-143"><span class="linenos">143</span></a>        <span class="c1"># Step 2: Build the FP-Tree</span>
</span><span id="FPGrowth.fit-144"><a href="#FPGrowth.fit-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">FPNode</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="FPGrowth.fit-145"><a href="#FPGrowth.fit-145"><span class="linenos">145</span></a>        
</span><span id="FPGrowth.fit-146"><a href="#FPGrowth.fit-146"><span class="linenos">146</span></a>        <span class="c1"># Insert each transaction into the tree</span>
</span><span id="FPGrowth.fit-147"><a href="#FPGrowth.fit-147"><span class="linenos">147</span></a>        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
</span><span id="FPGrowth.fit-148"><a href="#FPGrowth.fit-148"><span class="linenos">148</span></a>            <span class="c1"># Filter non-frequent items and sort</span>
</span><span id="FPGrowth.fit-149"><a href="#FPGrowth.fit-149"><span class="linenos">149</span></a>            <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">transaction</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">]</span>
</span><span id="FPGrowth.fit-150"><a href="#FPGrowth.fit-150"><span class="linenos">150</span></a>            <span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">header_table</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">))</span>
</span><span id="FPGrowth.fit-151"><a href="#FPGrowth.fit-151"><span class="linenos">151</span></a>            
</span><span id="FPGrowth.fit-152"><a href="#FPGrowth.fit-152"><span class="linenos">152</span></a>            <span class="k">if</span> <span class="n">items</span><span class="p">:</span>
</span><span id="FPGrowth.fit-153"><a href="#FPGrowth.fit-153"><span class="linenos">153</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_insert_tree</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FPGrowth.fit-154"><a href="#FPGrowth.fit-154"><span class="linenos">154</span></a>        
</span><span id="FPGrowth.fit-155"><a href="#FPGrowth.fit-155"><span class="linenos">155</span></a>        <span class="c1"># Step 3: Extract frequent itemsets</span>
</span><span id="FPGrowth.fit-156"><a href="#FPGrowth.fit-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mine_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="nb">set</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_support_count</span><span class="p">)</span>
</span><span id="FPGrowth.fit-157"><a href="#FPGrowth.fit-157"><span class="linenos">157</span></a>
</span><span id="FPGrowth.fit-158"><a href="#FPGrowth.fit-158"><span class="linenos">158</span></a>        <span class="c1"># Step 4: Generate rules</span>
</span><span id="FPGrowth.fit-159"><a href="#FPGrowth.fit-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_rules</span><span class="p">()</span>
</span><span id="FPGrowth.fit-160"><a href="#FPGrowth.fit-160"><span class="linenos">160</span></a>        
</span><span id="FPGrowth.fit-161"><a href="#FPGrowth.fit-161"><span class="linenos">161</span></a>        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="FPGrowth.fit-162"><a href="#FPGrowth.fit-162"><span class="linenos">162</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-163"><a href="#FPGrowth.fit-163"><span class="linenos">163</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of frequent itemsets found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FPGrowth.fit-164"><a href="#FPGrowth.fit-164"><span class="linenos">164</span></a>        
</span><span id="FPGrowth.fit-165"><a href="#FPGrowth.fit-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Builds the FP-Tree and extracts frequent itemsets.</p>

<p>Args:
    transactions: List of transactions (each transaction is a set of items)</p>

<p>Returns:
    self: The current instance for method chaining</p>
</div>


                            </div>
                            <div id="FPGrowth.get_frequent_itemsets" class="classattr">
                                        <input id="FPGrowth.get_frequent_itemsets-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_frequent_itemsets</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FPGrowth.get_frequent_itemsets-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FPGrowth.get_frequent_itemsets"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FPGrowth.get_frequent_itemsets-375"><a href="#FPGrowth.get_frequent_itemsets-375"><span class="linenos">375</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_frequent_itemsets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FPGrowth.get_frequent_itemsets-376"><a href="#FPGrowth.get_frequent_itemsets-376"><span class="linenos">376</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth.get_frequent_itemsets-377"><a href="#FPGrowth.get_frequent_itemsets-377"><span class="linenos">377</span></a><span class="sd">        Retrieve the discovered frequent itemsets.</span>
</span><span id="FPGrowth.get_frequent_itemsets-378"><a href="#FPGrowth.get_frequent_itemsets-378"><span class="linenos">378</span></a><span class="sd">        </span>
</span><span id="FPGrowth.get_frequent_itemsets-379"><a href="#FPGrowth.get_frequent_itemsets-379"><span class="linenos">379</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth.get_frequent_itemsets-380"><a href="#FPGrowth.get_frequent_itemsets-380"><span class="linenos">380</span></a><span class="sd">            List: List of frequent itemsets with their supports</span>
</span><span id="FPGrowth.get_frequent_itemsets-381"><a href="#FPGrowth.get_frequent_itemsets-381"><span class="linenos">381</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth.get_frequent_itemsets-382"><a href="#FPGrowth.get_frequent_itemsets-382"><span class="linenos">382</span></a>        <span class="c1"># Convert dictionary to list for compatibility</span>
</span><span id="FPGrowth.get_frequent_itemsets-383"><a href="#FPGrowth.get_frequent_itemsets-383"><span class="linenos">383</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;itemset&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">itemset</span><span class="p">),</span> <span class="o">**</span><span class="n">item_data</span><span class="p">}</span> <span class="k">for</span> <span class="n">itemset</span><span class="p">,</span> <span class="n">item_data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequent_itemsets_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
</span><span id="FPGrowth.get_frequent_itemsets-384"><a href="#FPGrowth.get_frequent_itemsets-384"><span class="linenos">384</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the discovered frequent itemsets.</p>

<p>Returns:
    List: List of frequent itemsets with their supports</p>
</div>


                            </div>
                            <div id="FPGrowth.get_rules" class="classattr">
                                        <input id="FPGrowth.get_rules-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_rules</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FPGrowth.get_rules-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FPGrowth.get_rules"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FPGrowth.get_rules-386"><a href="#FPGrowth.get_rules-386"><span class="linenos">386</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FPGrowth.get_rules-387"><a href="#FPGrowth.get_rules-387"><span class="linenos">387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FPGrowth.get_rules-388"><a href="#FPGrowth.get_rules-388"><span class="linenos">388</span></a><span class="sd">        Retrieve the generated association rules.</span>
</span><span id="FPGrowth.get_rules-389"><a href="#FPGrowth.get_rules-389"><span class="linenos">389</span></a><span class="sd">        </span>
</span><span id="FPGrowth.get_rules-390"><a href="#FPGrowth.get_rules-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="FPGrowth.get_rules-391"><a href="#FPGrowth.get_rules-391"><span class="linenos">391</span></a><span class="sd">            List of association rules</span>
</span><span id="FPGrowth.get_rules-392"><a href="#FPGrowth.get_rules-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FPGrowth.get_rules-393"><a href="#FPGrowth.get_rules-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the generated association rules.</p>

<p>Returns:
    List of association rules</p>
</div>


                            </div>
                </section>
                <section id="DataAdapter">
                            <input id="DataAdapter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DataAdapter</span>:

                <label class="view-source-button" for="DataAdapter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataAdapter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataAdapter-6"><a href="#DataAdapter-6"><span class="linenos">  6</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DataAdapter</span><span class="p">:</span>
</span><span id="DataAdapter-7"><a href="#DataAdapter-7"><span class="linenos">  7</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter-8"><a href="#DataAdapter-8"><span class="linenos">  8</span></a><span class="sd">    Utility class for converting different data formats into transactions</span>
</span><span id="DataAdapter-9"><a href="#DataAdapter-9"><span class="linenos">  9</span></a><span class="sd">    for association rule mining algorithms.</span>
</span><span id="DataAdapter-10"><a href="#DataAdapter-10"><span class="linenos"> 10</span></a><span class="sd">    </span>
</span><span id="DataAdapter-11"><a href="#DataAdapter-11"><span class="linenos"> 11</span></a><span class="sd">    Examples:</span>
</span><span id="DataAdapter-12"><a href="#DataAdapter-12"><span class="linenos"> 12</span></a><span class="sd">    </span>
</span><span id="DataAdapter-13"><a href="#DataAdapter-13"><span class="linenos"> 13</span></a><span class="sd">    &gt;&gt;&gt; # Converting from a pandas DataFrame</span>
</span><span id="DataAdapter-14"><a href="#DataAdapter-14"><span class="linenos"> 14</span></a><span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
</span><span id="DataAdapter-15"><a href="#DataAdapter-15"><span class="linenos"> 15</span></a><span class="sd">    &gt;&gt;&gt; from ifri_mini_ml_lib.association_rules.utils import DataAdapter</span>
</span><span id="DataAdapter-16"><a href="#DataAdapter-16"><span class="linenos"> 16</span></a><span class="sd">    &gt;&gt;&gt; # Create a sample DataFrame</span>
</span><span id="DataAdapter-17"><a href="#DataAdapter-17"><span class="linenos"> 17</span></a><span class="sd">    &gt;&gt;&gt; df = pd.DataFrame({</span>
</span><span id="DataAdapter-18"><a href="#DataAdapter-18"><span class="linenos"> 18</span></a><span class="sd">    ...     &#39;item1&#39;: [1, 0, 1, 1, 0],</span>
</span><span id="DataAdapter-19"><a href="#DataAdapter-19"><span class="linenos"> 19</span></a><span class="sd">    ...     &#39;item2&#39;: [1, 1, 0, 1, 1],</span>
</span><span id="DataAdapter-20"><a href="#DataAdapter-20"><span class="linenos"> 20</span></a><span class="sd">    ...     &#39;item3&#39;: [0, 1, 1, 1, 0]</span>
</span><span id="DataAdapter-21"><a href="#DataAdapter-21"><span class="linenos"> 21</span></a><span class="sd">    ... })</span>
</span><span id="DataAdapter-22"><a href="#DataAdapter-22"><span class="linenos"> 22</span></a><span class="sd">    &gt;&gt;&gt; # Convert to transactions (binary mode)</span>
</span><span id="DataAdapter-23"><a href="#DataAdapter-23"><span class="linenos"> 23</span></a><span class="sd">    &gt;&gt;&gt; transactions = DataAdapter.convert_to_transactions(df, binary_mode=True)</span>
</span><span id="DataAdapter-24"><a href="#DataAdapter-24"><span class="linenos"> 24</span></a><span class="sd">    &gt;&gt;&gt; for t in transactions:</span>
</span><span id="DataAdapter-25"><a href="#DataAdapter-25"><span class="linenos"> 25</span></a><span class="sd">    ...     print(sorted(t))</span>
</span><span id="DataAdapter-26"><a href="#DataAdapter-26"><span class="linenos"> 26</span></a><span class="sd">    [&#39;item1&#39;, &#39;item2&#39;]</span>
</span><span id="DataAdapter-27"><a href="#DataAdapter-27"><span class="linenos"> 27</span></a><span class="sd">    [&#39;item2&#39;, &#39;item3&#39;]</span>
</span><span id="DataAdapter-28"><a href="#DataAdapter-28"><span class="linenos"> 28</span></a><span class="sd">    [&#39;item1&#39;, &#39;item3&#39;]</span>
</span><span id="DataAdapter-29"><a href="#DataAdapter-29"><span class="linenos"> 29</span></a><span class="sd">    [&#39;item1&#39;, &#39;item2&#39;, &#39;item3&#39;]</span>
</span><span id="DataAdapter-30"><a href="#DataAdapter-30"><span class="linenos"> 30</span></a><span class="sd">    [&#39;item2&#39;]</span>
</span><span id="DataAdapter-31"><a href="#DataAdapter-31"><span class="linenos"> 31</span></a><span class="sd">    </span>
</span><span id="DataAdapter-32"><a href="#DataAdapter-32"><span class="linenos"> 32</span></a><span class="sd">    &gt;&gt;&gt; # Converting non-binary data</span>
</span><span id="DataAdapter-33"><a href="#DataAdapter-33"><span class="linenos"> 33</span></a><span class="sd">    &gt;&gt;&gt; df_cat = pd.DataFrame({</span>
</span><span id="DataAdapter-34"><a href="#DataAdapter-34"><span class="linenos"> 34</span></a><span class="sd">    ...     &#39;color&#39;: [&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;, &#39;red&#39;, &#39;blue&#39;],</span>
</span><span id="DataAdapter-35"><a href="#DataAdapter-35"><span class="linenos"> 35</span></a><span class="sd">    ...     &#39;size&#39;: [&#39;large&#39;, &#39;medium&#39;, &#39;small&#39;, &#39;medium&#39;, &#39;large&#39;]</span>
</span><span id="DataAdapter-36"><a href="#DataAdapter-36"><span class="linenos"> 36</span></a><span class="sd">    ... })</span>
</span><span id="DataAdapter-37"><a href="#DataAdapter-37"><span class="linenos"> 37</span></a><span class="sd">    &gt;&gt;&gt; # Convert to transactions (categorical data)</span>
</span><span id="DataAdapter-38"><a href="#DataAdapter-38"><span class="linenos"> 38</span></a><span class="sd">    &gt;&gt;&gt; transactions = DataAdapter.convert_to_transactions(df_cat, binary_mode=False)</span>
</span><span id="DataAdapter-39"><a href="#DataAdapter-39"><span class="linenos"> 39</span></a><span class="sd">    &gt;&gt;&gt; for t in transactions[:2]:</span>
</span><span id="DataAdapter-40"><a href="#DataAdapter-40"><span class="linenos"> 40</span></a><span class="sd">    ...     print(sorted(t))</span>
</span><span id="DataAdapter-41"><a href="#DataAdapter-41"><span class="linenos"> 41</span></a><span class="sd">    [&#39;color_red&#39;, &#39;size_large&#39;]</span>
</span><span id="DataAdapter-42"><a href="#DataAdapter-42"><span class="linenos"> 42</span></a><span class="sd">    [&#39;color_blue&#39;, &#39;size_medium&#39;]</span>
</span><span id="DataAdapter-43"><a href="#DataAdapter-43"><span class="linenos"> 43</span></a><span class="sd">    </span>
</span><span id="DataAdapter-44"><a href="#DataAdapter-44"><span class="linenos"> 44</span></a><span class="sd">    &gt;&gt;&gt; # Converting from a list of sets</span>
</span><span id="DataAdapter-45"><a href="#DataAdapter-45"><span class="linenos"> 45</span></a><span class="sd">    &gt;&gt;&gt; list_data = [</span>
</span><span id="DataAdapter-46"><a href="#DataAdapter-46"><span class="linenos"> 46</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;milk&#39;},</span>
</span><span id="DataAdapter-47"><a href="#DataAdapter-47"><span class="linenos"> 47</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;diaper&#39;, &#39;beer&#39;},</span>
</span><span id="DataAdapter-48"><a href="#DataAdapter-48"><span class="linenos"> 48</span></a><span class="sd">    ...     {&#39;milk&#39;, &#39;diaper&#39;, &#39;beer&#39;},</span>
</span><span id="DataAdapter-49"><a href="#DataAdapter-49"><span class="linenos"> 49</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;diaper&#39;},</span>
</span><span id="DataAdapter-50"><a href="#DataAdapter-50"><span class="linenos"> 50</span></a><span class="sd">    ...     {&#39;bread&#39;, &#39;milk&#39;, &#39;beer&#39;}</span>
</span><span id="DataAdapter-51"><a href="#DataAdapter-51"><span class="linenos"> 51</span></a><span class="sd">    ... ]</span>
</span><span id="DataAdapter-52"><a href="#DataAdapter-52"><span class="linenos"> 52</span></a><span class="sd">    &gt;&gt;&gt; transactions = DataAdapter._convert_from_list(list_data)</span>
</span><span id="DataAdapter-53"><a href="#DataAdapter-53"><span class="linenos"> 53</span></a><span class="sd">    &gt;&gt;&gt; print(len(transactions), &quot;transactions loaded&quot;)</span>
</span><span id="DataAdapter-54"><a href="#DataAdapter-54"><span class="linenos"> 54</span></a><span class="sd">    5 transactions loaded</span>
</span><span id="DataAdapter-55"><a href="#DataAdapter-55"><span class="linenos"> 55</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DataAdapter-56"><a href="#DataAdapter-56"><span class="linenos"> 56</span></a>    
</span><span id="DataAdapter-57"><a href="#DataAdapter-57"><span class="linenos"> 57</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DataAdapter-58"><a href="#DataAdapter-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_transactions</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span> 
</span><span id="DataAdapter-59"><a href="#DataAdapter-59"><span class="linenos"> 59</span></a>                               <span class="n">binary_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
</span><span id="DataAdapter-60"><a href="#DataAdapter-60"><span class="linenos"> 60</span></a>                               <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataAdapter-61"><a href="#DataAdapter-61"><span class="linenos"> 61</span></a>                               <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DataAdapter-62"><a href="#DataAdapter-62"><span class="linenos"> 62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter-63"><a href="#DataAdapter-63"><span class="linenos"> 63</span></a><span class="sd">        Converts different data types into transactions for association rule mining.</span>
</span><span id="DataAdapter-64"><a href="#DataAdapter-64"><span class="linenos"> 64</span></a><span class="sd">        </span>
</span><span id="DataAdapter-65"><a href="#DataAdapter-65"><span class="linenos"> 65</span></a><span class="sd">        Args:</span>
</span><span id="DataAdapter-66"><a href="#DataAdapter-66"><span class="linenos"> 66</span></a><span class="sd">            data: Data source (DataFrame, NumPy array or list)</span>
</span><span id="DataAdapter-67"><a href="#DataAdapter-67"><span class="linenos"> 67</span></a><span class="sd">            binary_mode: If True, considers 1/True values as item presence</span>
</span><span id="DataAdapter-68"><a href="#DataAdapter-68"><span class="linenos"> 68</span></a><span class="sd">            columns: List of columns to consider (only for DataFrame)</span>
</span><span id="DataAdapter-69"><a href="#DataAdapter-69"><span class="linenos"> 69</span></a><span class="sd">            separator: Separator used to join attribute names and their values</span>
</span><span id="DataAdapter-70"><a href="#DataAdapter-70"><span class="linenos"> 70</span></a><span class="sd">        </span>
</span><span id="DataAdapter-71"><a href="#DataAdapter-71"><span class="linenos"> 71</span></a><span class="sd">        Returns:</span>
</span><span id="DataAdapter-72"><a href="#DataAdapter-72"><span class="linenos"> 72</span></a><span class="sd">            List of transactions where each transaction is a set of items</span>
</span><span id="DataAdapter-73"><a href="#DataAdapter-73"><span class="linenos"> 73</span></a><span class="sd">            </span>
</span><span id="DataAdapter-74"><a href="#DataAdapter-74"><span class="linenos"> 74</span></a><span class="sd">        Raises:</span>
</span><span id="DataAdapter-75"><a href="#DataAdapter-75"><span class="linenos"> 75</span></a><span class="sd">            TypeError: If the data type is not supported</span>
</span><span id="DataAdapter-76"><a href="#DataAdapter-76"><span class="linenos"> 76</span></a><span class="sd">            ValueError: If data is empty or malformed</span>
</span><span id="DataAdapter-77"><a href="#DataAdapter-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataAdapter-78"><a href="#DataAdapter-78"><span class="linenos"> 78</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="DataAdapter-79"><a href="#DataAdapter-79"><span class="linenos"> 79</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data cannot be empty&quot;</span><span class="p">)</span>
</span><span id="DataAdapter-80"><a href="#DataAdapter-80"><span class="linenos"> 80</span></a>            
</span><span id="DataAdapter-81"><a href="#DataAdapter-81"><span class="linenos"> 81</span></a>        <span class="c1"># Convert from pandas DataFrame</span>
</span><span id="DataAdapter-82"><a href="#DataAdapter-82"><span class="linenos"> 82</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="DataAdapter-83"><a href="#DataAdapter-83"><span class="linenos"> 83</span></a>            <span class="k">return</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">binary_mode</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
</span><span id="DataAdapter-84"><a href="#DataAdapter-84"><span class="linenos"> 84</span></a>            
</span><span id="DataAdapter-85"><a href="#DataAdapter-85"><span class="linenos"> 85</span></a>        <span class="c1"># Convert from numpy array</span>
</span><span id="DataAdapter-86"><a href="#DataAdapter-86"><span class="linenos"> 86</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DataAdapter-87"><a href="#DataAdapter-87"><span class="linenos"> 87</span></a>            <span class="k">return</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_numpy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">binary_mode</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
</span><span id="DataAdapter-88"><a href="#DataAdapter-88"><span class="linenos"> 88</span></a>            
</span><span id="DataAdapter-89"><a href="#DataAdapter-89"><span class="linenos"> 89</span></a>        <span class="c1"># Convert from list</span>
</span><span id="DataAdapter-90"><a href="#DataAdapter-90"><span class="linenos"> 90</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="DataAdapter-91"><a href="#DataAdapter-91"><span class="linenos"> 91</span></a>            <span class="k">return</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="DataAdapter-92"><a href="#DataAdapter-92"><span class="linenos"> 92</span></a>            
</span><span id="DataAdapter-93"><a href="#DataAdapter-93"><span class="linenos"> 93</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataAdapter-94"><a href="#DataAdapter-94"><span class="linenos"> 94</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unsupported data type. Accepted formats: pandas DataFrame, numpy array, list of transactions&quot;</span><span class="p">)</span>
</span><span id="DataAdapter-95"><a href="#DataAdapter-95"><span class="linenos"> 95</span></a>    
</span><span id="DataAdapter-96"><a href="#DataAdapter-96"><span class="linenos"> 96</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DataAdapter-97"><a href="#DataAdapter-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_from_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> 
</span><span id="DataAdapter-98"><a href="#DataAdapter-98"><span class="linenos"> 98</span></a>                               <span class="n">binary_mode</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> 
</span><span id="DataAdapter-99"><a href="#DataAdapter-99"><span class="linenos"> 99</span></a>                               <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="DataAdapter-100"><a href="#DataAdapter-100"><span class="linenos">100</span></a>                               <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DataAdapter-101"><a href="#DataAdapter-101"><span class="linenos">101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter-102"><a href="#DataAdapter-102"><span class="linenos">102</span></a><span class="sd">        Converts a pandas DataFrame into a list of transactions.</span>
</span><span id="DataAdapter-103"><a href="#DataAdapter-103"><span class="linenos">103</span></a><span class="sd">        </span>
</span><span id="DataAdapter-104"><a href="#DataAdapter-104"><span class="linenos">104</span></a><span class="sd">        Args:</span>
</span><span id="DataAdapter-105"><a href="#DataAdapter-105"><span class="linenos">105</span></a><span class="sd">            df: Source DataFrame</span>
</span><span id="DataAdapter-106"><a href="#DataAdapter-106"><span class="linenos">106</span></a><span class="sd">            binary_mode: Indicates if columns are binary (1/True = present)</span>
</span><span id="DataAdapter-107"><a href="#DataAdapter-107"><span class="linenos">107</span></a><span class="sd">            columns: List of columns to use (None = all columns)</span>
</span><span id="DataAdapter-108"><a href="#DataAdapter-108"><span class="linenos">108</span></a><span class="sd">            separator: Separator between attribute name and value</span>
</span><span id="DataAdapter-109"><a href="#DataAdapter-109"><span class="linenos">109</span></a><span class="sd">            </span>
</span><span id="DataAdapter-110"><a href="#DataAdapter-110"><span class="linenos">110</span></a><span class="sd">        Returns:</span>
</span><span id="DataAdapter-111"><a href="#DataAdapter-111"><span class="linenos">111</span></a><span class="sd">            List of transactions</span>
</span><span id="DataAdapter-112"><a href="#DataAdapter-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataAdapter-113"><a href="#DataAdapter-113"><span class="linenos">113</span></a>        <span class="c1"># Select columns if specified</span>
</span><span id="DataAdapter-114"><a href="#DataAdapter-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
</span><span id="DataAdapter-115"><a href="#DataAdapter-115"><span class="linenos">115</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span>
</span><span id="DataAdapter-116"><a href="#DataAdapter-116"><span class="linenos">116</span></a>        
</span><span id="DataAdapter-117"><a href="#DataAdapter-117"><span class="linenos">117</span></a>        <span class="c1"># Check for missing values</span>
</span><span id="DataAdapter-118"><a href="#DataAdapter-118"><span class="linenos">118</span></a>        <span class="n">has_missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</span><span id="DataAdapter-119"><a href="#DataAdapter-119"><span class="linenos">119</span></a>        
</span><span id="DataAdapter-120"><a href="#DataAdapter-120"><span class="linenos">120</span></a>        <span class="k">if</span> <span class="n">binary_mode</span><span class="p">:</span>
</span><span id="DataAdapter-121"><a href="#DataAdapter-121"><span class="linenos">121</span></a>            <span class="c1"># For binary data: each column where value = 1/True becomes an item</span>
</span><span id="DataAdapter-122"><a href="#DataAdapter-122"><span class="linenos">122</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="DataAdapter-123"><a href="#DataAdapter-123"><span class="linenos">123</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
</span><span id="DataAdapter-124"><a href="#DataAdapter-124"><span class="linenos">124</span></a>                 <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">}</span> 
</span><span id="DataAdapter-125"><a href="#DataAdapter-125"><span class="linenos">125</span></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="DataAdapter-126"><a href="#DataAdapter-126"><span class="linenos">126</span></a>            <span class="p">]</span>
</span><span id="DataAdapter-127"><a href="#DataAdapter-127"><span class="linenos">127</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataAdapter-128"><a href="#DataAdapter-128"><span class="linenos">128</span></a>            <span class="c1"># For categorical data: format &quot;column_value&quot; for each item</span>
</span><span id="DataAdapter-129"><a href="#DataAdapter-129"><span class="linenos">129</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="DataAdapter-130"><a href="#DataAdapter-130"><span class="linenos">130</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}{</span><span class="n">separator</span><span class="si">}{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
</span><span id="DataAdapter-131"><a href="#DataAdapter-131"><span class="linenos">131</span></a>                 <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">}</span> 
</span><span id="DataAdapter-132"><a href="#DataAdapter-132"><span class="linenos">132</span></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="DataAdapter-133"><a href="#DataAdapter-133"><span class="linenos">133</span></a>            <span class="p">]</span>
</span><span id="DataAdapter-134"><a href="#DataAdapter-134"><span class="linenos">134</span></a>    
</span><span id="DataAdapter-135"><a href="#DataAdapter-135"><span class="linenos">135</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DataAdapter-136"><a href="#DataAdapter-136"><span class="linenos">136</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_from_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
</span><span id="DataAdapter-137"><a href="#DataAdapter-137"><span class="linenos">137</span></a>                           <span class="n">binary_mode</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="DataAdapter-138"><a href="#DataAdapter-138"><span class="linenos">138</span></a>                           <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DataAdapter-139"><a href="#DataAdapter-139"><span class="linenos">139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter-140"><a href="#DataAdapter-140"><span class="linenos">140</span></a><span class="sd">        Converts a NumPy array into a list of transactions.</span>
</span><span id="DataAdapter-141"><a href="#DataAdapter-141"><span class="linenos">141</span></a><span class="sd">        </span>
</span><span id="DataAdapter-142"><a href="#DataAdapter-142"><span class="linenos">142</span></a><span class="sd">        Args:</span>
</span><span id="DataAdapter-143"><a href="#DataAdapter-143"><span class="linenos">143</span></a><span class="sd">            arr: Source array</span>
</span><span id="DataAdapter-144"><a href="#DataAdapter-144"><span class="linenos">144</span></a><span class="sd">            binary_mode: Indicates if the array is binary (1/True = present)</span>
</span><span id="DataAdapter-145"><a href="#DataAdapter-145"><span class="linenos">145</span></a><span class="sd">            separator: Separator between attribute name and value</span>
</span><span id="DataAdapter-146"><a href="#DataAdapter-146"><span class="linenos">146</span></a><span class="sd">            </span>
</span><span id="DataAdapter-147"><a href="#DataAdapter-147"><span class="linenos">147</span></a><span class="sd">        Returns:</span>
</span><span id="DataAdapter-148"><a href="#DataAdapter-148"><span class="linenos">148</span></a><span class="sd">            List of transactions</span>
</span><span id="DataAdapter-149"><a href="#DataAdapter-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataAdapter-150"><a href="#DataAdapter-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="DataAdapter-151"><a href="#DataAdapter-151"><span class="linenos">151</span></a>            <span class="c1"># Convert a 1D array into a 2D array</span>
</span><span id="DataAdapter-152"><a href="#DataAdapter-152"><span class="linenos">152</span></a>            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataAdapter-153"><a href="#DataAdapter-153"><span class="linenos">153</span></a>            
</span><span id="DataAdapter-154"><a href="#DataAdapter-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="n">binary_mode</span><span class="p">:</span>
</span><span id="DataAdapter-155"><a href="#DataAdapter-155"><span class="linenos">155</span></a>            <span class="c1"># For binary data: column number becomes the item if value = 1/True</span>
</span><span id="DataAdapter-156"><a href="#DataAdapter-156"><span class="linenos">156</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="DataAdapter-157"><a href="#DataAdapter-157"><span class="linenos">157</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;feature_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
</span><span id="DataAdapter-158"><a href="#DataAdapter-158"><span class="linenos">158</span></a>                 <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">}</span> 
</span><span id="DataAdapter-159"><a href="#DataAdapter-159"><span class="linenos">159</span></a>                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">arr</span>
</span><span id="DataAdapter-160"><a href="#DataAdapter-160"><span class="linenos">160</span></a>            <span class="p">]</span>
</span><span id="DataAdapter-161"><a href="#DataAdapter-161"><span class="linenos">161</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataAdapter-162"><a href="#DataAdapter-162"><span class="linenos">162</span></a>            <span class="c1"># For non-binary data: format &quot;feature_i_value&quot; for each item</span>
</span><span id="DataAdapter-163"><a href="#DataAdapter-163"><span class="linenos">163</span></a>            <span class="k">return</span> <span class="p">[</span>
</span><span id="DataAdapter-164"><a href="#DataAdapter-164"><span class="linenos">164</span></a>                <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;feature_</span><span class="si">{</span><span class="n">j</span><span class="si">}{</span><span class="n">separator</span><span class="si">}{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> 
</span><span id="DataAdapter-165"><a href="#DataAdapter-165"><span class="linenos">165</span></a>                 <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
</span><span id="DataAdapter-166"><a href="#DataAdapter-166"><span class="linenos">166</span></a>                 <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">}</span> 
</span><span id="DataAdapter-167"><a href="#DataAdapter-167"><span class="linenos">167</span></a>                <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">arr</span>
</span><span id="DataAdapter-168"><a href="#DataAdapter-168"><span class="linenos">168</span></a>            <span class="p">]</span>
</span><span id="DataAdapter-169"><a href="#DataAdapter-169"><span class="linenos">169</span></a>    
</span><span id="DataAdapter-170"><a href="#DataAdapter-170"><span class="linenos">170</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DataAdapter-171"><a href="#DataAdapter-171"><span class="linenos">171</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_from_list</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DataAdapter-172"><a href="#DataAdapter-172"><span class="linenos">172</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter-173"><a href="#DataAdapter-173"><span class="linenos">173</span></a><span class="sd">        Converts a list into a list of transactions.</span>
</span><span id="DataAdapter-174"><a href="#DataAdapter-174"><span class="linenos">174</span></a><span class="sd">        Assumes that the input is already a list of lists/sets of items.</span>
</span><span id="DataAdapter-175"><a href="#DataAdapter-175"><span class="linenos">175</span></a><span class="sd">        </span>
</span><span id="DataAdapter-176"><a href="#DataAdapter-176"><span class="linenos">176</span></a><span class="sd">        Args:</span>
</span><span id="DataAdapter-177"><a href="#DataAdapter-177"><span class="linenos">177</span></a><span class="sd">            data: Source list (list of lists/sets of items)</span>
</span><span id="DataAdapter-178"><a href="#DataAdapter-178"><span class="linenos">178</span></a><span class="sd">            </span>
</span><span id="DataAdapter-179"><a href="#DataAdapter-179"><span class="linenos">179</span></a><span class="sd">        Returns:</span>
</span><span id="DataAdapter-180"><a href="#DataAdapter-180"><span class="linenos">180</span></a><span class="sd">            List of transactions</span>
</span><span id="DataAdapter-181"><a href="#DataAdapter-181"><span class="linenos">181</span></a><span class="sd">            </span>
</span><span id="DataAdapter-182"><a href="#DataAdapter-182"><span class="linenos">182</span></a><span class="sd">        Raises:</span>
</span><span id="DataAdapter-183"><a href="#DataAdapter-183"><span class="linenos">183</span></a><span class="sd">            ValueError: If the list structure is not suitable</span>
</span><span id="DataAdapter-184"><a href="#DataAdapter-184"><span class="linenos">184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataAdapter-185"><a href="#DataAdapter-185"><span class="linenos">185</span></a>        <span class="c1"># Check that the input has the right structure</span>
</span><span id="DataAdapter-186"><a href="#DataAdapter-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span><span id="DataAdapter-187"><a href="#DataAdapter-187"><span class="linenos">187</span></a>            <span class="k">return</span> <span class="p">[]</span>
</span><span id="DataAdapter-188"><a href="#DataAdapter-188"><span class="linenos">188</span></a>            
</span><span id="DataAdapter-189"><a href="#DataAdapter-189"><span class="linenos">189</span></a>        <span class="c1"># Convert to list of sets</span>
</span><span id="DataAdapter-190"><a href="#DataAdapter-190"><span class="linenos">190</span></a>        <span class="n">transactions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataAdapter-191"><a href="#DataAdapter-191"><span class="linenos">191</span></a>        <span class="k">for</span> <span class="n">transaction</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="DataAdapter-192"><a href="#DataAdapter-192"><span class="linenos">192</span></a>            <span class="c1"># If it&#39;s already a set, use as is</span>
</span><span id="DataAdapter-193"><a href="#DataAdapter-193"><span class="linenos">193</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
</span><span id="DataAdapter-194"><a href="#DataAdapter-194"><span class="linenos">194</span></a>                <span class="n">transactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
</span><span id="DataAdapter-195"><a href="#DataAdapter-195"><span class="linenos">195</span></a>            <span class="c1"># If it&#39;s a list or tuple, convert to set</span>
</span><span id="DataAdapter-196"><a href="#DataAdapter-196"><span class="linenos">196</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
</span><span id="DataAdapter-197"><a href="#DataAdapter-197"><span class="linenos">197</span></a>                <span class="c1"># Filter empty values or None</span>
</span><span id="DataAdapter-198"><a href="#DataAdapter-198"><span class="linenos">198</span></a>                <span class="n">clean_transaction</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">transaction</span> 
</span><span id="DataAdapter-199"><a href="#DataAdapter-199"><span class="linenos">199</span></a>                                    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
</span><span id="DataAdapter-200"><a href="#DataAdapter-200"><span class="linenos">200</span></a>                <span class="k">if</span> <span class="n">clean_transaction</span><span class="p">:</span>  <span class="c1"># Don&#39;t add empty sets</span>
</span><span id="DataAdapter-201"><a href="#DataAdapter-201"><span class="linenos">201</span></a>                    <span class="n">transactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clean_transaction</span><span class="p">)</span>
</span><span id="DataAdapter-202"><a href="#DataAdapter-202"><span class="linenos">202</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DataAdapter-203"><a href="#DataAdapter-203"><span class="linenos">203</span></a>                <span class="c1"># If single element, create a set with this element</span>
</span><span id="DataAdapter-204"><a href="#DataAdapter-204"><span class="linenos">204</span></a>                <span class="k">if</span> <span class="n">transaction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="DataAdapter-205"><a href="#DataAdapter-205"><span class="linenos">205</span></a>                    <span class="n">transactions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="nb">str</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()})</span>
</span><span id="DataAdapter-206"><a href="#DataAdapter-206"><span class="linenos">206</span></a>                
</span><span id="DataAdapter-207"><a href="#DataAdapter-207"><span class="linenos">207</span></a>        <span class="k">return</span> <span class="n">transactions</span>
</span><span id="DataAdapter-208"><a href="#DataAdapter-208"><span class="linenos">208</span></a>    
</span><span id="DataAdapter-209"><a href="#DataAdapter-209"><span class="linenos">209</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DataAdapter-210"><a href="#DataAdapter-210"><span class="linenos">210</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_csv_to_transactions</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="DataAdapter-211"><a href="#DataAdapter-211"><span class="linenos">211</span></a>                                <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DataAdapter-212"><a href="#DataAdapter-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter-213"><a href="#DataAdapter-213"><span class="linenos">213</span></a><span class="sd">        Loads a CSV file and converts it directly into transactions.</span>
</span><span id="DataAdapter-214"><a href="#DataAdapter-214"><span class="linenos">214</span></a><span class="sd">        </span>
</span><span id="DataAdapter-215"><a href="#DataAdapter-215"><span class="linenos">215</span></a><span class="sd">        Args:</span>
</span><span id="DataAdapter-216"><a href="#DataAdapter-216"><span class="linenos">216</span></a><span class="sd">            file_path: Path to the CSV file</span>
</span><span id="DataAdapter-217"><a href="#DataAdapter-217"><span class="linenos">217</span></a><span class="sd">            header: Header row number (None = no header)</span>
</span><span id="DataAdapter-218"><a href="#DataAdapter-218"><span class="linenos">218</span></a><span class="sd">            separator: Column separator in the CSV file</span>
</span><span id="DataAdapter-219"><a href="#DataAdapter-219"><span class="linenos">219</span></a><span class="sd">            </span>
</span><span id="DataAdapter-220"><a href="#DataAdapter-220"><span class="linenos">220</span></a><span class="sd">        Returns:</span>
</span><span id="DataAdapter-221"><a href="#DataAdapter-221"><span class="linenos">221</span></a><span class="sd">            List of transactions</span>
</span><span id="DataAdapter-222"><a href="#DataAdapter-222"><span class="linenos">222</span></a><span class="sd">            </span>
</span><span id="DataAdapter-223"><a href="#DataAdapter-223"><span class="linenos">223</span></a><span class="sd">        Raises:</span>
</span><span id="DataAdapter-224"><a href="#DataAdapter-224"><span class="linenos">224</span></a><span class="sd">            FileNotFoundError: If the file doesn&#39;t exist</span>
</span><span id="DataAdapter-225"><a href="#DataAdapter-225"><span class="linenos">225</span></a><span class="sd">            ValueError: If the file is empty or malformed</span>
</span><span id="DataAdapter-226"><a href="#DataAdapter-226"><span class="linenos">226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataAdapter-227"><a href="#DataAdapter-227"><span class="linenos">227</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DataAdapter-228"><a href="#DataAdapter-228"><span class="linenos">228</span></a>            <span class="c1"># Load CSV as DataFrame</span>
</span><span id="DataAdapter-229"><a href="#DataAdapter-229"><span class="linenos">229</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
</span><span id="DataAdapter-230"><a href="#DataAdapter-230"><span class="linenos">230</span></a>            
</span><span id="DataAdapter-231"><a href="#DataAdapter-231"><span class="linenos">231</span></a>            <span class="c1"># Convert each row to a set of items (ignoring missing values)</span>
</span><span id="DataAdapter-232"><a href="#DataAdapter-232"><span class="linenos">232</span></a>            <span class="n">transactions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataAdapter-233"><a href="#DataAdapter-233"><span class="linenos">233</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="DataAdapter-234"><a href="#DataAdapter-234"><span class="linenos">234</span></a>                <span class="c1"># Filter non-null/non-empty values</span>
</span><span id="DataAdapter-235"><a href="#DataAdapter-235"><span class="linenos">235</span></a>                <span class="n">transaction</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> 
</span><span id="DataAdapter-236"><a href="#DataAdapter-236"><span class="linenos">236</span></a>                              <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
</span><span id="DataAdapter-237"><a href="#DataAdapter-237"><span class="linenos">237</span></a>                <span class="k">if</span> <span class="n">transaction</span><span class="p">:</span>  <span class="c1"># Don&#39;t add empty transactions</span>
</span><span id="DataAdapter-238"><a href="#DataAdapter-238"><span class="linenos">238</span></a>                    <span class="n">transactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
</span><span id="DataAdapter-239"><a href="#DataAdapter-239"><span class="linenos">239</span></a>                    
</span><span id="DataAdapter-240"><a href="#DataAdapter-240"><span class="linenos">240</span></a>            <span class="k">return</span> <span class="n">transactions</span>
</span><span id="DataAdapter-241"><a href="#DataAdapter-241"><span class="linenos">241</span></a>            
</span><span id="DataAdapter-242"><a href="#DataAdapter-242"><span class="linenos">242</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DataAdapter-243"><a href="#DataAdapter-243"><span class="linenos">243</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
</span><span id="DataAdapter-244"><a href="#DataAdapter-244"><span class="linenos">244</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DataAdapter-245"><a href="#DataAdapter-245"><span class="linenos">245</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error while loading CSV file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Utility class for converting different data formats into transactions
for association rule mining algorithms.</p>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Converting from a pandas DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ifri_mini_ml_lib.association_rules.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataAdapter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a sample DataFrame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;item1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;item2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;item3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert to transactions (binary mode)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transactions</span> <span class="o">=</span> <span class="n"><a href="#DataAdapter.convert_to_transactions">DataAdapter.convert_to_transactions</a></span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">binary_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="go">[&#39;item1&#39;, &#39;item2&#39;]</span>
<span class="go">[&#39;item2&#39;, &#39;item3&#39;]</span>
<span class="go">[&#39;item1&#39;, &#39;item3&#39;]</span>
<span class="go">[&#39;item1&#39;, &#39;item2&#39;, &#39;item3&#39;]</span>
<span class="go">[&#39;item2&#39;]</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Converting non-binary data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Convert to transactions (categorical data)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transactions</span> <span class="o">=</span> <span class="n"><a href="#DataAdapter.convert_to_transactions">DataAdapter.convert_to_transactions</a></span><span class="p">(</span><span class="n">df_cat</span><span class="p">,</span> <span class="n">binary_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transactions</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="go">[&#39;color_red&#39;, &#39;size_large&#39;]</span>
<span class="go">[&#39;color_blue&#39;, &#39;size_medium&#39;]</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Converting from a list of sets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_data</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;diaper&#39;</span><span class="p">,</span> <span class="s1">&#39;beer&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;diaper&#39;</span><span class="p">,</span> <span class="s1">&#39;beer&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;diaper&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;bread&#39;</span><span class="p">,</span> <span class="s1">&#39;milk&#39;</span><span class="p">,</span> <span class="s1">&#39;beer&#39;</span><span class="p">}</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transactions</span> <span class="o">=</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_list</span><span class="p">(</span><span class="n">list_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">transactions</span><span class="p">),</span> <span class="s2">&quot;transactions loaded&quot;</span><span class="p">)</span>
<span class="go">5 transactions loaded</span>
</code></pre>
</div>
</div>


                            <div id="DataAdapter.convert_to_transactions" class="classattr">
                                        <input id="DataAdapter.convert_to_transactions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">convert_to_transactions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">List</span><span class="p">]</span>,</span><span class="param">	<span class="n">binary_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="DataAdapter.convert_to_transactions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataAdapter.convert_to_transactions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataAdapter.convert_to_transactions-57"><a href="#DataAdapter.convert_to_transactions-57"><span class="linenos">57</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DataAdapter.convert_to_transactions-58"><a href="#DataAdapter.convert_to_transactions-58"><span class="linenos">58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_transactions</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">List</span><span class="p">],</span> 
</span><span id="DataAdapter.convert_to_transactions-59"><a href="#DataAdapter.convert_to_transactions-59"><span class="linenos">59</span></a>                               <span class="n">binary_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
</span><span id="DataAdapter.convert_to_transactions-60"><a href="#DataAdapter.convert_to_transactions-60"><span class="linenos">60</span></a>                               <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataAdapter.convert_to_transactions-61"><a href="#DataAdapter.convert_to_transactions-61"><span class="linenos">61</span></a>                               <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DataAdapter.convert_to_transactions-62"><a href="#DataAdapter.convert_to_transactions-62"><span class="linenos">62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter.convert_to_transactions-63"><a href="#DataAdapter.convert_to_transactions-63"><span class="linenos">63</span></a><span class="sd">        Converts different data types into transactions for association rule mining.</span>
</span><span id="DataAdapter.convert_to_transactions-64"><a href="#DataAdapter.convert_to_transactions-64"><span class="linenos">64</span></a><span class="sd">        </span>
</span><span id="DataAdapter.convert_to_transactions-65"><a href="#DataAdapter.convert_to_transactions-65"><span class="linenos">65</span></a><span class="sd">        Args:</span>
</span><span id="DataAdapter.convert_to_transactions-66"><a href="#DataAdapter.convert_to_transactions-66"><span class="linenos">66</span></a><span class="sd">            data: Data source (DataFrame, NumPy array or list)</span>
</span><span id="DataAdapter.convert_to_transactions-67"><a href="#DataAdapter.convert_to_transactions-67"><span class="linenos">67</span></a><span class="sd">            binary_mode: If True, considers 1/True values as item presence</span>
</span><span id="DataAdapter.convert_to_transactions-68"><a href="#DataAdapter.convert_to_transactions-68"><span class="linenos">68</span></a><span class="sd">            columns: List of columns to consider (only for DataFrame)</span>
</span><span id="DataAdapter.convert_to_transactions-69"><a href="#DataAdapter.convert_to_transactions-69"><span class="linenos">69</span></a><span class="sd">            separator: Separator used to join attribute names and their values</span>
</span><span id="DataAdapter.convert_to_transactions-70"><a href="#DataAdapter.convert_to_transactions-70"><span class="linenos">70</span></a><span class="sd">        </span>
</span><span id="DataAdapter.convert_to_transactions-71"><a href="#DataAdapter.convert_to_transactions-71"><span class="linenos">71</span></a><span class="sd">        Returns:</span>
</span><span id="DataAdapter.convert_to_transactions-72"><a href="#DataAdapter.convert_to_transactions-72"><span class="linenos">72</span></a><span class="sd">            List of transactions where each transaction is a set of items</span>
</span><span id="DataAdapter.convert_to_transactions-73"><a href="#DataAdapter.convert_to_transactions-73"><span class="linenos">73</span></a><span class="sd">            </span>
</span><span id="DataAdapter.convert_to_transactions-74"><a href="#DataAdapter.convert_to_transactions-74"><span class="linenos">74</span></a><span class="sd">        Raises:</span>
</span><span id="DataAdapter.convert_to_transactions-75"><a href="#DataAdapter.convert_to_transactions-75"><span class="linenos">75</span></a><span class="sd">            TypeError: If the data type is not supported</span>
</span><span id="DataAdapter.convert_to_transactions-76"><a href="#DataAdapter.convert_to_transactions-76"><span class="linenos">76</span></a><span class="sd">            ValueError: If data is empty or malformed</span>
</span><span id="DataAdapter.convert_to_transactions-77"><a href="#DataAdapter.convert_to_transactions-77"><span class="linenos">77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataAdapter.convert_to_transactions-78"><a href="#DataAdapter.convert_to_transactions-78"><span class="linenos">78</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="DataAdapter.convert_to_transactions-79"><a href="#DataAdapter.convert_to_transactions-79"><span class="linenos">79</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data cannot be empty&quot;</span><span class="p">)</span>
</span><span id="DataAdapter.convert_to_transactions-80"><a href="#DataAdapter.convert_to_transactions-80"><span class="linenos">80</span></a>            
</span><span id="DataAdapter.convert_to_transactions-81"><a href="#DataAdapter.convert_to_transactions-81"><span class="linenos">81</span></a>        <span class="c1"># Convert from pandas DataFrame</span>
</span><span id="DataAdapter.convert_to_transactions-82"><a href="#DataAdapter.convert_to_transactions-82"><span class="linenos">82</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="DataAdapter.convert_to_transactions-83"><a href="#DataAdapter.convert_to_transactions-83"><span class="linenos">83</span></a>            <span class="k">return</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">binary_mode</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
</span><span id="DataAdapter.convert_to_transactions-84"><a href="#DataAdapter.convert_to_transactions-84"><span class="linenos">84</span></a>            
</span><span id="DataAdapter.convert_to_transactions-85"><a href="#DataAdapter.convert_to_transactions-85"><span class="linenos">85</span></a>        <span class="c1"># Convert from numpy array</span>
</span><span id="DataAdapter.convert_to_transactions-86"><a href="#DataAdapter.convert_to_transactions-86"><span class="linenos">86</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DataAdapter.convert_to_transactions-87"><a href="#DataAdapter.convert_to_transactions-87"><span class="linenos">87</span></a>            <span class="k">return</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_numpy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">binary_mode</span><span class="p">,</span> <span class="n">separator</span><span class="p">)</span>
</span><span id="DataAdapter.convert_to_transactions-88"><a href="#DataAdapter.convert_to_transactions-88"><span class="linenos">88</span></a>            
</span><span id="DataAdapter.convert_to_transactions-89"><a href="#DataAdapter.convert_to_transactions-89"><span class="linenos">89</span></a>        <span class="c1"># Convert from list</span>
</span><span id="DataAdapter.convert_to_transactions-90"><a href="#DataAdapter.convert_to_transactions-90"><span class="linenos">90</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="DataAdapter.convert_to_transactions-91"><a href="#DataAdapter.convert_to_transactions-91"><span class="linenos">91</span></a>            <span class="k">return</span> <span class="n">DataAdapter</span><span class="o">.</span><span class="n">_convert_from_list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="DataAdapter.convert_to_transactions-92"><a href="#DataAdapter.convert_to_transactions-92"><span class="linenos">92</span></a>            
</span><span id="DataAdapter.convert_to_transactions-93"><a href="#DataAdapter.convert_to_transactions-93"><span class="linenos">93</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataAdapter.convert_to_transactions-94"><a href="#DataAdapter.convert_to_transactions-94"><span class="linenos">94</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unsupported data type. Accepted formats: pandas DataFrame, numpy array, list of transactions&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts different data types into transactions for association rule mining.</p>

<p>Args:
    data: Data source (DataFrame, NumPy array or list)
    binary_mode: If True, considers 1/True values as item presence
    columns: List of columns to consider (only for DataFrame)
    separator: Separator used to join attribute names and their values</p>

<p>Returns:
    List of transactions where each transaction is a set of items</p>

<p>Raises:
    TypeError: If the data type is not supported
    ValueError: If data is empty or malformed</p>
</div>


                            </div>
                            <div id="DataAdapter.load_csv_to_transactions" class="classattr">
                                        <input id="DataAdapter.load_csv_to_transactions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">load_csv_to_transactions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="DataAdapter.load_csv_to_transactions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataAdapter.load_csv_to_transactions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataAdapter.load_csv_to_transactions-209"><a href="#DataAdapter.load_csv_to_transactions-209"><span class="linenos">209</span></a>    <span class="nd">@staticmethod</span>
</span><span id="DataAdapter.load_csv_to_transactions-210"><a href="#DataAdapter.load_csv_to_transactions-210"><span class="linenos">210</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_csv_to_transactions</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
</span><span id="DataAdapter.load_csv_to_transactions-211"><a href="#DataAdapter.load_csv_to_transactions-211"><span class="linenos">211</span></a>                                <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="DataAdapter.load_csv_to_transactions-212"><a href="#DataAdapter.load_csv_to_transactions-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataAdapter.load_csv_to_transactions-213"><a href="#DataAdapter.load_csv_to_transactions-213"><span class="linenos">213</span></a><span class="sd">        Loads a CSV file and converts it directly into transactions.</span>
</span><span id="DataAdapter.load_csv_to_transactions-214"><a href="#DataAdapter.load_csv_to_transactions-214"><span class="linenos">214</span></a><span class="sd">        </span>
</span><span id="DataAdapter.load_csv_to_transactions-215"><a href="#DataAdapter.load_csv_to_transactions-215"><span class="linenos">215</span></a><span class="sd">        Args:</span>
</span><span id="DataAdapter.load_csv_to_transactions-216"><a href="#DataAdapter.load_csv_to_transactions-216"><span class="linenos">216</span></a><span class="sd">            file_path: Path to the CSV file</span>
</span><span id="DataAdapter.load_csv_to_transactions-217"><a href="#DataAdapter.load_csv_to_transactions-217"><span class="linenos">217</span></a><span class="sd">            header: Header row number (None = no header)</span>
</span><span id="DataAdapter.load_csv_to_transactions-218"><a href="#DataAdapter.load_csv_to_transactions-218"><span class="linenos">218</span></a><span class="sd">            separator: Column separator in the CSV file</span>
</span><span id="DataAdapter.load_csv_to_transactions-219"><a href="#DataAdapter.load_csv_to_transactions-219"><span class="linenos">219</span></a><span class="sd">            </span>
</span><span id="DataAdapter.load_csv_to_transactions-220"><a href="#DataAdapter.load_csv_to_transactions-220"><span class="linenos">220</span></a><span class="sd">        Returns:</span>
</span><span id="DataAdapter.load_csv_to_transactions-221"><a href="#DataAdapter.load_csv_to_transactions-221"><span class="linenos">221</span></a><span class="sd">            List of transactions</span>
</span><span id="DataAdapter.load_csv_to_transactions-222"><a href="#DataAdapter.load_csv_to_transactions-222"><span class="linenos">222</span></a><span class="sd">            </span>
</span><span id="DataAdapter.load_csv_to_transactions-223"><a href="#DataAdapter.load_csv_to_transactions-223"><span class="linenos">223</span></a><span class="sd">        Raises:</span>
</span><span id="DataAdapter.load_csv_to_transactions-224"><a href="#DataAdapter.load_csv_to_transactions-224"><span class="linenos">224</span></a><span class="sd">            FileNotFoundError: If the file doesn&#39;t exist</span>
</span><span id="DataAdapter.load_csv_to_transactions-225"><a href="#DataAdapter.load_csv_to_transactions-225"><span class="linenos">225</span></a><span class="sd">            ValueError: If the file is empty or malformed</span>
</span><span id="DataAdapter.load_csv_to_transactions-226"><a href="#DataAdapter.load_csv_to_transactions-226"><span class="linenos">226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataAdapter.load_csv_to_transactions-227"><a href="#DataAdapter.load_csv_to_transactions-227"><span class="linenos">227</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DataAdapter.load_csv_to_transactions-228"><a href="#DataAdapter.load_csv_to_transactions-228"><span class="linenos">228</span></a>            <span class="c1"># Load CSV as DataFrame</span>
</span><span id="DataAdapter.load_csv_to_transactions-229"><a href="#DataAdapter.load_csv_to_transactions-229"><span class="linenos">229</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
</span><span id="DataAdapter.load_csv_to_transactions-230"><a href="#DataAdapter.load_csv_to_transactions-230"><span class="linenos">230</span></a>            
</span><span id="DataAdapter.load_csv_to_transactions-231"><a href="#DataAdapter.load_csv_to_transactions-231"><span class="linenos">231</span></a>            <span class="c1"># Convert each row to a set of items (ignoring missing values)</span>
</span><span id="DataAdapter.load_csv_to_transactions-232"><a href="#DataAdapter.load_csv_to_transactions-232"><span class="linenos">232</span></a>            <span class="n">transactions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataAdapter.load_csv_to_transactions-233"><a href="#DataAdapter.load_csv_to_transactions-233"><span class="linenos">233</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="DataAdapter.load_csv_to_transactions-234"><a href="#DataAdapter.load_csv_to_transactions-234"><span class="linenos">234</span></a>                <span class="c1"># Filter non-null/non-empty values</span>
</span><span id="DataAdapter.load_csv_to_transactions-235"><a href="#DataAdapter.load_csv_to_transactions-235"><span class="linenos">235</span></a>                <span class="n">transaction</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> 
</span><span id="DataAdapter.load_csv_to_transactions-236"><a href="#DataAdapter.load_csv_to_transactions-236"><span class="linenos">236</span></a>                              <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
</span><span id="DataAdapter.load_csv_to_transactions-237"><a href="#DataAdapter.load_csv_to_transactions-237"><span class="linenos">237</span></a>                <span class="k">if</span> <span class="n">transaction</span><span class="p">:</span>  <span class="c1"># Don&#39;t add empty transactions</span>
</span><span id="DataAdapter.load_csv_to_transactions-238"><a href="#DataAdapter.load_csv_to_transactions-238"><span class="linenos">238</span></a>                    <span class="n">transactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transaction</span><span class="p">)</span>
</span><span id="DataAdapter.load_csv_to_transactions-239"><a href="#DataAdapter.load_csv_to_transactions-239"><span class="linenos">239</span></a>                    
</span><span id="DataAdapter.load_csv_to_transactions-240"><a href="#DataAdapter.load_csv_to_transactions-240"><span class="linenos">240</span></a>            <span class="k">return</span> <span class="n">transactions</span>
</span><span id="DataAdapter.load_csv_to_transactions-241"><a href="#DataAdapter.load_csv_to_transactions-241"><span class="linenos">241</span></a>            
</span><span id="DataAdapter.load_csv_to_transactions-242"><a href="#DataAdapter.load_csv_to_transactions-242"><span class="linenos">242</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="DataAdapter.load_csv_to_transactions-243"><a href="#DataAdapter.load_csv_to_transactions-243"><span class="linenos">243</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
</span><span id="DataAdapter.load_csv_to_transactions-244"><a href="#DataAdapter.load_csv_to_transactions-244"><span class="linenos">244</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DataAdapter.load_csv_to_transactions-245"><a href="#DataAdapter.load_csv_to_transactions-245"><span class="linenos">245</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error while loading CSV file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Loads a CSV file and converts it directly into transactions.</p>

<p>Args:
    file_path: Path to the CSV file
    header: Header row number (None = no header)
    separator: Column separator in the CSV file</p>

<p>Returns:
    List of transactions</p>

<p>Raises:
    FileNotFoundError: If the file doesn't exist
    ValueError: If the file is empty or malformed</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>